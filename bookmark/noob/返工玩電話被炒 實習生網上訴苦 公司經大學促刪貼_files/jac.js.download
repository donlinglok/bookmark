/*! JAC 0.8.1, Copyright 2018-2021 Verizon Media Inc. */!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=24)}([function(e,t,i){var n=i(14),o=i(9);e.exports=function(e,t){var i=o(e,t,"get");return n(e,i)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(15),o=i(9);e.exports=function(e,t,i){var s=o(e,t,"set");return n(e,s,i),i},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,i(t)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(16);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(8).default,o=i(17);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=i=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),i(t)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(18),o=i(19),s=i(20),r=i(22);e.exports=function(e,t){return n(e)||o(e,t)||s(e,t)||r()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(23);function o(t,i,s){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=o=Reflect.get,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=o=function(e,t,i){var o=n(e,t);if(o){var s=Object.getOwnPropertyDescriptor(o,t);return s.get?s.get.call(i):s.value}},e.exports.default=e.exports,e.exports.__esModule=!0),o(t,i,s||t)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}return i},writable:!0,configurable:!0})},function(e,t){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e})},function(e,t){e.exports=function(e,t){return t.get?t.get.call(e):t.value},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(t,n){return e.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,i(t,n)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){var i=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=i){var n,o,s=[],r=!0,a=!1;try{for(i=i.call(e);!(r=(n=i.next()).done)&&(s.push(n.value),!t||s.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return s}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(21);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(5);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){"use strict";i.r(t);i(12),i(13);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(1),c=i.n(a),u=i(0),l=i.n(u),h=i(2),f=i.n(h),d=i(6),p=i.n(d),v=i(7),m=i.n(v),g=i(5),E=i.n(g),y=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o()(this,e),this.type=t,this.meta=i,this.target=null};function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var O=function(e){p()(i,e);var t=_(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(O,"SCROLL","page.scroll"),c()(O,"RESIZE","page.resize"),c()(O,"VISIBILITY","page.visibility"),c()(O,"FOCUS","window.focus"),c()(O,"BLUR","window.blur"),c()(O,"FOCUS_IN","window.focus_in"),c()(O,"BLUR_CAPTURE","window.blur_capture"),c()(O,"DOM_LOADED","dom.loaded"),c()(O,"LOADED","page.loaded"),c()(O,"BEFORE_UNLOAD","page.stopped"),c()(O,"MOUSE_OVER","page.mouse_over"),c()(O,"MOUSE_OUT","page.mouse_out");var w={addDOMLoadListener:function(e){if("loading"!==document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)},addPageLoadListener:function(e){if("complete"===document.readyState)return e();window.addEventListener("load",e,!1)}};function b(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,n=null,o=null,s=function(){e.apply(i,o),n=null};return function(){if(!n){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];o=i,n=setTimeout(s,t)}}}var T=i(8),P=i.n(T);function R(e,t){if(Array.isArray(t)){if(t.indexOf(e)>=0)return!0}else for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]===e)return!0;return!1}var D="function",C="number",S="object",A="string",k="undefined";function I(e){return P()(e)!==k}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=Number.NaN;return P()(e)===C?o=e:P()(e)===A&&(o=Number(e),isNaN(o)&&(o=parseFloat(e))),isNaN(o)||I(i)&&o<i||I(n)&&o>n?t:o}var M={isSet:I,isFunction:function(e){return P()(e)===D},isString:function(e){return P()(e)===A},isObject:function(e){return P()(e)===S},num:N,int:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=N(e,t,i,n);return P()(o)!==C||isNaN(o)?t:Math.round(o)}};function x(){try{for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];console.log.apply(console,[].slice.call(t))}catch(e){}}var L="exists",F="remove",j={on:function(e,t,i){this.eventTypes||(this.eventTypes={}),this.eventTypes[e]||(this.eventTypes[e]=[]),R(t,this.eventTypes[e])||(i?this.eventTypes[e].push({ref:i,handler:t}):this.eventTypes[e].push(t))},off:function(e,t,i){this.eventTypes&&Array.isArray(this.eventTypes[e])&&this._validateOrRemove.call(this,e,t,i,F)},hasEventListener:function(e,t,i){return!(!this.eventTypes||!Array.isArray(this.eventTypes[e]))&&this._validateOrRemove.call(this,e,t,i,L)},trigger:function(e){if(this.eventTypes&&P()(e)===S&&P()(e.type)===A&&this.eventTypes[e.type]){e.target=e.target||this;for(var t=this.eventTypes[e.type].slice(0),i=0;i<t.length;i++){var n=t[i];if(P()(n)===S)try{n.handler.call(n.ref,e)}catch(t){x("Error calling callback",n,e,t)}else try{n(e)}catch(t){x("Error calling callback",e,t)}}}},_validateOrRemove:function(e,t,i,n){for(var o=0;o<this.eventTypes[e].length;o++){var s=this.eventTypes[e][o],r=i?S:D;if(r===P()(s))switch(r){case D:if(s===t)return n===F&&this.eventTypes[e].splice(o,1),!0;break;case S:if(s.handler===t&&s.ref===i)return n===F&&this.eventTypes[e].splice(o,1),!0}}return!1}},U=new WeakMap,G=new WeakMap,W=new WeakMap,z=new WeakMap,H=new WeakMap,V=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throttleTime:200};o()(this,e),U.set(this,{writable:!0,value:!1}),G.set(this,{writable:!0,value:!1}),W.set(this,{writable:!0,value:!1}),z.set(this,{writable:!0,value:void 0}),H.set(this,{writable:!0,value:void 0}),c()(this,"on",(function(e,t,i){Object.getPrototypeOf(this).on.call(this,e,t,i);var n,o=!1;if((e===O.DOM_LOADED&&l()(this,U)||e===O.LOADED&&l()(this,G)||e===O.VISIBILITY)&&(o=!0),o)if(n=e===O.VISIBILITY?new O(O.VISIBILITY,{hidden:!!window.document.hidden}):e===O.DOM_LOADED?new O(O.DOM_LOADED):new O(O.LOADED,{timestamp:l()(this,H)}),i)try{t.call(i,n)}catch(e){x("Error calling callback",t,event)}else t(n)})),w.addDOMLoadListener((function(){f()(t,U,!0),t.trigger(new O(O.DOM_LOADED))})),w.addPageLoadListener((function(){f()(t,G,!0),f()(t,H,(new Date).getTime()),t.trigger(new O(O.LOADED,{timestamp:l()(t,H)}))}));var n=i.throttleTime;window.addEventListener("scroll",b((function(){return t.dispatchViewportEvent(O.SCROLL)}),n),!0),window.addEventListener("resize",b((function(){return t.dispatchViewportEvent(O.RESIZE)}),n)),document.addEventListener("visibilitychange",(function(){return t.dispatchVisibilityChange()})),f()(this,W,!window.document.hidden),window.addEventListener("focus",(function(e){return t.dispatchFocusChange(!0,e)})),window.addEventListener("blur",(function(e){return t.dispatchFocusChange(!1,e)})),f()(this,z,document.hasFocus()),window.addEventListener("beforeunload",(function(){return t.trigger(new O(O.BEFORE_UNLOAD))})),window.document.addEventListener("mouseover",(function(e){return t.trigger(new O(O.MOUSE_OVER,{nativeEvent:e}))})),window.document.addEventListener("mouseout",(function(e){return t.trigger(new O(O.MOUSE_OUT,{nativeEvent:e}))})),window.addEventListener("focusin",(function(e){return t.trigger(new O(O.FOCUS_IN,{nativeEvent:e}))})),window.addEventListener("blur",(function(e){return t.trigger(new O(O.BLUR_CAPTURE,{nativeEvent:e}))}),!0)}return r()(e,[{key:"dispatchViewportEvent",value:function(e){this.trigger(new O(e))}},{key:"dispatchVisibilityChange",value:function(){f()(this,W,!window.document.hidden),this.trigger(new O(O.VISIBILITY,{hidden:!l()(this,W)}))}},{key:"dispatchFocusChange",value:function(e,t){if(l()(this,z)!==e){f()(this,z,e);var i=e?O.FOCUS:O.BLUR;this.trigger(new O(i,{nativeEvent:t}))}}},{key:"domLoaded",get:function(){return l()(this,U)}},{key:"pageLoaded",get:function(){return l()(this,G)}},{key:"isVisible",get:function(){return l()(this,W)}},{key:"hasFocus",get:function(){return l()(this,z)}},{key:"_reset",value:function(){f()(this,U,!1),f()(this,G,!1)}}]),e}();Object.assign(V.prototype,j);var B=V,J=i(10),Z=i.n(J),Y=function e(t){var i=t.topic,n=t.meta,s=void 0===n?{}:n;o()(this,e),this.topic=i,this.meta=s};function X(e,t,i,n){var o=document.createElement("div");t=(t-=2)<66?66:t,o.style.cssText="top:0;right:0;font-size:12px;user-select:none;border-color:#e2e2e2;font-family:Helevetica Neue,Arial,sans-serif;color:#000;height:24px;display:block;"+"min-width:".concat(66,"px;max-width:").concat(t,"px;white-space:nowrap;z-index:214748366;")+"position:absolute;border-style:solid;width:auto;cursor:pointer;border-width:1px;"+i;var s='<span style="position:absolute;right:0;font-size:20px;width:19px;'+'top:2px;line-height:20px;border-left:1px solid black;margin-left:5px;">'.concat(n,"</span>");return o.innerHTML='<span style="'.concat("position:relative;padding:5px 26px 5px 10px;text-align:center;display:block;width:auto;height:auto;overflow:hidden;text-overflow: ellipsis;",'" title="').concat(e,'">').concat(e).concat(s,"</span>"),o}c()(Y,"topic",{WRITE_COMPLETE:"".concat("jac.sandbox",".writeComplete"),PAGE_LOAD:"".concat("jac.sandbox",".pageLoad"),SIZE:"".concat("jac.sandbox",".size"),UNLOAD:"".concat("jac.sandbox",".unload"),CLOSE_AD:"".concat("jac.sandbox",".closeAd")});var q=function(){function e(){o()(this,e)}return r()(e,null,[{key:"createCloseAdButton",value:function(e,t){return X(e,t,"border-color:#e2e2e2;border-bottom-left-radius:6px;background-color:#e2e2e2;","&times;")}},{key:"createOpenAdButton",value:function(e,t){var i=X(e,t,"background:#fff;border-color:#000;border-radius:4px;","&plus;");return i.className="jac-show-ad",i}}]),e}();function K(e){var t=e.document,i=e.closeLabel,n=e.maxWidth,o=e.closeHandler,s=q.createCloseAdButton(i,n);s.setAttribute("id","jac_close"),s.addEventListener("click",o,!1),t.body.appendChild(s)}var $=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,o=n.document,s=e.client.closeButton.enabledForSizes,r="".concat(t.width,"x").concat(t.height),a=!0;Array.isArray(s)&&-1===s.indexOf(r)&&(a=!1);var c=o.getElementById("jac_close");c&&c.parentNode.removeChild(c),e.client.closeButton.enabled&&a&&K({document:o,closeLabel:e.client.closeButton.labels.close,maxWidth:t.width,closeHandler:function(){i.send(new Y({topic:Y.topic.CLOSE_AD,meta:{closeConfig:e.client.closeButton,adSize:{width:t.width}}}))}})};function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var ee=function(e){p()(i,e);var t=Q(i);function i(e){var n,s=e.cmd,r=void 0===s?null:s,a=e.status,c=void 0===a?null:a,u=e.meta,l=void 0===u?{}:u;return o()(this,i),(n=t.call(this,{topic:i.topic.SAFE_FRAME,meta:l})).cmd=r,n.status=c,n}return i}(Y);function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}c()(ee,"topic",{SAFE_FRAME:"jac.sandbox.sf"}),c()(ee,"cmd",{EXPAND_OVER:"exp-ovr",EXPAND_PUSH:"exp-push",RESIZE_TO:"resize-to",COLLAPSE:"collapse",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie",MSG:"msg",HIDE:"hide",SHOW:"show"}),c()(ee,"status",{COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding",RESIZE_TO:"resize-to",GEOMETRY_UPDATE:"geom-update",FOCUS_CHANGE:"focus-change",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie",FAILED:"failed",CMP:"cmp",MSG:"msg",META_UPDATE:"meta-update",HIDE:"hide",SHOW:"show",REGISTER:"register"});var ie=function(e){p()(i,e);var t=te(i);function i(e){var n;return o()(this,i),(n=t.call(this,e.topic)).message=e,n}return i}(y),ne=new WeakMap,oe=new WeakMap,se=new WeakMap,re=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o()(this,e),ne.set(this,{writable:!0,value:void 0}),oe.set(this,{writable:!0,value:void 0}),se.set(this,{writable:!0,value:void 0}),f()(this,ne,i),this.targetWindow=t,f()(this,se,n),Object.keys(n).forEach((function(e){(n[e].before||[]).concat(n[e].after||[]).forEach((function(e){n[e]=n[e]||{}}))}))}return r()(e,[{key:"_sendBulkMessages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.filter((function(t){return l()(e,se)[t]})).forEach((function(t){e.send(new Y({topic:t})),delete l()(e,se)[t]}))}},{key:"send",value:function(e){var t=l()(this,se)[e.topic];delete l()(this,se)[e.topic],t&&this._sendBulkMessages(t.before),this.targetWindow.postMessage(Object.assign({token:l()(this,ne)},e),"*"),t&&this._sendBulkMessages(t.after)}},{key:"listen",value:function(){var e=this;l()(this,oe)||(f()(this,oe,(function(t){return e._handlePostMessage(t)})),window.addEventListener("message",l()(this,oe)))}},{key:"cleanup",value:function(){window.removeEventListener("message",l()(this,oe)),f()(this,oe,null)}},{key:"_handlePostMessage",value:function(e){if(this._shouldReadPostMessage(e)){var t=new(e.data.topic===ee.topic.SAFE_FRAME?ee:Y)(e.data),i=new ie(t);this.trigger(i)}}},{key:"_shouldReadPostMessage",value:function(e){return e.source===this.targetWindow&&e.data&&e.data.token===l()(this,ne)&&e.data.topic}}]),e}();Object.assign(re.prototype,j);var ae=re;var ce={setStyles:function(e,t){Object.keys(t).forEach((function(i){void 0!==t[i]&&(e.style[i]=t[i])}))},getComputedStyle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,n=i.getComputedStyle(e);return t?n.getPropertyValue(t):n}},ue="auto";function le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e,i=document.documentElement,n=t.innerWidth||i.clientWidth||0,o=t.innerHeight||i.clientHeight||0,s=t.screenLeft||t.screenX||0,r=s+n,a=t.screenTop||t.screenY||0,c=a+o;return{top:a,left:s,bottom:c,right:r,width:n,height:o}}function he(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=e.getBoundingClientRect()||{},n=i.left,o=i.right,s=i.top,r=i.bottom;e===t.document.body&&r<t.innerHeight&&(r=t.innerHeight),e===t.document.body&&o<t.innerWidth&&(o=t.innerWidth);var a=ce.getComputedStyle(e,"z-index",t),c=o-n,u=r-s;return{left:n,right:o,top:s,bottom:r,width:c,height:u,zIndex:a}}function fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;return de(t)?t.documentElement:t.body}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return"CSS1Compat"===e.compatMode&&e.documentElement}var pe={getWindowGeometry:le,getElementGeometry:he,getVisibilityMetrics:function(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,o=le(n),s=o.width,r=o.height,a=he(e,n),c=a.width*a.height;if(a.width=a.width||1,a.height=a.height||1,a.right<=0||a.left>s)t=0;else{var u=Math.max(-a.left,0),l=Math.max(a.right-s,0);t=a.width-u-l}if(a.bottom<=0||a.top>r)i=0;else{var h=Math.max(-a.top,0),f=Math.max(a.bottom-r,0);i=a.height-h-f}return{containerPixels:c,xPercentage:t/a.width,yPercentage:i/a.height,totalPercentage:t*i/(c||1)}},isClippingElement:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"X",i=arguments.length>2?arguments[2]:void 0,n=(i=i||ce.getComputedStyle(e))["overflow"+t],o=i.overflow;return"hidden"===n||"scroll"===n||n===ue||"hidden"===o||"scroll"===o||o===ue},isScrollableElement:function(e,t){var i=(t=t||ce.getComputedStyle(e)).overflowX,n=t.overflowY,o=t.overflow,s="scroll"===i||"scroll"===o||(i===ue||o===ue)&&e.scrollWidth>e.clientWidth,r="scroll"===n||"scroll"===o||(n===ue||o===ue)&&e.scrollHeight>e.clientHeight;return s||r},getPageScrollInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=fe(e);return{x:Math.max(t.scrollLeft,0),y:Math.max(t.scrollTop,0),w:Math.max(t.scrollWidth,0),h:Math.max(t.scrollHeight,0)}},getDocumentElement:fe},ve=function(){function e(){o()(this,e)}return r()(e,null,[{key:"isMobileMomentAd",value:function(e){return!!e&&!!e.meta&&"MobileMoments"===e.meta.GoldenFormat}},{key:"computeDisplaySize",value:function(e){var t={width:300,height:533},i=pe.getWindowGeometry();return e.config.client.mobileMoments.enabled&&i.width<=550&&i.width<i.height&&(t.width=i.width,t.height=Math.floor(i.width*(16/9))),t}}]),e}();function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var ge=function(e){p()(i,e);var t=me(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(ge,"INIT_CALLED","".concat("SandboxApi",".INIT_CALLED"));var Ee=new WeakMap,ye=new WeakMap,_e=new WeakMap,Oe=function(){function e(t,i){o()(this,e),Ee.set(this,{writable:!0,value:void 0}),ye.set(this,{writable:!0,value:void 0}),_e.set(this,{writable:!0,value:void 0}),f()(this,Ee,t),f()(this,ye,i.service.sizes||[]);var n=i.client.flexible;f()(this,_e,n.enabled&&(n.width.enabled||n.height.enabled))}return r()(e,[{key:"init",value:function(e){var t=e.w,i=e.h,n=l()(this,ye).indexOf("".concat(t,"x").concat(i))>=0;n&&!l()(this,_e)&&l()(this,Ee).send(new Y({topic:Y.topic.SIZE,meta:{width:t,height:i}})),n&&this.trigger(new ge(ge.INIT_CALLED))}},{key:"unload",value:function(){l()(this,Ee).send(new Y({topic:Y.topic.UNLOAD}))}}]),e}();Object.assign(Oe.prototype,j);var we=Oe,be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features||{};return{"exp-ovr":!(!t.expandOver||!t.expandOver.enabled),"exp-push":!(!t.expandPush||!t.expandPush.enabled),"read-cookie":!(!t.cookies||!t.cookies.read),"write-cookie":!(!t.cookies||!t.cookies.write),"resize-to":!(!t.resize||!t.resize.enabled)}},Te=/^(\d+)x(\d+)$/,Pe=function(e){return e&&e.match(Te)},Re=function(e){var t={width:0,height:0},i=e.match(Te);return i&&(t.width=parseInt(i[1]),t.height=parseInt(i[2])),t},De={NOT_SUPPORTED:"Feature not supported by the host.",NOT_REGISTERED:"No prior $sf.ext.register() API call.",EXPANDED:"Already expanded.",NOT_EXPANDED:"Not expanded.",COMMAND_PENDING:"Command already in-progress.",INVALID_COOKIE_ARGS:"Invalid cookie arguments.",INVALID_ARGS:"Invalid arguments.",INVALID_SIZE:"Setting size to less than 1px is hiding, call $sf.ext.hide instead.",INVALID_HIDDEN_SIZE:"Setting size must be greater than 15 if SafeFrame has been hidden.",MISSING_RESIZE_FLEXIBLE_RATIO:"Flexible safeframes can only be resized by ratio.",NOT_ALLOWED_FLEXIBLE_EXPAND:"Flexible safeframe expansion is not supported."},Ce={COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding",RESIZING:"resizing",HIDDEN:"hidden"},Se=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;o()(this,e),c()(this,"messenger",void 0),c()(this,"windowContext",void 0),c()(this,"sizesConfig",void 0),c()(this,"hasRegistered",!1),c()(this,"pendingCommand",null),c()(this,"alignmentElement",void 0),c()(this,"statusUpdateCallback",void 0),c()(this,"supportsMap",void 0),c()(this,"geomData",void 0),c()(this,"hasFocus",void 0),c()(this,"metaData",void 0),c()(this,"registrationKey",void 0),c()(this,"width",void 0),c()(this,"height",void 0),c()(this,"flexibleConfig",{}),c()(this,"_status",Ce.COLLAPSED),this.messenger=t,this.windowContext=s,this.sizesConfig=i.service.sizes||[];var r=i.client.safeFrame;this.supportsMap=be(r),t.on(ee.topic.SAFE_FRAME,this._onSafeFrameMessage,this),(n=n||{}).geom&&(this.geomData=n.geom),n.focus&&(this.hasFocus=n.focus),this.metaData=n.meta||{},this.flexibleConfig=i.client.flexible}return r()(e,[{key:"_sendMessage",value:function(e){var t=e.cmd,i=e.meta;this.messenger.send(new ee({cmd:t,meta:i})),this.pendingCommand=t}},{key:"_onSafeFrameMessage",value:function(e){var t=e.message,i=t.status,n=t.meta;if(R(i,ee.status)){if(this.pendingCommand===n.cmd&&(this.pendingCommand=null,i===ee.status.FAILED))switch(n.cmd){case ee.cmd.EXPAND_OVER:case ee.cmd.EXPAND_PUSH:case ee.cmd.RESIZE_TO:this._status=Ce.COLLAPSED;break;case ee.cmd.COLLAPSE:this._status=Ce.EXPANDED}this._callStatusUpdate(i,n)}}},{key:"register",value:function(e,t,i){if(this.hasRegistered)throw new Error("$sf.ext.register() can be called only once and has been called already.");if(this.hasRegistered=!0,M.isFunction(i)&&(this.statusUpdateCallback=i),this.sizesConfig.indexOf("".concat(e,"x").concat(t))>=0&&!this.flexibleConfig.enabled){var n=M.int(e,0,0),o=M.int(t,0,0);this.messenger.send(new Y({topic:Y.topic.SIZE,meta:{width:n,height:o}})),this.width=n,this.height=o}this.registrationKey={},this._callStatusUpdate(ee.status.REGISTER,{key:this.registrationKey})}},{key:"_width",value:function(){return M.isSet(this.width)||(this.width=pe.getWindowGeometry().width),this.width}},{key:"_height",value:function(){return M.isSet(this.height)||(this.height=pe.getWindowGeometry().height),this.height}},{key:"_callStatusUpdate",value:function(e,t){var i=t.cmd,n=t.reason,o=t.info,s=t.key;if(e===ee.status.FAILED?console.warn("SafeFrame: command failed",{cmd:i,reason:n,info:o}):e===ee.status.META_UPDATE?this.metaData=o:e===ee.status.GEOMETRY_UPDATE?this.geomData=o:e===ee.status.FOCUS_CHANGE?this.hasFocus=o:e===ee.status.RESIZE_TO?(this.width=o.w,this.height=o.h,this._status=Ce.COLLAPSED):R(e,Ce)&&(e===ee.status.COLLAPSED&&this._align(),this._status=e),this.statusUpdateCallback){var r={cmd:i,reason:n,info:o};s&&(r.key=s),this.statusUpdateCallback.call(this,e,r)}}},{key:"_sendFailureStatus",value:function(e,t){this._callStatusUpdate(ee.status.FAILED,{cmd:e,reason:t})}},{key:"supports",value:function(e){return M.isSet(e)?!!this.supportsMap[e]:this.supportsMap}},{key:"expand",value:function(e){var t,i=e.t,n=e.l,o=e.r,s=e.b,r=e.push?ee.cmd.EXPAND_PUSH:ee.cmd.EXPAND_OVER;if(this.supports(r)?this.hasRegistered?this.pendingCommand?t=De.COMMAND_PENDING:this.status()===Ce.EXPANDED?t=De.EXPANDED:this.flexibleConfig.enabled&&(t=De.NOT_ALLOWED_FLEXIBLE_EXPAND):t=De.NOT_REGISTERED:t=De.NOT_SUPPORTED,t)this._sendFailureStatus(r,t);else{var a={top:M.int(i,0,0),left:M.int(n,0,0),right:M.int(o,0,0),bottom:M.int(s,0,0)};this._align(a),this._sendMessage({cmd:r,meta:a}),this._status=Ce.EXPANDING}}},{key:"collapse",value:function(){var e,t=ee.cmd.COLLAPSE;this.hasRegistered?this.pendingCommand?e=De.COMMAND_PENDING:this.status()!==Ce.EXPANDED&&(e=De.NOT_EXPANDED):e=De.NOT_REGISTERED,e?this._sendFailureStatus(t,e):(this._sendMessage({cmd:t}),this._status=Ce.COLLAPSING)}},{key:"_align",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.top,i=e.left,n=e.right,o=e.bottom;this.alignmentElement||(this.alignmentElement=this.windowContext.document.getElementById("fc_align"));var s={};t&&!o?(s.top=null,s.bottom="0"):(s.top="0",s.bottom=null),i&&!n?(s.left=null,s.right="0"):(s.left="0",s.right=null),ce.setStyles(this.alignmentElement,s),this._adjustWindowContentSize()}},{key:"_adjustWindowContentSize",value:function(){var e=this.windowContext.document.documentElement.style;e.width=e.height="100%"}},{key:"cookie",value:function(e,t){var i,n=t?ee.cmd.WRITE_COOKIE:ee.cmd.READ_COOKIE;this.supports(n)?this.hasRegistered?!e||t&&!t.value?i=De.INVALID_COOKIE_ARGS:this.pendingCommand&&(i=De.COMMAND_PENDING):i=De.NOT_REGISTERED:i=De.NOT_SUPPORTED,i?this._sendFailureStatus(n,i):this._sendMessage({cmd:n,meta:{cookieName:e,cookieData:t}})}},{key:"meta",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"shared",i=Object.prototype.hasOwnProperty,n=this.metaData;if(i.call(n,t)){var o=n[t];if(i.call(o,e))return o[e]}return""}},{key:"status",value:function(){return this._status}},{key:"geom",value:function(){return this.geomData}},{key:"inViewPercentage",value:function(){if(this.geomData){var e=this.geomData.self.iv;return Math.round(100*e)}}},{key:"winHasFocus",value:function(){return this.hasFocus}},{key:"resizeTo",value:function(e){var t,i,n,o=ee.cmd.RESIZE_TO;if(this.supports(ee.cmd.RESIZE_TO)?M.isObject(e)?this.hasRegistered?this._status===Ce.EXPANDED?n=De.EXPANDED:this.pendingCommand?n=De.COMMAND_PENDING:this.flexibleConfig.enabled&&!Pe(e.ratio)&&(n=De.MISSING_RESIZE_FLEXIBLE_RATIO):n=De.NOT_REGISTERED:n=De.INVALID_ARGS:n=De.NOT_SUPPORTED,!n)if(t=M.int(e.w,this._width()),i=M.int(e.h,this._height()),t<=1||i<=1)n=De.INVALID_SIZE;else if(this._status===Ce.HIDDEN&&(t<=15||i<=15))n=De.INVALID_HIDDEN_SIZE;else if(t===this.width&&i===this.height&&!this.flexibleConfig.enabled)return;n?this._sendFailureStatus(o,n):(this._adjustWindowContentSize(),this._sendMessage({cmd:ee.cmd.RESIZE_TO,meta:this.flexibleConfig.enabled?{ratio:e.ratio}:{width:t,height:i}}),this._status=Ce.RESIZING)}},{key:"hide",value:function(e){this._status=Ce.HIDDEN}},{key:"show",value:function(e){}},{key:"ui",value:function(){var e={flex:0};return this.flexibleConfig.enabled&&(this.flexibleConfig.width.enabled&&this.flexibleConfig.height.enabled?e.flex="both":this.flexibleConfig.width.enabled?e.flex="w":this.flexibleConfig.height.enabled&&(e.flex="h")),e}}]),e}();c()(Se,"FailureReason",De);var Ae,ke=new WeakMap,Ie=function(){function e(t,i,n,s){o()(this,e),ke.set(this,{writable:!0,value:void 0}),f()(this,ke,new Se(t,i,n,s))}return r()(e,[{key:"register",value:function(e,t,i){l()(this,ke).register(e,t,i)}},{key:"supports",value:function(e){return l()(this,ke).supports(e)}},{key:"expand",value:function(e){l()(this,ke).expand(e)}},{key:"collapse",value:function(){l()(this,ke).collapse()}},{key:"cookie",value:function(e,t){l()(this,ke).cookie(e,t)}},{key:"meta",value:function(e,t){return l()(this,ke).meta(e,t)}},{key:"status",value:function(){return l()(this,ke).status()}},{key:"geom",value:function(){return l()(this,ke).geom()}},{key:"inViewPercentage",value:function(){return l()(this,ke).inViewPercentage()}},{key:"winHasFocus",value:function(){return l()(this,ke).winHasFocus()}},{key:"resizeTo",value:function(e){return l()(this,ke).resizeTo(e)}},{key:"hide",value:function(e){return l()(this,ke).hide(e)}},{key:"show",value:function(e){return l()(this,ke).show(e)}},{key:"msg",value:function(e,t){l()(this,ke).msg(e,t)}},{key:"ui",value:function(){return l()(this,ke).ui()}},{key:"hostURL",value:function(){return document.referrer}}]),e}(),Ne=function(){function e(t){o()(this,e),c()(this,"messenger",void 0),c()(this,"lastMessageSentTime",void 0),this.messenger=t}return r()(e,[{key:"_sendMessage",value:function(e){var t=e.cmd,i=e.meta;this.messenger.send(new ee({cmd:t,meta:i}))}},{key:"msg",value:function(e){return!(this.lastMessageSentTime&&!(this.lastMessageSentTime<(new Date).getTime()-200))&&(this._sendMessage({cmd:ee.cmd.MSG,meta:e}),this.lastMessageSentTime=(new Date).getTime(),!0)}}]),e}(),Me={"1AS":"1AS",VZMSSP:"VZMSSP",PG:"PG",pointguard:"pointguard"},xe="px",Le=1,Fe=2,je=3,Ue="SF",Ge="NFIF",We="FIF",ze=0,He=1,Ve=2,Be=3,Je=4,Ze=5,Ye=!1;function Xe(e){var t=e.positionConfig,i=e.initialWidth,n=e.initialHeight,o=e.allowedSizes,s=t.client.sandbox.anchorTarget;if(Ae.send(new Y({topic:Y.topic.PAGE_LOAD})),Ye&&!t.client.flexible.enabled&&function e(t,i,n,o){var s=document.body.scrollWidth,r=document.body.scrollHeight;if(s>t||r>i){var a=function(e,t,i){var n=e*t,o=1e5,s={};return i.forEach((function(e){var t=Math.abs(n-e.width*e.height);t<o&&(o=t,s=e)})),s}(s,r,n),c=a.width,u=a.height;Ae.send(new Y({topic:Y.topic.SIZE,meta:{width:c,height:u}})),$(o,{width:c,height:u},Ae,window)}else qe>0&&(qe-=100,setTimeout((function(){e(t,i,n,o)}),100))}(i,n,o,t),$(t,{width:i,height:n},Ae,window),s)for(var r=document.getElementsByTagName("a"),a=0;a<r.length;a++){r[a].setAttribute("target",s)}}var qe=4e3;var Ke={getParameter:function(e,t){t=t.replace(/[[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},getParameters:function(e,t){var i=this;return t.reduce((function(t,n){var o=i.getParameter(e,n);return o&&(t[n]=o),t}),{})},removeParameters:function(e){return e&&"string"==typeof e?e.split(/[?#]/)[0]:""}},$e={clone:function(e){var t=this;return e.map((function(e){return Array.isArray(e)?t.clone(e):"object"===P()(e)?Qe.copy(e,{}):e}))},diff:function(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))},isSubset:function(e,t){return this.diff(e,t).length<=0},remove:function(e,t){var i=e.indexOf(t);i>=0&&e.splice(i,1)},removeDuplicates:function(e){return e.filter((function(t,i){return e.indexOf(t)===i}))}},Qe={clone:function(e){return this.copy(e,{})},copy:function(e,t,i){var n=this;return Object.keys(e).forEach((function(o){var s=e[o];s instanceof HTMLElement?i&&M.isSet(t[o])||(t[o]=s):M.isObject(s)&&null!==s&&!Array.isArray(s)?(t[o]=t[o]||{},n.copy(e[o],t[o],i)):i&&M.isSet(t[o])||(t[o]=Array.isArray(s)?$e.clone(s):s)})),t},removeEmptyItems:function(e){var t=this;return Object.keys(e).forEach((function(i){var n=e[i];n&&M.isObject(n)?(t.removeEmptyItems(n),0===Object.keys(n).length&&delete e[i]):(n&&Array.isArray(n)&&0===n.length||M.isString(n)&&!n)&&delete e[i]})),e}};var et={service:{params:{}},client:{nestedIframe:!1,closeButton:{enabled:!1,showButtonEnabled:!0,preserveState:!1,animation:{enabled:!0,duration:333},labels:{close:"Close ad",show:"Show ad"}},fetch:{auto:!0,minInterval:2e3,timeout:3e4},flexible:{enabled:!1,width:{enabled:!0,min:0,max:9999},height:{enabled:!0,min:0,max:9999},ratio:""},render:{delayedLoadInLegacyIE:!1,timeout:1e4,auto:!0,requireViewable:!1},layout:{zIndex:10},rotation:{enabled:!1,period:2e4,limit:3,requireViewable:!0,inViewDuration:1e3,resizable:!1,cancellable:!0,onNoAd:!1},nonFriendlyIframe:{enabled:!1},safeFrame:{enabled:!1,features:{expandOver:{enabled:!0},expandPush:{enabled:!1},resize:{enabled:!1},cookies:{read:!1,write:!1,allowed:["CRZY"]}}},sandbox:{anchorTarget:"_blank",features:{fullscreen:{enabled:!0},autoplay:{enabled:!0},geolocation:{enabled:!1},camera:{enabled:!1},microphone:{enabled:!1}},allow:["forms","scripts","same-origin","popups","popups-to-escape-sandbox"]},placeholder:{enabled:!1,text:"Advertisement",fontSize:"12px",textColor:"#6e7780",backgroundColor:"#f5f8fa"},mobileMoments:{enabled:!1},viewability:{percent:50,pixels:0,duration:1e3},content:{},meta:{shared:{}}}},tt={client:{closeButton:{animation:{duration:{minimum:0,rule:!0}}},fetch:{minInterval:{minimum:500,rule:!0}},flexible:{width:{min:{minimum:0,maximum:9999,rule:!0},max:{minimum:0,maximum:9999,rule:!0}},height:{min:{minimum:0,maximum:9999,rule:!0},max:{minimum:0,maximum:9999,rule:!0}}},rotation:{period:{minimum:100,rule:!0},limit:{minimum:1,rule:!0}}}};function it(e){var t=Qe.clone(et);return Qe.copy(e,t),t.client.safeFrame.enabled||delete t.client.safeFrame.features,t}var nt=function(){function e(t){o()(this,e),c()(this,"service",void 0),c()(this,"client",void 0),c()(this,"input",void 0),this.update(t)}return r()(e,[{key:"update",value:function(e){if(!M.isObject(e.client))throw new Error("Invalid ".concat("client"," argument. Object is expected"));if(!M.isSet(e.client.targetElement))throw new Error("No target HTML element configured for position.");var t,i=((t=Qe.clone(e)).client&&t.client.features&&(console.warn('JAC: Support for the "features" property of the client config has been deprecated and will be removed in the future versions. Please move all the "features" one level up in the config.'),Object.assign(t.client,t.client.features),delete t.client.features),t);this.input=Qe.clone(i),function e(t,i){Object.keys(i).forEach((function(n){var o,s,r=P()(t[n]);i[n].rule?"undefined"!==r&&(o=t[n],s=i[n],"number"==typeof o&&"number"==typeof s.minimum&&o<s.minimum||"number"==typeof o&&"number"==typeof s.maximum&&o>s.maximum)&&delete t[n]:"object"===r&&e(t[n],i[n])}))}(i,tt);var n=it(i);Object.assign(this,n)}},{key:"updateRotationConfig",value:function(e){var t=this,i=!1;return e?(Object.keys(e).forEach((function(n){var o=e[n];o!==t.client.rotation[n]&&(t.client.rotation[n]=o,i=!0)})),i):i}},{key:"resetRotationConfig",value:function(){var e=it(Qe.clone(this.input)).client.rotation;return this.updateRotationConfig(e)}},{key:"updateMeta",value:function(e,t,i){var n=!1,o=M.isString(e)&&M.isSet(t);return M.isObject(e)?(this.client.meta=e,n=!0):M.isString(i)&&this.client.meta[i]&&o?(this.client.meta[i][e]=t,n=!0):o&&(this.client.meta.shared[e]=t,n=!0),n}},{key:"getTargetElement",value:function(){var e=this.client.targetElement;return M.isString(e)?document.getElementById(e):e}}],[{key:"getFromConfig",value:function(e,t){var i=e.service&&e.service.positions||{},n=e.client&&e.client.positions||{},o=i[t],s=n[t];return o||s?{service:o||{},client:s||{}}:null}},{key:"updateInConfig",value:function(e,t,i){var n=i.service,o=i.client;n&&(e.service=e.service||{},e.service.positions=e.service.positions||{},e.service.positions[t]=n),o&&(e.client=e.client||{},e.client.positions=e.client.positions||{},e.client.positions[t]=o)}},{key:"removeFromConfig",value:function(e,t){e.service.positions&&delete e.service.positions[t],e.client.positions&&delete e.client.positions[t]}}]),e}();c()(nt,"MINIMUM_ROTATION_INTERVAL",100);var ot=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;o()(this,e),e.PAGE_ROTATION_INFO=e._getPageRotationParams(t)}return r()(e,[{key:"createRotationConfig",value:function(e,t){var i=Qe.clone(e.client.rotation);if(i.enabled){this._shouldRotateFromComments(t)||(i.enabled=!1);var n=this._getEnvironmentRotationInfo(e,t);return n.RefreshTime&&(i.period=1e3*n.RefreshTime),n.RefreshMax&&(i.limit=n.RefreshMax),n.RefreshKeepSize&&(i.resizable="N"===n.RefreshKeepSize),i}}},{key:"getRotationAliasBasedOnSize",value:function(e,t){return t=t||e.content.size,this._isCommentPresent(e,"RefreshSmall")&&!this._isLargeAd(t)?e.meta.RefreshSmall:this._isCommentPresent(e,"RefreshLarge")&&this._isLargeAd(t)?e.meta.RefreshLarge:void 0}},{key:"_shouldRotateFromComments",value:function(e){var t=e.meta,i=t.AdTypePriority?parseInt(t.AdTypePriority):-1;return!("N"===t.RefreshExclusive&&"N"===t.MP&&i>=493||"N"===t.RefreshReserved&&"N"===t.MP&&i>=200&&i<493)&&(this._isCommentPresent(e,"RefreshMN")||this._isCommentPresent(e,"RefreshSmall")&&!this._isLargeAd(e.content.size)||this._isCommentPresent(e,"RefreshLarge")&&this._isLargeAd(e.content.size))}},{key:"_getEnvironmentRotationInfo",value:function(t,i){var n={RefreshTime:i.meta.RefreshTime,RefreshMax:i.meta.RefreshMax,RefreshKeepSize:i.meta.RefreshKeepSize};n.RefreshTime=n.RefreshTime?parseInt(n.RefreshTime):void 0,n.RefreshMax=n.RefreshMax?parseInt(n.RefreshMax):void 0;var o={},s=t.input.client&&t.input.client.rotation;return s&&(s.period&&s.period>nt.MINIMUM_ROTATION_INTERVAL&&(o.RefreshTime=s.period/1e3),s.limit&&(o.RefreshMax=s.limit),M.isSet(s.resizable)&&(o.RefreshKeepSize=s.resizable?"N":"Y")),Object.assign(n,o,e.PAGE_ROTATION_INFO)}},{key:"_isCommentPresent",value:function(e,t){return Object.prototype.hasOwnProperty.call(e.meta,t)}},{key:"_isLargeAd",value:function(e){return e.width>=970||e.height>=600}}],[{key:"_getPageRotationParams",value:function(e){var t=Ke.getParameters(e.location.href,["RefreshTime","RefreshMax","RefreshKeepSize"]);return["RefreshTime","RefreshMax"].forEach((function(e){t[e]&&(t[e]=parseInt(t[e]))})),t}}]),e}();function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}c()(ot,"PAGE_ROTATION_INFO",void 0);var rt=function(e){p()(i,e);var t=st(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(rt,"FETCH_START","FETCH_START"),c()(rt,"FETCH_COMPLETE","FETCH_COMPLETE"),c()(rt,"FETCH_TIMEOUT","FETCH_TIMEOUT"),c()(rt,"FETCH_ERROR","FETCH_ERROR"),c()(rt,"RENDER_START","RENDER_START"),c()(rt,"RENDER_COMPLETE","RENDER_COMPLETE"),c()(rt,"POSITION_CREATED","POSITION_CREATED"),c()(rt,"POSITION_ROTATE","POSITION_ROTATE"),c()(rt,"POSITION_RENDER_START","POSITION_RENDER_START"),c()(rt,"POSITION_RENDER_COMPLETE","POSITION_RENDER_COMPLETE"),c()(rt,"POSITION_RENDER_FAILED","POSITION_RENDER_FAILED"),c()(rt,"POSITION_COLLAPSED","POSITION_COLLAPSED"),c()(rt,"POSITION_VIEW_START","POSITION_VIEW_START"),c()(rt,"POSITION_VIEW_END","POSITION_VIEW_END"),c()(rt,"POSITION_VIEWABLE","POSITION_VIEWABLE"),c()(rt,"POSITION_CONFIG_CHANGED","POSITION_CONFIG_CHANGED"),c()(rt,"AD_LOAD_COMPLETE","AD_LOAD_COMPLETE"),c()(rt,"AD_SIZE_CHANGED","AD_SIZE_CHANGED"),c()(rt,"AD_MESSAGE","AD_MESSAGE"),c()(rt,"AD_CLOSED","AD_CLOSED"),c()(rt,"AD_OPENED","AD_OPENED");var at=rt,ct={service:{host:"https://jill.fc.yahoo.com/",debug:!1,adServer:{"1AS":{params:{}},VZMSSP:{params:{}},PG:{siteAttributes:{}}},positions:{},site:{name:"",queryParams:"",pageSessionId:"xxxxxxxxx".replace(/[x]/g,(function(){return Math.floor(16*Math.random()).toString(16)}))},user:{regs:{gdpr:{apiStatus:Ve,applies:null,euconsent:""},ccpa:{apiStatus:Ve,usPrivacy:""}},cookies:{},eids:[]}},client:{focusProtection:!0,positions:{},rotation:{groups:[]},idProviders:{verizonMedia:{pixelId:"58322",email:null}},trackers:{opus:!0,smartPixel:!1,msftSync:!1}}};function ut(e){var t=ct.service,i=e.document.referrer;i&&(t.site.referrer=i)}function lt(e){var t,i,n=Qe.clone(ct);return Qe.copy(e,n),t=n,(i=e).service&&i.service.adServer&&Object.keys(Me).forEach((function(e){i.service.adServer[e]||delete t.service.adServer[e]})),n}var ht=new WeakMap,ft=new WeakMap,dt=function(){function e(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;o()(this,e),ht.set(this,{writable:!0,value:void 0}),ft.set(this,{writable:!0,value:{}}),c()(this,"service",void 0),c()(this,"client",void 0),c()(this,"input",void 0),c()(this,"positions",{}),f()(this,ht,n),this.input=Qe.clone(t);var s=Qe.clone(t);s.client=s.client||{},s.service=s.service||{},ut(n);var r=s.service.adServer;r&&r.pointguard&&(r.PG=r.pointguard,delete r.pointguard);var a=lt(s);this.service=a.service,this.client=a.client;var u=nt.getFromConfig(this.input,"DEFAULT");u&&(delete this.service.positions.DEFAULT,delete this.client.positions.DEFAULT,this._addOrUpdatePosition("DEFAULT",u)),Object.keys(this.client.positions).forEach((function(e){var t=nt.getFromConfig(i.input,e);i._addOrUpdatePosition(e,t)})),e.applyOverrides(this,n.location.href)}return r()(e,[{key:"addPosition",value:function(t,i){this._addOrUpdatePosition(t,i),e.applyOverrides(this,l()(this,ht).location.href)}},{key:"updatePosition",value:function(t,i){this._addOrUpdatePosition(t,i),e.applyOverrides(this,l()(this,ht).location.href)}},{key:"_addOrUpdatePosition",value:function(e,t){var i=Qe.clone(t);"DEFAULT"===e?f()(this,ft,i):(Qe.copy(l()(this,ft),i,!0),this.positions[e]?this.positions[e].update(i):this.positions[e]=new nt(i),nt.updateInConfig(this,e,this.positions[e])),nt.updateInConfig(this.input,e,i)}},{key:"removePosition",value:function(e){nt.removeFromConfig(this.input,e),nt.removeFromConfig(this,e),"DEFAULT"===e?f()(this,ft,{}):delete this.positions[e]}},{key:"setRegulatoryData",value:function(e){this.service.user.regs.gdpr.apiStatus=e.data.GDPR.apiStatus,this.service.user.regs.gdpr.applies=e.data.GDPR.applies,this.service.user.regs.gdpr.euconsent=e.data.GDPR.euconsent,this.service.user.regs.ccpa.apiStatus=e.data.CCPA.apiStatus,this.service.user.regs.ccpa.usPrivacy=e.data.CCPA.usPrivacy}},{key:"setUserIdentity",value:function(e){M.isSet(e.ids.VZM_CONNECTID)&&this.service.user.eids.push({source:"verizonmedia.com",uids:[{id:e.ids.VZM_CONNECTID}]})}},{key:"updateMeta",value:function(e,t,i,n){var o=this.positions[e];return!!o&&o.updateMeta(t,i,n)}},{key:"clone",value:function(){return Qe.clone({service:this.service,client:this.client})}},{key:"getFetchTimeout",value:function(e){var t=this;return(e=e||Object.keys(this.positions)).reduce((function(e,i){var n=t.positions[i].client.fetch.timeout;return!e||n<e?n:e}),null)}},{key:"getServiceConfigForFetch",value:function(e){var t=this,i=Qe.clone(this.service);if(delete i.user.email,delete i.host,i.debug?i.debug=!0:delete i.debug,!i.site.url){var n=l()(this,ht).location.href;i.site.url=Ke.removeParameters(n)}!function(e){e.user.regs.ccpa.usPrivacy||delete e.user.regs.ccpa}(i),Qe.removeEmptyItems(i),this.service.adServer.PG&&!i.adServer&&(i.adServer={PG:{}});var o={};return e.positionNames.forEach((function(n){var s=i.positions,r=s&&s[n]||(t.service.positions[n]?{}:null);if(r){var a=e.optionsPerPosition[n],c=a?a.fetchSize:null;if(t.positions[n].client.rotation.resizable||!c)o[n]=r;else{var u="".concat(c.width,"x").concat(c.height);(a.allowedSizes||r.sizes).indexOf(u)>=0&&(r.sizes=[u],o[n]=r)}}})),i.positions=o,i}},{key:"isServiceConfigValid",value:function(){if(!this.service)return console.warn("No service config has been set."),!1;if(!this.service.adServer)return console.warn("No service.adServer config has been set."),!1;if(!this.service.positions)return console.warn("No service.positions config has been set."),!1;var e=this.service.adServer,t=Object.keys(Me).filter((function(t){return e[t]}));if(0===t.length)return console.warn("No valid adServer config has been set."),!1;if(t.length>1)return console.warn("Only one adServer can be configured."),!1;if(-1!==t.indexOf(Me["1AS"])){if(!e["1AS"].region)return console.warn("1AS adServer config requires region to be set."),!1}else if(!(-1===t.indexOf(Me.PG)||this.service.site&&this.service.site.spaceId))return console.warn("PG adServer config requires the site spaceId to be set."),!1;return!this.service.host||/^https?:\/\/.*\//i.test(this.service.host)}}],[{key:"applyOverrides",value:function(e,t){var i=Ke.getParameters(t,["jac.cp","jac.noad","jac.kvs","jac.ip","atwCrPr","atwMN","atwKV"]),n=Object.keys(i).map((function(e){return"".concat(e,"=").concat(i[e])})),o=e.service.site.queryParams,s=o?[o]:[];e.service.site.queryParams=s.concat(n).join("&"),"1"===Ke.getParameter(t,"jac.debug")&&(e.service.debug=!0);var r=Ke.getParameter(t,"jac.sf");Object.keys(e.positions).forEach((function(t){var i=e.positions[t];"1"===r&&(i.client.safeFrame.enabled=!0)}));var a=Ke.getParameter(t,"jac.rotate");a&&Object.keys(e.positions).forEach((function(t){var i=e.positions[t].client;i.rotation&&("0"===a?i.rotation.enabled=!1:i.rotation.period=1e3*a)}))}}]),e}();function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var vt=function(e){p()(i,e);var t=pt(i);function i(e,n){var s;return o()(this,i),(s=t.call(this,e)).meta=n,s}return i}(y);c()(vt,"FETCH_START","".concat("Jill",".FETCH_START")),c()(vt,"FETCH_COMPLETE","".concat("Jill",".FETCH_COMPLETE")),c()(vt,"FETCH_TIMEOUT","".concat("Jill",".FETCH_TIMEOUT")),c()(vt,"FETCH_ERROR","".concat("Jill",".FETCH_ERROR")),c()(vt,"RESPONSE_PROCESSED","".concat("Jill",".RESPONSE_PROCESSED"));var mt={},gt=function(e,t,i){var n=document.createElement("script");n.className="jac-fetch",n.src=e,n.onload=t,n.onerror=i,(document.body||document.head).appendChild(n),mt[e]=n},Et=function(e){var t=mt[e];t&&(t.parentNode.removeChild(t),delete mt[e])},yt=i(11),_t=i.n(yt),Ot=function(){function e(t){o()(this,e),c()(this,"positionNames",void 0),c()(this,"completedPositionNames",[]),c()(this,"abortedPositionNames",[]),c()(this,"startTime",void 0),c()(this,"endTime",void 0),Object.assign(this,t)}return r()(e,[{key:"start",value:function(){this.startTime||(this.startTime=(new Date).getTime())}},{key:"end",value:function(){this.endTime||(this.endTime=(new Date).getTime(),this.completedPositionNames=this.completedPositionNames.concat(this.positionNames),this.positionNames=[])}},{key:"isPending",value:function(e){return!(this.endTime||e&&!(this.positionNames.indexOf(e)>-1))}},{key:"completePosition",value:function(e){this._movePositionName(e,this.completedPositionNames)}},{key:"abortPosition",value:function(e){this._movePositionName(e,this.abortedPositionNames)}},{key:"_movePositionName",value:function(e,t){var i=this.positionNames.indexOf(e);i>-1&&t.indexOf(e)<0&&(t.push(e),this.positionNames.splice(i,1))}}]),e}();function wt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var bt=function(e){p()(i,e);var t=wt(i);function i(e){var n;return o()(this,i),(n=t.call(this,e)).optionsPerPosition=n.optionsPerPosition||{},n}return r()(i,[{key:"isPending",value:function(e){return this.status!==je&&_t()(E()(i.prototype),"isPending",this).call(this,e)}}]),i}(Ot);c()(bt,"ACTION_NAME","fetch");var Tt={};var Pt=new WeakMap,Rt=new WeakMap,Dt=function(){function e(t){o()(this,e),Pt.set(this,{writable:!0,value:void 0}),Rt.set(this,{writable:!0,value:!0}),c()(this,"_fetchActions",Tt),f()(this,Pt,t)}return r()(e,[{key:"process",value:function(){if(void 0!==window.JAC_QUEUE&&window.JAC_QUEUE.length>0){var e=window.JAC_QUEUE.shift();if(function(e,t){if(e&&e.client){var i=e.client,n=i.version,o=i.allowed;return n&&n!==t?(console.error("Client version in response from Jill does not match JAC.version."),!1):!!(n||o&&o.length&&-1!==o.indexOf(t))||(console.error("This version of JAC library is not allowed to process response from Jill. Please load JAC using client endpoint provided by Jill."),!1)}return!1}(e,l()(this,Pt))){var t=e.client.requestId,i=Tt[t];if(0===t){var n=e.positions;(i=new bt({positionNames:Object.keys(n),status:Le})).start(),this.trigger(new vt(vt.FETCH_START,{prefetched:!0,request:{positions:n}}))}if(i.status!==je){f()(this,Rt,!1);var o=function(e){return Tt[e]?Tt[e].url:void 0}(t);this.trigger(new vt(vt.RESPONSE_PROCESSED,{response:e,fetchAction:i,url:o}))}return e}}return null}},{key:"fetchAds",value:function(t,i){var n=this,o=t.positionNames,s=i.getServiceConfigForFetch(t),r=s.requestId=e.REQUEST_ID++;s.metrics=l()(this,Rt);var a="".concat(i.service.host).concat("v2/ads/js","?jacVersion=").concat(l()(this,Pt))+"&config=".concat(encodeURIComponent(JSON.stringify(s)));t.url=a,Tt[r]=t;var c=i.getFetchTimeout(o),u=!1;function h(e){u||(u=!0,clearTimeout(f),setTimeout((function(){Et(a)}),0),e())}var f=setTimeout((function(){return h((function(){Tt[r].status=je,n.trigger(new vt(vt.FETCH_TIMEOUT,{url:a,positionNames:o}))}))}),c);this.trigger(new vt(vt.FETCH_START,{request:s,url:a})),gt(a,(function(){return h((function(){n.trigger(new vt(vt.FETCH_COMPLETE,{url:a}))}))}),(function(e){return h((function(){n.trigger(new vt(vt.FETCH_ERROR,{positionNames:o,scriptErrorEvent:e}))}))}))}}]),e}();c()(Dt,"REQUEST_ID",1),Object.assign(Dt.prototype,j);var Ct=Dt;function St(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var At=function(e){p()(i,e);var t=St(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(At,"CONFIG_UPDATE","".concat("Position",".CONFIG_UPDATE")),c()(At,"ROTATION_UPDATE","".concat("Position",".ROTATION_UPDATE"));var kt=new WeakMap,It=new WeakMap,Nt=function(){function e(t,i){if(o()(this,e),kt.set(this,{writable:!0,value:void 0}),It.set(this,{writable:!0,value:!1}),c()(this,"name",void 0),c()(this,"config",void 0),c()(this,"adData",void 0),c()(this,"fetch",void 0),c()(this,"render",void 0),!M.isString(t))throw new Error("Invalid ".concat("name"," argument. String is expected"));this.name=t,this.update(i)}return r()(e,[{key:"update",value:function(e){this.config=e,this.updateContainerType(),this.trigger(new At(At.CONFIG_UPDATE,this.config)),this.trigger(new At(At.ROTATION_UPDATE,this.config))}},{key:"containerType",get:function(){return l()(this,kt)}},{key:"updateContainerType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.config.client,i=t.safeFrame,n=t.nonFriendlyIframe;"true"===e.friendlyIframe&&i.enabled?f()(this,kt,We):i&&i.enabled?f()(this,kt,Ue):n&&n.enabled?f()(this,kt,Ge):f()(this,kt,We)}},{key:"resetRotation",value:function(){this.rotated=!1;var e=this.config.resetRotationConfig(),t=this.config.service;t.alias=t.params.origmn||t.alias,delete t.params.origmn,this.trigger(new At(At.CONFIG_UPDATE,this.config)),e&&this.trigger(new At(At.ROTATION_UPDATE,this.config))}},{key:"updateRotationConfig",value:function(e){this.config.updateRotationConfig(e)&&(this.trigger(new At(At.CONFIG_UPDATE,this.config)),this.trigger(new At(At.ROTATION_UPDATE,this.config)))}},{key:"alias",get:function(){return this.config.service.alias},set:function(e){if(e){var t=this.config.service;if(t.alias!==e){var i=t.params.origmn||t.alias;i&&(t.params.origmn=i),t.alias=e,this.trigger(new At(At.CONFIG_UPDATE,this.config))}}}},{key:"rotated",get:function(){return l()(this,It)},set:function(e){f()(this,It,e)}},{key:"applyAdData",value:function(e){this.adData=e}}]),e}();function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}Object.assign(Nt.prototype,j);var xt=function(e){p()(i,e);var t=Mt(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}c()(xt,"RENDER_START","".concat("PositionComponent",".RENDER_START")),c()(xt,"RENDER_COMPLETE","".concat("PositionComponent",".RENDER_COMPLETE")),c()(xt,"RENDER_FAILED","".concat("PositionComponent",".RENDER_FAILED")),c()(xt,"AD_OPENED","".concat("PositionComponent",".AD_OPENED")),c()(xt,"AD_CLOSED","".concat("PositionComponent",".AD_CLOSED")),c()(xt,"AD_LOAD","".concat("PositionComponent",".AD_LOAD")),c()(xt,"AD_LOAD_TIMEOUT","".concat("PositionComponent",".AD_LOAD_TIMEOUT")),c()(xt,"NO_AD","".concat("PositionComponent",".NO_AD")),c()(xt,"RESIZE","".concat("PositionComponent",".RESIZE")),c()(xt,"SHOW","".concat("PositionComponent",".SHOW")),c()(xt,"HIDE","".concat("PositionComponent",".HIDE")),c()(xt,"DESTROY","".concat("PositionComponent",".DESTROY")),c()(xt,"VIEW_START","".concat("PositionComponent",".VIEW_START")),c()(xt,"VIEW_END","".concat("PositionComponent",".VIEW_END")),c()(xt,"VIEWABLE","".concat("PositionComponent",".VIEWABLE")),c()(xt,"MOUSE_OUT","".concat("PositionComponent",".MOUSE_OUT")),c()(xt,"AD_SIZE_CHANGED","".concat("PositionComponent",".AD_SIZE_CHANGED")),c()(xt,"GEOMETRY_CHANGED","".concat("PositionComponent",".GEOMETRY_CHANGED")),c()(xt,"AD_META_CHANGED","".concat("PositionComponent",".AD_META_CHANGED")),c()(xt,"AD_MESSAGE","".concat("PositionComponent",".AD_MESSAGE")),c()(xt,"SAFE_FRAME_GEOMETRY_CHANGED","".concat("PositionComponent",".SAFE_FRAME_GEOMETRY_CHANGED"));var Ft=function(e){p()(i,e);var t=Lt(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(Ft,"RENDER_COMPLETE","".concat("Render",".RENDER_COMPLETE")),c()(Ft,"AD_LOAD","".concat("Render",".AD_LOAD")),c()(Ft,"AD_LOAD_TIMEOUT","".concat("Render",".AD_LOAD_TIMEOUT")),c()(Ft,"AD_CLOSED","".concat("Render",".AD_CLOSED")),c()(Ft,"AD_OPENED","".concat("Render",".AD_OPENED"));var jt=function(){function e(){o()(this,e)}return r()(e,null,[{key:"computeFlexibleSize",value:function(e,t,i){var n=e.flexible,o=n.width,s=n.height,r={};if(!o.enabled&&!s.enabled)return r;var a={width:"100%",height:"100%"};if(Pe(e.flexible.ratio)){var c=function(e,t,i,n){var o={};if(t.height.enabled){var s=ce.getComputedStyle(i),r=e.height/e.width,a=t.width.enabled?parseInt(s.width):n.width;o.height=a*r+"px"}else{var c=e.width/e.height;o.width=n.height*c+"px"}return o}(Re(e.flexible.ratio),e.flexible,t,i);Qe.copy(c,a)}return o.enabled&&(r.width=a.width,r.minWidth=o.min+"px",r.maxWidth=o.max+"px"),s.enabled&&(r.height=a.height,r.minHeight=s.min+"px",r.maxHeight=s.max+"px"),r}}]),e}();function Ut(e,t){var i=e.cookie.split(";").reduce((function(e,i){var n=i.indexOf("="),o=i.substring(0,n).trim();return t===o&&(e=i.substring(n+1)),e}),"");return i||null}var Gt=new WeakMap,Wt=new WeakMap,zt=new WeakMap,Ht=new WeakMap,Vt=new WeakMap,Bt=function(){function e(t,i){o()(this,e),Gt.set(this,{writable:!0,value:void 0}),Wt.set(this,{writable:!0,value:void 0}),zt.set(this,{writable:!0,value:{}}),Ht.set(this,{writable:!0,value:[]}),Vt.set(this,{writable:!0,value:void 0}),f()(this,Gt,t),f()(this,Wt,i),f()(this,Vt,i.position.config.client.safeFrame),f()(this,zt,be(l()(this,Vt))),f()(this,Ht,i.position.adData.config.service.sizes||[]),this._toggleEventListeners(!0)}return r()(e,[{key:"messenger",get:function(){return l()(this,Gt)}},{key:"component",get:function(){return l()(this,Wt)}},{key:"cleanup",value:function(){this._toggleEventListeners(!1),l()(this,Gt).cleanup()}},{key:"_onSizeChange",value:function(e){var t=e.message.meta,i=t.width,n=t.height;i&&n&&l()(this,Ht).indexOf("".concat(i,"x").concat(n))>=0&&l()(this,Wt).setSize({width:i,height:n})}},{key:"_onCloseAd",value:function(e){l()(this,Wt).closeAd(e.message.meta)}},{key:"_onUnload",value:function(){this.cleanup(),l()(this,Wt).unloadAd()}},{key:"_onSafeFrameMessage",value:function(e){var t=e.message,i=t.cmd,n=t.meta;if(!1!==l()(this,zt)[i])switch(i){case ee.cmd.EXPAND_OVER:case ee.cmd.EXPAND_PUSH:this._expand(n,i===ee.cmd.EXPAND_PUSH),this._sendStatusUpdate(ee.status.EXPANDED,{cmd:i});break;case ee.cmd.COLLAPSE:this._collapse(),this._sendStatusUpdate(ee.status.COLLAPSED,{cmd:i});break;case ee.cmd.READ_COOKIE:this._readCookie(n.cookieName);break;case ee.cmd.WRITE_COOKIE:this._writeCookie(n.cookieName,n.cookieData);break;case ee.cmd.MSG:this._receivedAdMessage(n);break;case ee.cmd.RESIZE_TO:this._resizeTo(n)}else this._sendFailure({cmd:i,reason:"Feature not supported by the host."})}},{key:"_expand",value:function(e){var t=e.top,i=e.left,n=e.right,o=e.bottom,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=M.int(t,0,0),i=M.int(i,0,0),n=M.int(n,0,0),o=M.int(o,0,0);var r=l()(this,Wt).size,a={width:r.width+n+i,height:r.height+o+t};s||(a.dx=-i,a.dy=-t),l()(this,Wt).updateGeometry(a,s)}},{key:"_collapse",value:function(){l()(this,Wt).resetGeometry()}},{key:"_resizeTo",value:function(e){var t,i,n=e.width,o=e.height,s=e.ratio;l()(this,Wt).position.config.client.flexible.enabled?(t={ratio:s},i={r:s}):(t={width:n=M.int(n,0,0),height:o=M.int(o,0,0)},i={w:n,h:o}),l()(this,Wt).setSize(t),this._sendStatusUpdate(ee.status.RESIZE_TO,{cmd:ee.cmd.RESIZE_TO,info:i})}},{key:"_readCookie",value:function(e){var t=ee.cmd.READ_COOKIE;if((l()(this,Vt).features.cookies.allowed||[]).includes(e)){var i=Ut(window.document,e);if(!i)(Ut(window.document,"SF")||"").split("&").filter((function(t){return t.startsWith(e+"=")})).forEach((function(t){var n=Ut({cookie:t},e);i=i||n}));this._sendStatusUpdate(ee.status.READ_COOKIE,{cmd:t,info:i})}else this._sendFailure({cmd:t,reason:Se.FailureReason.INVALID_ARGS,info:{key:e}})}},{key:"_writeCookie",value:function(e,t){var i=ee.cmd.WRITE_COOKIE;if(t.value&&t.value.length>1e3&&(t.value=t.value.substring(0,1e3)),(l()(this,Vt).features.cookies.allowed||[]).includes(e)){var n=t.value;Ut(window.document,e)||(t.value="".concat(e,"=").concat(t.value),e="SF"),t.expires=t.expires||null,t.expires&&"[object Date]"!==Object.prototype.toString.call(t.expires)&&(t.expires=null),function(e,t,i){if(i&&"string"==typeof i.value){var n=t+"="+i.value;i.expires&&(n+="; expires="+i.expires.toUTCString()),e.cookie=n}}(window.document,e,t),this._sendStatusUpdate(ee.status.WRITE_COOKIE,{cmd:i,info:n})}else this._sendFailure({cmd:i,reason:Se.FailureReason.INVALID_ARGS,info:{key:e}})}},{key:"_receivedAdMessage",value:function(e){l()(this,Wt).adMessageReceived(e)}},{key:"_sendStatusUpdate",value:function(e,t){var i=t.cmd,n=t.reason,o=t.info;this.messenger.send(new ee({status:e,meta:{cmd:i,reason:n,info:o}}))}},{key:"_sendFailure",value:function(e){var t=e.cmd,i=e.reason,n=e.info;this._sendStatusUpdate(ee.status.FAILED,{cmd:t,reason:i,info:n})}},{key:"positionMetaChanged",value:function(e){l()(this,Vt)&&l()(this,Vt).enabled?this._sendStatusUpdate(ee.status.META_UPDATE,{info:e.meta.adMeta}):console.warn("Messages can be sent only to SafeFrame positions.")}},{key:"_sendSafeFrameGeometryUpdate",value:function(e){l()(this,Gt).send(new ee({status:ee.status.GEOMETRY_UPDATE,meta:{info:e.meta}}))}},{key:"_sendSafeFrameFocusUpdate",value:function(e){l()(this,Gt).send(new ee({status:ee.status.FOCUS_CHANGE,meta:{info:e.type===O.FOCUS}}))}},{key:"_toggleEventListeners",value:function(e){var t=e?"on":"off",i=l()(this,Gt),n=l()(this,Wt),o=n.pageObserver;i[t](Y.topic.SIZE,this._onSizeChange,this),i[t](Y.topic.UNLOAD,this._onUnload,this),i[t](Y.topic.CLOSE_AD,this._onCloseAd,this),i[t](ee.topic.SAFE_FRAME,this._onSafeFrameMessage,this),n[t](xt.DESTROY,this.cleanup,this),n[t](xt.SAFE_FRAME_GEOMETRY_CHANGED,this._sendSafeFrameGeometryUpdate,this),n[t](xt.AD_META_CHANGED,this.positionMetaChanged,this),o[t](O.FOCUS,this._sendSafeFrameFocusUpdate,this),o[t](O.BLUR,this._sendSafeFrameFocusUpdate,this)}}]),e}();function Jt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Zt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Jt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Yt(){return Math.floor(1e7*Math.random()).toString()}function Xt(e,t){var i,n,o={id:"jacSandbox_"+Yt(),name:JSON.stringify(e),title:"Advertisement",itemtype:"https://schema.org/WPAdBlock",itemscope:"",tabindex:"-1",allowtransparency:"true",scrolling:"no"},s=t.sandbox;s&&(o.sandbox=s.allow.map((function(e){return"allow-".concat(e)})).join(" "),o.allow=(i=s.features,n=[],Object.keys(i).forEach((function(e){var t=i[e];if(t.enabled){var o=[];o.push(e),t.allow&&t.allow.forEach((function(e){0===(e=e.trim()).indexOf("https:")?o.push(e):0===e.indexOf("http:")?o.push(e.replace("http:","https:")):o.push("https://"+e)})),n.push(o.join(" "))}})),n.join(";")),s.features.fullscreen.enabled&&(o.allowfullscreen=!0));var r=document.createElement("iframe");Object.keys(o).forEach((function(e){r.setAttribute(e,o[e])}));var a=e.adData.content.size,c=a.width,u=a.height;return ce.setStyles(r,{position:"absolute",top:"0",left:"0",width:"".concat(c,"px"),height:"".concat(u,"px"),border:"0",overflow:"hidden",zIndex:t.layout.zIndex}),r}function qt(e,t){e.safeFrame={geom:t.safeFrameGeometry.buildGeometry(),focus:t.pageObserver.hasFocus,meta:t.position.config.client.meta}}function Kt(e,t,i,n){var o=i.position.config.client.render.timeout||5e3,s=!1,r=new ae(e.contentWindow,t.token);return r.listen(),r.on(Y.topic.WRITE_COMPLETE,(function(){e.removeAttribute("name"),n.trigger(new Ft(Ft.RENDER_COMPLETE))})),r.on(Y.topic.PAGE_LOAD,(function(){s||(s=!0,n.trigger(new Ft(Ft.AD_LOAD)))})),setTimeout((function(){s||(s=!0,e.removeAttribute("name"),n.trigger(new Ft(Ft.AD_LOAD_TIMEOUT)))}),o),new Bt(r,i)}function $t(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=e.children,n=i.length-1;n>=0;n--)i[n]!==t&&e.removeChild(i[n])}function Qt(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">'+'<rect width="100%" height="100%" fill="'.concat(e.backgroundColor,'"/>')+'<text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" '+'fill="'.concat(e.textColor,'" ')+'font-family="Arial, Helvetica, sans-serif" '+'font-size="'.concat(e.fontSize,'">')+e.text+"</text></svg>"}function ei(e,t,i){t===Ue?e.src="".concat(i,"/safeframe.html"):t===Ge&&(e.src="".concat(i,"/sandbox.html")),t===We&&function(e,t){var i=e.contentWindow.document;i.open(),i.write('<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>html,body{margin:0;padding:0;width:100%;height:100%}</style></head><body><script src="'+t+'"><\/script><script>var inFIF=true,inDapIF=true;<\/script></body></html>'),i.close()}(e,"".concat(i,"/jac.js"))}function ti(e){return e.navigator.userAgent.indexOf("Trident/")>0}var ii=new WeakMap,ni=new WeakMap,oi=new WeakMap,si=new WeakMap,ri=new WeakMap,ai=new WeakMap,ci=new WeakMap,ui=function(){function e(t){o()(this,e),ii.set(this,{writable:!0,value:void 0}),ni.set(this,{writable:!0,value:void 0}),oi.set(this,{writable:!0,value:void 0}),si.set(this,{writable:!0,value:void 0}),ri.set(this,{writable:!0,value:void 0}),ai.set(this,{writable:!0,value:void 0}),ci.set(this,{writable:!0,value:void 0}),f()(this,ii,t)}return r()(e,[{key:"render",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;this._removeListeners();var n=e.clientBaseUrl;if(n){var o=l()(this,ii).position,s=l()(this,ii).element,r=Yt(),a={adData:e,token:r},c=o.containerType;c===Ue&&qt(a,l()(this,ii));var u=o.config.client.placeholder;if(u.enabled){var h=Qt(u);ce.setStyles(s,{backgroundImage:"url(data:image/svg+xml;base64,".concat(btoa(h),")")})}var d=f()(this,ni,Xt(a,o.config.client));if(l()(this,oi)&&l()(this,oi).cleanup(),$t(s,d),o.config.client.flexible.enabled){var p=jt.computeFlexibleSize(o.config.client,s.parentNode,a.adData.content.size);ce.setStyles(d,p),ce.setStyles(s,p)}if(s.appendChild(d),f()(this,oi,Kt(d,a,l()(this,ii),this)),o.config.client.render.delayedLoadInLegacyIE&&ti(i))return f()(this,ci,(function(){d.removeEventListener("load",l()(t,ci),!1),ei(d,c,n)})),void d.addEventListener("load",l()(this,ci),!1);ei(d,c,n)}else console.error("Rendering aborted: URL of JAC library not defined.")}},{key:"clear",value:function(){this._removeListeners(),$t(l()(this,ii).element)}},{key:"reset",value:function(){this._removeListeners(),l()(this,ii).element.parentNode.removeChild(l()(this,ii).element),l()(this,ai)&&l()(this,ri)&&l()(this,ri).removeEventListener("click",l()(this,ai))}},{key:"refreshFlexibleSize",value:function(e,t){var i=l()(this,ii).position,n=l()(this,ii).element,o=t||i.config.client.flexible.ratio;if(Pe(o)){var s=jt.computeFlexibleSize({flexible:Zt(Zt({},i.config.client.flexible),{},{ratio:o})},n.parentNode,e);ce.setStyles(l()(this,ni),s),ce.setStyles(n,s)}}},{key:"resize",value:function(e){var t=e.width,i=e.height,n=e.top,o=void 0===n?0:n,s=e.left,r=void 0===s?0:s;e.resizeContainer&&ce.setStyles(l()(this,ii).element,{position:"relative",width:"".concat(t,"px"),height:"".concat(i,"px")}),l()(this,ni)&&ce.setStyles(l()(this,ni),{width:"".concat(t,"px"),height:"".concat(i,"px"),top:"".concat(o,"px"),left:"".concat(r,"px")})}},{key:"sandbox",get:function(){return l()(this,oi)}},{key:"adClosed",get:function(){return l()(this,si)}},{key:"showButton",get:function(){return l()(this,ri)}},{key:"closeAd",value:function(e){var t=this,i=e.closeConfig,n=e.adSize;if(!l()(this,si)){f()(this,si,!0);var o=0;i.showButtonEnabled&&(o=26),this._toggleCloseShowAd(i,o,(function(){t.showClosedAd(i,o,n)}))}}},{key:"showClosedAd",value:function(e,t,i){var n=this;if(ce.setStyles(l()(this,ni),{display:"none"}),ce.setStyles(l()(this,ii).element,{height:"".concat(t,"px")}),this.trigger(new Ft(Ft.AD_CLOSED)),e.showButtonEnabled){var o=q.createOpenAdButton(e.labels.show,i.width);f()(this,ri,o),l()(this,ai)||f()(this,ai,(function(){n.showAd(e)})),o.addEventListener("click",l()(this,ai),!1),l()(this,ii).element.appendChild(o)}}},{key:"showAd",value:function(e){var t=this;l()(this,ri).removeEventListener("click",l()(this,ai)),l()(this,ri).parentNode.removeChild(l()(this,ri)),f()(this,ri,null),f()(this,ai,null),ce.setStyles(l()(this,ni),{display:"block"});var i=l()(this,ii).size.height;this._toggleCloseShowAd(e,i,(function(){f()(t,si,!1),ce.setStyles(l()(t,ii).element,{overflow:null,transition:null}),t.trigger(new Ft(Ft.AD_OPENED))}))}},{key:"_toggleCloseShowAd",value:function(e,t,i){e.animation&&!0===e.animation.enabled?(ce.setStyles(l()(this,ii).element,{overflow:"hidden",height:"".concat(t,"px"),transition:"height ".concat(e.animation.duration,"ms linear")}),setTimeout((function(){i()}),e.animation.duration)):(ce.setStyles(l()(this,ii).element,{height:"".concat(t,"px")}),i())}},{key:"_removeListeners",value:function(){l()(this,ci)&&l()(this,ni)&&l()(this,ni).removeEventListener("load",l()(this,ci),!1)}}],[{key:"create",value:function(t){return new e(t)}}]),e}();Object.assign(ui.prototype,j);var li=ui,hi=function(){function e(t){var i=t.t,n=void 0===i?0:i,s=t.l,r=void 0===s?0:s,a=t.r,u=void 0===a?0:a,l=t.b,h=void 0===l?0:l;o()(this,e),c()(this,"offsetTop",void 0),c()(this,"offsetLeft",void 0),c()(this,"offsetBottom",void 0),c()(this,"offsetRight",void 0),c()(this,"width",void 0),c()(this,"height",void 0),this.offsetTop=n,this.offsetLeft=r,this.offsetRight=u,this.offsetBottom=h,this.width=Math.max(this.offsetRight-this.offsetLeft,0),this.height=Math.max(this.offsetBottom-this.offsetTop,0)}return r()(e,[{key:"normalize",value:function(){this.offsetTop=Math.max(this.offsetTop,0),this.offsetLeft=Math.max(this.offsetLeft,0),this.offsetRight=Math.max(this.offsetRight,0),this.offsetBottom=Math.max(this.offsetBottom,0),this.width=Math.max(this.offsetRight-this.offsetLeft,0),this.height=Math.max(this.offsetBottom-this.offsetTop,0)}},{key:"toSafeFrameClip",value:function(){return{t:this.offsetTop,l:this.offsetLeft,r:this.offsetRight,b:this.offsetBottom,w:this.width,h:this.height}}},{key:"getOffsetDifference",value:function(e){var t={top:0,right:0,bottom:0,left:0};return this.offsetTop>e.offsetTop&&this.offsetTop<e.offsetBottom&&(t.top=this.offsetTop-e.offsetTop),this.offsetLeft>e.offsetLeft&&this.offsetLeft<e.offsetRight&&(t.left=this.offsetLeft-e.offsetLeft),this.offsetRight<e.offsetRight&&this.offsetRight>e.offsetLeft&&(t.right=e.offsetRight-this.offsetRight),this.offsetBottom<e.offsetBottom&&this.offsetBottom>e.offsetTop&&(t.bottom=e.offsetBottom-this.offsetBottom),t}},{key:"addHorizontalClipping",value:function(e,t){e>this.offsetLeft&&(this.offsetLeft=e),t<this.offsetRight&&(this.offsetRight=t)}},{key:"addVerticalClipping",value:function(e,t){e>this.offsetTop&&(this.offsetTop=e),t<this.offsetBottom&&(this.offsetBottom=t)}}]),e}();function fi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=pe.getElementGeometry(e,t),n=pe.getPageScrollInfo(),o={t:i.top,l:i.left,r:i.right,b:i.bottom,w:i.width,h:i.height,z:i.zIndex};return(n.y||n.x)&&(o.l+=n.x,o.t+=n.y),o.b=o.t+i.height,o.r=o.l+i.width,Object.keys(o).forEach((function(e){"number"==typeof o[e]&&(o[e]=Math.round(o[e]))})),o}function di(){var e=pe.getPageScrollInfo(),t=pe.getWindowGeometry();return{t:e.y,l:e.x,r:e.x+t.width,b:e.y+t.height,w:t.width,h:t.height}}function pi(e,t,i){for(var n,o,s,r=pe.getPageScrollInfo(),a=ce.getComputedStyle(e);a;){var c=e===i;if("block"===a.display||"absolute"===a.position||"none"!==a.float){var u=fi(e),l=u.t,h=u.l,f=u.r,d=u.b,p=e.offsetWidth,v=e.offsetHeight,m=e.clientWidth,g=e.clientHeight;if(!n&&p>m){var E=p-m;n=E<=20?E:0}if(!o&&v>g){var y=v-g;o=y<=20?y:0}c?(e.scrollWidth>m&&(h=0,f=(window.innerWidth||p)+r.x,window.innerWidth&&window.innerWidth>m&&(f-=window.innerWidth-m),t.addHorizontalClipping(h,f)),e.scrollHeight>g&&(l=0,d=(window.innerHeight||v)+r.y,window.innerHeight&&window.innerHeight>g&&(d-=window.innerHeight-g),t.addVerticalClipping(l,d))):(n&&f-h===p&&(f-=n),o&&d-l===v&&(d-=o),pe.isClippingElement(e,"X",a)&&t.addHorizontalClipping(h,f),pe.isClippingElement(e,"Y",a)&&t.addVerticalClipping(l,d),!s&&pe.isScrollableElement(e,a)&&(s=e))}if(c)break;if((e=e.parentNode)&&Node.DOCUMENT_FRAGMENT_NODE===e.nodeType&&(e=e.parentNode),!e)break;a=ce.getComputedStyle(e)}return{scrollParent:s,xScrollBarHeight:o,yScrollBarWidth:n}}var vi=new WeakMap,mi=new WeakMap,gi=new WeakMap,Ei=new WeakMap,yi=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;o()(this,e),vi.set(this,{writable:!0,value:void 0}),mi.set(this,{writable:!0,value:void 0}),gi.set(this,{writable:!0,value:void 0}),Ei.set(this,{writable:!0,value:void 0}),f()(this,vi,t),f()(this,mi,i),f()(this,gi,s),f()(this,Ei,b((function(){return n.dispatchGeometryChange()}),1e3)),l()(this,vi).on(O.SCROLL,l()(this,Ei)),l()(this,vi).on(O.RESIZE,l()(this,Ei))}return r()(e,[{key:"buildGeometry",value:function(){return{win:this.buildWindowGeometry(),self:this.buildSelfGeometry(),exp:this.buildExpandableGeometry(),par:this.buildParentGeometry()}}},{key:"winHasFocus",value:function(){return l()(this,vi).hasFocus}},{key:"dispatchGeometryChange",value:function(){this.trigger(new y(e.GEOMETRY_UPDATE,this.buildGeometry()))}},{key:"destroy",value:function(){l()(this,vi).off(O.SCROLL,l()(this,Ei)),l()(this,vi).off(O.RESIZE,l()(this,Ei))}},{key:"buildWindowGeometry",value:function(){var e=pe.getWindowGeometry();return{t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height}}},{key:"buildSelfGeometry",value:function(){var e=fi(l()(this,mi),l()(this,gi)),t=pe.getVisibilityMetrics(l()(this,mi),l()(this,gi));return e.xiv=parseFloat(t.xPercentage.toFixed(2)),e.yiv=parseFloat(t.yPercentage.toFixed(2)),e.iv=parseFloat(t.totalPercentage.toFixed(2)),e}},{key:"buildExpandableGeometry",value:function(){var e=fi(l()(this,mi)),t=pe.getDocumentElement(),i=di(),n=new hi(i),o=pi(l()(this,mi),n,t);n.normalize();var s=new hi(e).getOffsetDifference(n),r={t:s.top,l:s.left,r:s.right,b:s.bottom};return o.scrollParent?(r.xs=!!o.xScrollBarHeight,r.ys=!!o.yScrollBarWidth):(r.xs=t.scrollWidth>t.clientWidth,r.ys=t.scrollHeight>t.clientHeight),r}},{key:"buildParentGeometry",value:function(){var e=pe.getDocumentElement(),t=di(),i=new hi(t),n=pi(l()(this,mi),i,e);if(n.scrollParent){var o=fi(n.scrollParent),s=new hi(o);return pi(n.scrollParent,s,e),s.addHorizontalClipping(t.l,t.r),s.addVerticalClipping(t.t,t.b),s.normalize(),s.toSafeFrameClip()}return i.normalize(),i.toSafeFrameClip()}},{key:"element",set:function(e){f()(this,mi,e)}}]),e}();c()(yi,"GEOMETRY_UPDATE","GEOMETRY_UPDATE"),Object.assign(yi.prototype,j);var _i=yi,Oi=new WeakMap,wi=function(){function e(t){var i=t.time,n=t.limit,s=t.callback;o()(this,e),c()(this,"time",void 0),c()(this,"limit",void 0),c()(this,"remaining",void 0),c()(this,"callback",void 0),Oi.set(this,{writable:!0,value:void 0}),this.time=i,this.remaining=this.limit=n,this.callback=s}return r()(e,[{key:"start",value:function(){var e=this;(!M.isSet(this.remaining)||this.remaining>0)&&f()(this,Oi,setTimeout((function(){M.isSet(e.remaining)&&e.remaining--,e.callback()}),this.time))}},{key:"stop",value:function(){clearTimeout(l()(this,Oi))}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"reset",value:function(){this.stop(),this.remaining=this.limit}}]),e}(),bi=new WeakMap,Ti=new WeakMap,Pi=new WeakMap,Ri=new WeakMap,Di=new WeakMap,Ci=new WeakMap,Si=new WeakMap,Ai=new WeakMap,ki=new WeakMap,Ii=new WeakMap,Ni=new WeakMap,Mi=new WeakMap,xi=new WeakMap,Li=new WeakMap,Fi=new WeakMap,ji=new WeakMap,Ui=new WeakMap,Gi=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;o()(this,e),bi.set(this,{writable:!0,value:void 0}),Ti.set(this,{writable:!0,value:void 0}),Pi.set(this,{writable:!0,value:void 0}),Ri.set(this,{writable:!0,value:void 0}),Di.set(this,{writable:!0,value:void 0}),Ci.set(this,{writable:!0,value:void 0}),Si.set(this,{writable:!0,value:!1}),Ai.set(this,{writable:!0,value:!1}),ki.set(this,{writable:!0,value:!1}),Ii.set(this,{writable:!0,value:!1}),Ni.set(this,{writable:!0,value:!1}),Mi.set(this,{writable:!0,value:void 0}),xi.set(this,{writable:!0,value:void 0}),Li.set(this,{writable:!0,value:void 0}),Fi.set(this,{writable:!0,value:void 0}),ji.set(this,{writable:!0,value:!0}),Ui.set(this,{writable:!0,value:void 0}),c()(this,"position",void 0),c()(this,"element",void 0),c()(this,"renderer",void 0),c()(this,"safeFrameGeometry",void 0),this.position=t,this._createContainerNode(),f()(this,bi,i),f()(this,Fi,s),this.renderer=li.create(this),this.renderer.on(Ft.RENDER_COMPLETE,this._onRenderComplete,this),this.renderer.on(Ft.AD_LOAD,this._onAdLoad,this),this.renderer.on(Ft.AD_LOAD_TIMEOUT,this._onAdLoadTimeOut,this),this.renderer.on(Ft.AD_OPENED,this._onAdOpened,this),this.renderer.on(Ft.AD_CLOSED,this._onAdClosed,this),f()(this,Di,(function(){return n._onMouseOver()})),f()(this,Ci,(function(){return n._onMouseOut()})),this._addElementListeners(),t.containerType===Ue&&this._addSafeFrameGeometry()}return r()(e,[{key:"_createContainerNode",value:function(){var e=this.position.config.getTargetElement(),t=document.createElement("div");t.id="jacPosition_".concat(this.position.name),t.className="jac-container",e.appendChild(t),this.element=t}},{key:"_addSafeFrameGeometry",value:function(){var e=this;this.safeFrameGeometry=new _i(l()(this,bi),this.element,l()(this,Fi)),f()(this,Ui,(function(t){e.position.containerType===Ue&&e._triggerEvent(xt.SAFE_FRAME_GEOMETRY_CHANGED,t.meta)})),this.safeFrameGeometry.on(_i.GEOMETRY_UPDATE,l()(this,Ui),this)}},{key:"_removeSafeFrameGeometry",value:function(){this.safeFrameGeometry.destroy(),this.safeFrameGeometry.off(_i.GEOMETRY_UPDATE,l()(this,Ui),this),this.safeFrameGeometry=null}},{key:"render",value:function(){var e=this;this._refreshTargetContainerIfChanged(),f()(this,ki,!0),f()(this,Ii,!1);var t=f()(this,Ti,this.position.adData);this.position.updateContainerType(t.meta),!l()(this,Pi)&&l()(this,bi)&&(f()(this,Pi,(function(){return e._pageStateChanged()})),f()(this,Ri,(function(){return e._pageResizeListener()})),l()(this,bi).on(O.SCROLL,l()(this,Pi)),l()(this,bi).on(O.RESIZE,l()(this,Ri)),l()(this,bi).on(O.VISIBILITY,l()(this,Pi))),this._pageStateChanged(),this.position.config.client.render.requireViewable||this._processAndInjectAd()}},{key:"_processAndInjectAd",value:function(){var e=l()(this,Ti);f()(this,ki,!1),this._triggerEvent(xt.RENDER_START),e.status===Fe||e.status===Le?(e.status===Fe&&(e.content.size={width:1,height:1,unit:"px"},this._triggerEvent(xt.NO_AD)),ve.isMobileMomentAd(e)&&(e.content.size=ve.computeDisplaySize(this.position)),this.setSize(e.content.size),this.show(),this.renderer.render(e),this.position.config.client.flexible.enabled&&this.setSize({ratio:this.position.config.client.flexible.ratio}),f()(this,ji,!1)):this._triggerEvent(xt.RENDER_FAILED)}},{key:"_refreshTargetContainerIfChanged",value:function(){if(this.position.config.getTargetElement()!==this.element.parentNode){var e=this.element;this._cleanElementListeners(),this.renderer.reset(),this._createContainerNode(),this._addElementListeners(),this.safeFrameGeometry&&(this.safeFrameGeometry.element=this.element),ce.setStyles(this.element,{display:e.style.display,position:e.style.position,width:e.style.width,height:e.style.height})}}},{key:"show",value:function(){ce.setStyles(this.element,{display:"block"}),this._triggerEvent(xt.SHOW)}},{key:"hide",value:function(){ce.setStyles(this.element,{display:"none"}),this._triggerEvent(xt.HIDE)}},{key:"destroy",value:function(){l()(this,bi).off(O.SCROLL,l()(this,Pi)),l()(this,bi).off(O.RESIZE,l()(this,Ri)),l()(this,bi).off(O.VISIBILITY,l()(this,Pi)),this.renderer.off(Ft.RENDER_COMPLETE,this._onRenderComplete,this),this.renderer.off(Ft.AD_LOAD,this._onAdLoad,this),this.renderer.off(Ft.AD_LOAD_TIMEOUT,this._onAdLoadTimeOut,this),this.renderer.off(Ft.AD_OPENED,this._onAdOpened,this),this.renderer.off(Ft.AD_CLOSED,this._onAdClosed,this),this._cleanElementListeners(),this.renderer.reset(),f()(this,ji,!0),this.safeFrameGeometry&&this._removeSafeFrameGeometry(),this._triggerEvent(xt.DESTROY)}},{key:"_addElementListeners",value:function(){this.element.addEventListener("mouseover",l()(this,Di)),this.element.addEventListener("mouseout",l()(this,Ci))}},{key:"_cleanElementListeners",value:function(){this.element.removeEventListener("mouseover",l()(this,Di)),this.element.removeEventListener("mouseout",l()(this,Ci))}},{key:"abortRender",value:function(){this.hide(),this.renderer.clear(),f()(this,ji,!0),f()(this,xi,null)}},{key:"unloadAd",value:function(){this.setSize({width:1,height:1,unit:"px"}),this.abortRender(),this._triggerEvent(xt.NO_AD)}},{key:"updateGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];f()(this,Si,!0),this.renderer.resize({width:e.width,height:e.height,top:e.dy||0,left:e.dx||0,resizeContainer:t});var i=this.getGeometry();this._triggerEvent(xt.RESIZE,i)}},{key:"resetGeometry",value:function(){if(f()(this,Si,!1),l()(this,xi)){this.renderer.resize({width:l()(this,xi).width,height:l()(this,xi).height,top:0,left:0,resizeContainer:!0});var e=this.getGeometry();this._triggerEvent(xt.RESIZE,e)}}},{key:"getGeometry",value:function(){return pe.getElementGeometry(this.element)}},{key:"_isAreaInView",value:function(){var e=this.position.config.client.viewability,t=e.percent/100,i=pe.getVisibilityMetrics(this.element,l()(this,Fi)),n=i.totalPercentage>=t,o=0;return e.pixels>0&&(o=i.totalPercentage*i.containerPixels),n||e.pixels>0&&o>=e.pixels}},{key:"isInView",get:function(){return l()(this,Ni)}},{key:"isExpanded",get:function(){return l()(this,Si)}},{key:"hasMouseOver",get:function(){return l()(this,Ai)}},{key:"size",get:function(){return l()(this,xi)||{}}},{key:"lastAdSize",get:function(){return l()(this,Li)}},{key:"setSize",value:function(e){if(!ve.isMobileMomentAd(l()(this,Ti))){var t=e.width&&e.height;if(this.position.config.client.flexible.enabled&&(e.ratio||!e.width||!e.height)){this.renderer.refreshFlexibleSize(l()(this,Ti).content.size,e.ratio);var i=this.getGeometry();e={width:i.width,height:i.height}}(!l()(this,xi)||l()(this,xi).width!==e.width||l()(this,xi).height!==e.height)&&(f()(this,xi,e),e.width>1&&e.height>1&&l()(this,Ti).config.service.sizes&&l()(this,Ti).config.service.sizes.indexOf("".concat(e.width,"x").concat(e.height))>=0&&f()(this,Li,e),t&&this.renderer.resize({width:e.width,height:e.height,resizeContainer:!0}),this._triggerEvent(xt.AD_SIZE_CHANGED,l()(this,xi)))}}},{key:"_pageResizeListener",value:function(){var e=this.position.config.client.flexible;e.enabled&&this.setSize({ratio:e.ratio}),this._pageStateChanged()}},{key:"_pageStateChanged",value:function(){var e=this.position.config,t=this._isAreaInView();this._changeViewabilityState(t&&l()(this,bi).isVisible),e.client.render.requireViewable&&l()(this,ki)&&t&&this._processAndInjectAd(),this._triggerEvent(xt.GEOMETRY_CHANGED)}},{key:"_changeViewabilityState",value:function(e){e!==l()(this,Ni)&&(f()(this,Ni,e),this._fireVisibilityEvent(e),l()(this,Mi)&&(e&&l()(this,Ii)?l()(this,Mi).restart():l()(this,Mi).stop()))}},{key:"_fireVisibilityEvent",value:function(e){var t=e?xt.VIEW_START:xt.VIEW_END;this._triggerEvent(t)}},{key:"_onRenderComplete",value:function(){var e=this;f()(this,Ii,!0),this._triggerEvent(xt.RENDER_COMPLETE,l()(this,xi)),l()(this,Mi)?l()(this,Mi).reset():f()(this,Mi,new wi({time:this.position.config.client.viewability.duration,limit:1,callback:function(){return e._triggerEvent(xt.VIEWABLE)}})),l()(this,Ni)&&l()(this,Mi).restart()}},{key:"_onAdClosed",value:function(){this._triggerEvent(xt.AD_CLOSED)}},{key:"_onAdOpened",value:function(){this._triggerEvent(xt.AD_OPENED)}},{key:"_onAdLoad",value:function(){this._triggerEvent(xt.AD_LOAD)}},{key:"_onAdLoadTimeOut",value:function(){this._triggerEvent(xt.AD_LOAD_TIMEOUT)}},{key:"_onMouseOver",value:function(){f()(this,Ai,!0)}},{key:"_onMouseOut",value:function(){f()(this,Ai,!1),this._triggerEvent(xt.MOUSE_OUT)}},{key:"_triggerEvent",value:function(e,t){this.trigger(new xt(e,Object.assign({positionName:this.position.name},t)))}},{key:"closeAd",value:function(e){this.renderer.closeAd(e)}},{key:"updateMeta",value:function(){var e=this.position.config.client.meta;this._triggerEvent(xt.AD_META_CHANGED,{adMeta:e})}},{key:"adMessageReceived",value:function(e){this._triggerEvent(xt.AD_MESSAGE,{message:e})}},{key:"pageObserver",get:function(){return l()(this,bi)}}]),e}();Object.assign(Gi.prototype,j);var Wi=Gi;function zi(e){return e&&"IFRAME"===e.tagName&&e.id&&0===e.id.indexOf("jacSandbox_")}var Hi=new WeakMap,Vi=new WeakMap,Bi=function(){function e(){o()(this,e),c()(this,"focusedElement",void 0),c()(this,"iframeMouseOver",!1),Hi.set(this,{writable:!0,value:void 0}),Vi.set(this,{writable:!0,value:void 0})}return r()(e,[{key:"init",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;!l()(this,Vi)&&t._config.client.focusProtection&&(f()(this,Vi,e),f()(this,Hi,i),this.focusedElement=i.document.activeElement,e.on(O.BLUR_CAPTURE,this._onPageBlurCapture,this),e.on(O.FOCUS_IN,this._onPageFocusIn,this),e.on(O.MOUSE_OVER,this._onMouseOver,this),e.on(O.MOUSE_OUT,this._onMouseOut,this))}},{key:"pageObserver",get:function(){return l()(this,Vi)}},{key:"_onPageBlurCapture",value:function(t){var i=this;setTimeout((function(){var n=l()(i,Hi).document,o=zi(n.activeElement);o||t.target===l()(i,Hi)||i.focusedElement===n.activeElement||(i.focusedElement=null),o&&!i.iframeMouseOver&&(i.focusedElement&&i.focusedElement!==l()(i,Hi)&&i.focusedElement!==n.body?i.focusedElement.focus():(i._createFocusPlaceHolder(),e.FOCUS_PLACE_HOLDER.focus(),l()(i,Hi).focus()))}),0)}},{key:"_createFocusPlaceHolder",value:function(){if(!e.FOCUS_PLACE_HOLDER){var t=l()(this,Hi).document,i=e.FOCUS_PLACE_HOLDER=t.createElement("span");i.tabIndex=-1,t.body.insertBefore(i,t.body.firstChild)}}},{key:"_onPageFocusIn",value:function(e){"IFRAME"!==e.meta.nativeEvent.target.tagName&&(this.focusedElement=e.meta.nativeEvent.target)}},{key:"_onMouseOver",value:function(e){zi(e.meta.nativeEvent.target)&&(this.iframeMouseOver=!0)}},{key:"_onMouseOut",value:function(e){zi(e.meta.nativeEvent.target)&&(this.iframeMouseOver=!1)}}]),e}();function Ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}c()(Bi,"FOCUS_PLACE_HOLDER",void 0);var Zi=function(e){p()(i,e);var t=Ji(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);function Yi(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"log",i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];(e=console)[t].apply(e,["JAC Rotation Scheduler:"].concat(n))}function Xi(e){Yi("warn",e)}function qi(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];Yi.apply(void 0,["debug"].concat(t))}c()(Zi,"ROTATION","Scheduler.ROTATION");var Ki=new WeakMap,$i=function(){function e(t){o()(this,e),Ki.set(this,{writable:!0,value:void 0}),c()(this,"schedulerRegistry",{}),c()(this,"rotationConfig",{}),c()(this,"positionComponents",{}),c()(this,"intervals",{}),f()(this,Ki,t)}return r()(e,[{key:"init",value:function(){var e=this;l()(this,Ki).on(O.VISIBILITY,(function(t){return e._onPageVisibilityChange(t)}),this),l()(this,Ki).on(O.FOCUS,(function(t){return e._onPageVisibilityChange(t)}),this)}},{key:"applyGlobalRotationConfig",value:function(e){this.rotationConfig=e}},{key:"register",value:function(e){var t=e.config.client.rotation,i=e.name;this.isPositionRegistered(i)?Xi("Registering position ".concat(i,", but it is already registered.")):t.enabled?(this.schedulerRegistry[i]={name:i,rotationCount:0,renderDone:!1,viewStartTimestamp:null,rotationConfig:Qe.clone(t)},this.startScheduling(i),e.on(At.ROTATION_UPDATE,this._onPositionRotationConfigUpdate,this)):Xi("Position ".concat(i," has rotation disabled."))}},{key:"deregister",value:function(e){var t=e.name,i=this.schedulerRegistry[t];i?i.rotationConfig.cancellable?(this.stopScheduling(t),e.off(At.ROTATION_UPDATE,this._onPositionRotationConfigUpdate,this),delete this.schedulerRegistry[t]):Xi("Position ".concat(t," is not cancellable.")):Xi("De-registering position ".concat(t,", but it has not been registered."))}},{key:"resetRegistration",value:function(e){var t=e.name;this.schedulerRegistry[t].rotationCount=0,e.resetRotation(),this.startScheduling(t)}},{key:"isPositionRegistered",value:function(e){return!!this.schedulerRegistry[e]}},{key:"subscribe",value:function(e){var t=e.position.name;this.isPositionRegistered(t)?this.positionComponents[t]?Xi("Subscribing to an already subscribed PositionComponent for position ".concat(t,".")):(this.positionComponents[t]=e,this._togglePositionObservers(e,!0)):Xi("Subscribing to PositionComponent for a non-registered position ".concat(t,"."))}},{key:"unsubscribe",value:function(e){var t=e.position.name;this.isPositionRegistered(t)?this.positionComponents[t]?(this._togglePositionObservers(e,!1),delete this.positionComponents[t]):Xi("Unsubscribing from a non-subscribed PositionComponent for position ".concat(t,".")):Xi("Unsubscribing from PositionComponent for a non-registered position ".concat(t,"."))}},{key:"startScheduling",value:function(e){var t=this.schedulerRegistry[e];if(t.rotationCount>=t.rotationConfig.limit)Xi("Scheduling position ".concat(e,", which has exceeded the rotation limit."));else{var i=t.rotationConfig.period;this._scheduleInterval(i);var n=this.intervals[i];n.positionNames.indexOf(e)<0&&n.positionNames.push(e)}}},{key:"stopScheduling",value:function(e){var t=this.schedulerRegistry[e].rotationConfig.period,i=this.intervals[t];i?($e.remove(i.positionNames,e),i.positionNames.length<=0&&(clearTimeout(i.timeout),delete this.intervals[t])):Xi("Removing position ".concat(e," from schedule, but it is not scheduled."))}},{key:"_onPositionRotationConfigUpdate",value:function(e){var t=e.target,i=t.name,n=this.schedulerRegistry[i],o=t.config.client.rotation,s=n.rotationConfig.period!==o.period;if(s&&this.stopScheduling(i),n.rotationConfig=Qe.clone(o),o.enabled)s&&this.startScheduling(i);else{var r=this.positionComponents[i];r&&this.unsubscribe(r),this.deregister(t)}}},{key:"_scheduleInterval",value:function(e){var t=this,i=this.intervals[e]=this.intervals[e]||{positionNames:[],timeout:null};i.timeout||(qi("Scheduling rotation interval in",e),i.timeout=setTimeout((function(){i.timeout=null,t._intervalElapsed(e)}),e))}},{key:"_intervalElapsed",value:function(e){var t=this;qi("Interval elapsed",e);var i=(new Date).getTime(),n=this.intervals[e],o=n.positionNames.filter((function(e){return t._isPositionEligibleForRotation(e,i)}));o.length>0&&this._startRotation(o),qi("Scheduled positions",n.positionNames),n.positionNames.length>0&&this._scheduleInterval(e)}},{key:"_isPositionEligibleForRotation",value:function(e,t){var i=this.schedulerRegistry[e],n=i.rotationConfig,o=i.viewStartTimestamp,s=i.renderDone,r=this.positionComponents[e];if(!s)return qi(e,"render not complete"),!1;if(!this._isPageActive())return i.waitingToBeInView=!0,qi(e,"waiting to be in view"),!1;if(r.hasMouseOver)return qi(e,"has mouse over"),!1;if(r.isExpanded)return qi(e,"is expanded"),!1;if(n.requireViewable){if(!o)return qi(e,"is not in view"),!1;var a=t-o;if(a<n.inViewDuration&&!i.waitingToBeInView)return qi(e,"is in view only for",a,"since",o),!1}return!0}},{key:"_startRotation",value:function(e){var t=this,i=this._addRotationGroupComplements(e);i.forEach((function(e){var i=t.schedulerRegistry[e];i.rotationCount++,i.renderDone=!1,i.waitingToBeInView=!1,i.rotationCount>=i.rotationConfig.limit&&t.stopScheduling(e)})),qi("Rotating",i),this.trigger(new Zi(Zi.ROTATION,{positionNames:i}))}},{key:"_addRotationGroupComplements",value:function(e){var t=[];return(this.rotationConfig&&this.rotationConfig.groups||[]).forEach((function(i){i.forEach((function(n,o){$e.isSubset(n,e)&&n.length>0&&(qi("Whole group set to be rotated",n),i.forEach((function(e,i){i!==o&&(t=t.concat(e))})))}))})),$e.removeDuplicates(e.concat(t))}},{key:"_onPageVisibilityChange",value:function(){var e=this;this._isPageActive()&&setTimeout((function(){var t=Object.keys(e.schedulerRegistry).filter((function(t){return e.schedulerRegistry[t].waitingToBeInView&&e._isPositionEligibleForRotation(t)}));t.length>0&&e._startRotation(t)}))}},{key:"_isPageActive",value:function(){return l()(this,Ki).isVisible&&l()(this,Ki).hasFocus}},{key:"_onPositionRenderDone",value:function(e){var t=this._getRegistryItemByPositionComponentEvent(e);t.renderDone=!0,e.target.isInView&&(t.viewStartTimestamp=(new Date).getTime())}},{key:"_onNoAdForPosition",value:function(e){var t=e.meta.positionName,i=this.positionComponents[t];i&&(i.position.config.client.rotation.onNoAd?this._onPositionRenderDone(e):this.stopScheduling(t))}},{key:"_onPositionViewStart",value:function(e){this._getRegistryItemByPositionComponentEvent(e).viewStartTimestamp=(new Date).getTime()}},{key:"_onPositionViewEnd",value:function(e){this._getRegistryItemByPositionComponentEvent(e).viewStartTimestamp=null}},{key:"_getRegistryItemByPositionComponentEvent",value:function(e){var t=e.meta.positionName;return this.schedulerRegistry[t]}},{key:"_togglePositionObservers",value:function(e,t){var i=t?"on":"off",n=xt.RENDER_COMPLETE,o=xt.RENDER_FAILED,s=xt.NO_AD,r=xt.VIEW_START,a=xt.VIEW_END;e[i](n,this._onPositionRenderDone,this),e[i](o,this._onPositionRenderDone,this),e[i](s,this._onNoAdForPosition,this),e[i](r,this._onPositionViewStart,this),e[i](a,this._onPositionViewEnd,this)}}]),e}();Object.assign($i.prototype,j);var Qi=$i,en=function e(){o()(this,e),c()(this,"apiStatus",Ve),c()(this,"usPrivacy","")},tn=function e(){o()(this,e),c()(this,"apiStatus",Ve),c()(this,"applies",null),c()(this,"euconsent","")};function nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var on=function(e){p()(i,e);var t=nn(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(on,"API_NOT_FOUND","".concat("UserRegulation",".API_NOT_FOUND")),c()(on,"READ_TIMEOUT","".concat("UserRegulation",".READ_TIMEOUT")),c()(on,"RESOLVED","".concat("UserRegulation",".RESOLVED")),c()(on,"UPDATED","".concat("UserRegulation",".UPDATED"));var sn,rn="GDPR",an="CCPA",cn=new WeakMap,un=new WeakMap,ln=new WeakMap,hn=new WeakMap,fn=new WeakMap,dn=function(){function e(){o()(this,e),cn.set(this,{writable:!0,value:0}),un.set(this,{writable:!0,value:void 0}),ln.set(this,{writable:!0,value:!1}),hn.set(this,{writable:!0,value:{}}),fn.set(this,{writable:!0,value:void 0}),f()(this,un,{CCPA:new en,GDPR:new tn})}return r()(e,[{key:"data",get:function(){return l()(this,un)}},{key:"resolved",get:function(){return null===l()(this,cn)}},{key:"resolve",value:function(e,t){if(t)return f()(this,cn,null),this._setDataFromConfig(t),void f()(this,ln,!0);if(!l()(this,ln)){if(f()(this,ln,!0),f()(this,fn,e),"function"!=typeof l()(this,fn).__uspapi&&"function"!=typeof l()(this,fn).__tcfapi)return l()(this,un).GDPR.apiStatus=l()(this,un).CCPA.apiStatus=Be,f()(this,cn,null),void this.trigger(new on(on.API_NOT_FOUND));this._readRegulatoryData()}}},{key:"_dispatchRegulationsResolvedEvent",value:function(){this.trigger(new on(on.RESOLVED))}},{key:"_dispatchRegulationsUpdatedEvent",value:function(){this.trigger(new on(on.UPDATED))}},{key:"_regulationResolved",value:function(e){l()(this,hn)[e]&&delete l()(this,hn)[e],0===Object.keys(l()(this,hn)).length&&(null===l()(this,cn)?this._dispatchRegulationsUpdatedEvent():(clearTimeout(l()(this,cn)),f()(this,cn,null),this._dispatchRegulationsResolvedEvent()))}},{key:"_setDataFromConfig",value:function(e){e.gdpr&&(e.gdpr.euconsent?(l()(this,un).GDPR.applies=1,l()(this,un).GDPR.euconsent=""+e.gdpr.euconsent):l()(this,un).GDPR.applies=["","0","false",!1,0,void 0,null].indexOf(e.gdpr.applies)>-1?0:1,l()(this,un).GDPR.apiStatus=Je),e.ccpa&&e.ccpa.usPrivacy&&(l()(this,un).CCPA.usPrivacy=""+e.ccpa.usPrivacy,l()(this,un).CCPA.apiStatus=Je),this._dispatchRegulationsResolvedEvent()}},{key:"_readCCPAData",value:function(){var e=this;l()(this,fn).__uspapi("getUSPData",1,(function(t,i){l()(e,un).CCPA.apiStatus=i?Ze:ze,i&&(l()(e,un).CCPA.usPrivacy=t.uspString||"",e._regulationResolved(an))}))}},{key:"_readTCFv2Data",value:function(){var e=this;l()(this,fn).__tcfapi("addEventListener",2,(function(t,i){"tcloaded"!==t.eventStatus&&"useractioncomplete"!==t.eventStatus||(l()(e,un).GDPR.apiStatus=i?Ze:ze,i&&(l()(e,un).GDPR.applies=!1===t.gdprApplies?0:1,l()(e,un).GDPR.euconsent=t.tcString||"",e._regulationResolved(rn)))}))}},{key:"_readRegulatoryData",value:function(){var e=this;f()(this,cn,setTimeout((function(){var t=Object.keys(l()(e,hn));t.length>0?(t.forEach((function(t){l()(e,un)[t].apiStatus!==ze&&(l()(e,un)[t].apiStatus=He)})),e.trigger(new on(on.READ_TIMEOUT,{}))):e._dispatchRegulationsResolvedEvent(),f()(e,cn,null)}),500)),"function"==typeof l()(this,fn).__uspapi?l()(this,hn)[an]="_readCCPAData":l()(this,un).CCPA.apiStatus=Be,"function"==typeof l()(this,fn).__tcfapi?l()(this,hn)[rn]="_readTCFv2Data":l()(this,un).GDPR.apiStatus=Be,Object.keys(l()(this,hn)).forEach((function(t){var i=l()(e,hn)[t];e[i]()}))}}],[{key:"getInstance",value:function(){return sn=sn||new e}},{key:"reset",value:function(){sn=null}}]),e}();Object.assign(dn.prototype,j);var pn=dn,vn=function(e,t){if("string"==typeof e&&e)if(window.crypto&&crypto.subtle&&crypto.subtle.digest){var i=new TextEncoder("utf-8").encode(e.trim().toLowerCase());crypto.subtle.digest("SHA-256",i).then((function(e){var i=Array.from(new Uint8Array(e));t(i.map((function(e){return("00"+e.toString(16)).slice(-2)})).join(""))}))}else t("");else t("")};function mn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function gn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var En=function(){var e={};try{e=JSON.parse(localStorage.getItem("vm-connectid"))||{}}catch(e){}return e},yn=function(e){return gn({},En()[e]||{})},_n=function(e,t){!function(e){try{localStorage.setItem("vm-connectid",JSON.stringify(e))}catch(e){}}(gn(gn({},En()),{},c()({},e,t)))},On=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=new XMLHttpRequest,o=Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&");n.onreadystatechange=function(e){if(n.readyState===XMLHttpRequest.DONE)if(0===n.status||n.status>=200&&n.status<400)try{i(JSON.parse(n.responseText))}catch(e){i()}else i()};try{n.withCredentials=!0,n.open("GET","".concat(e,"?").concat(o),!0),n.send(t)}catch(e){}};function wn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function bn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?wn(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Tn={};Tn.syncHashedEmail=function(e){var t=e.pixelId,i=e.hashedEmail,n=e.gdpr,o=e.gdprConsent,s=e.vm1p;if(t&&i){var r=yn(i);if(r.connectid)if(function(e){if(!e)return!1;return(new Date-new Date(e))/36e5<360}(r.connectid.lastUpdated))return;var a="https://ups.analytics.yahoo.com/ups/".concat(t,"/fed"),c=bn(bn(bn({he:i},void 0!==n?{gdpr:n}:{}),void 0!==o?{gdpr_consent:o}:{}),void 0!==s?{"1p":s}:{});On(a,c,(function(e){e&&_n(i,bn(bn({},r),{},{connectid:{value:e.vmuid||e.connectid,lastUpdated:(new Date).toISOString()}}))}))}},Tn.syncIds=function(e){e.hashedEmail&&Tn.syncHashedEmail(e)};var Pn=Tn;function Rn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Dn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Rn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Cn=function(e,t){var i=e.pixelId,n=e.email,o=e.gdpr,s=e.gdprConsent,r=e.vm1p;i&&n?function(e,t){e.indexOf("@")<0?t(e):vn(e,t)}(n,(function(e){Pn.syncIds(Dn(Dn(Dn(Dn({pixelId:i},e?{hashedEmail:e}:{}),void 0!==o?{gdpr:o}:{}),void 0!==s?{gdprConsent:s}:{}),void 0!==r?{vm1p:r}:{}));var n=yn(e),a=n.connectid?n.connectid.value:void 0;t(a?{connectid:a}:{})})):t({})},Sn=Cn;function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}"undefined"!=typeof exports&&(exports.getIds=Cn);var kn=function(e){p()(i,e);var t=An(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(y);c()(kn,"TIMEOUT","TIMEOUT"),c()(kn,"RESOLVED","RESOLVED"),c()(kn,"UPDATED","UPDATED");var In=new WeakMap,Nn=new WeakMap,Mn=new WeakMap,xn=function(){function e(){o()(this,e),In.set(this,{writable:!0,value:!1}),Nn.set(this,{writable:!0,value:void 0}),Mn.set(this,{writable:!0,value:{}})}return r()(e,[{key:"resolve",value:function(e){var t=this,i=e.client.idProviders.verizonMedia;if(i&&i.email){if(!l()(this,In)){f()(this,In,!0);var n={vm1p:1,pixelId:i.pixelId,email:i.email},o=e.service.user.regs.gdpr;null!==o.applies&&(n.gdpr=!!o.applies,n.gdprConsent=o.euconsent),f()(this,Nn,setTimeout((function(){f()(t,Nn,null),t.trigger(new kn(kn.TIMEOUT))}),500)),Sn(n,(function(e){clearTimeout(l()(t,Nn)),f()(t,Nn,null);var i=l()(t,Mn).VZM_CONNECTID,n=e.connectid;i&&i!==n?(l()(t,Mn).VZM_CONNECTID=n,t.trigger(new kn(kn.UPDATED))):(l()(t,Mn).VZM_CONNECTID=n,t.trigger(new kn(kn.RESOLVED)))}))}}else f()(this,Nn,null)}},{key:"resolved",get:function(){return null===l()(this,Nn)}},{key:"ids",get:function(){return l()(this,Mn)}}]),e}();Object.assign(xn.prototype,j);var Ln=xn,Fn="".concat("jac.inspect",".position"),jn=function e(){o()(this,e)};c()(jn,"PAGE_LOAD","".concat("jac.inspect",".page.pageLoad")),c()(jn,"PING","".concat("jac.inspect",".handshake.ping")),c()(jn,"PONG","".concat("jac.inspect",".handshake.pong")),c()(jn,"POSITION_ADD","".concat(Fn,".add")),c()(jn,"FETCH_BEGIN","".concat(Fn,".fetchBegin")),c()(jn,"FETCH_COMPLETE","".concat(Fn,".fetchComplete")),c()(jn,"FETCH_TIMEOUT","".concat(Fn,".fetchTimeout")),c()(jn,"POSITION_ROTATE","".concat(Fn,".rotate")),c()(jn,"POSITION_REMOVE","".concat(Fn,".remove")),c()(jn,"POSITION_IN_VIEW","".concat(Fn,".inView")),c()(jn,"POSITION_OUT_VIEW","".concat(Fn,".outView")),c()(jn,"POSITION_RENDER_START","".concat(Fn,".renderStart")),c()(jn,"POSITION_RENDER_COMPLETE","".concat(Fn,".renderComplete")),c()(jn,"POSITION_COLLAPSED","".concat(Fn,".collapsed")),c()(jn,"AD_LOAD_COMPLETE","".concat(Fn,".ad.loadComplete")),c()(jn,"AD_SIZE_CHANGED","".concat(Fn,".ad.sizeChanged")),c()(jn,"POSITION_CONFIG_CHANGED","".concat(Fn,".configChanged")),c()(jn,"POSITION_AD_MARKUP_REQUESTED","".concat(Fn,".ad.markupRequested")),c()(jn,"POSITION_AD_MARKUP","".concat(Fn,".ad.markup"));var Un=/\d\.\d\.\d(-rc\.\d{1,})?\/jac\.js$/,Gn=new WeakMap,Wn=new WeakMap,zn=new WeakMap,Hn=new WeakMap,Vn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(o()(this,e),Gn.set(this,{writable:!0,value:void 0}),Wn.set(this,{writable:!0,value:void 0}),c()(this,"networkType",void 0),zn.set(this,{writable:!0,value:!0}),Hn.set(this,{writable:!0,value:void 0}),!t.performance)return console.warn("No performance support available"),void f()(this,zn,!1);f()(this,Hn,t);var i=t.navigator,n=i.connection||i.mozConnection||i.webkitConnection;this.networkType=n?n.effectiveType:"unknown";var s=t.performance;if(f()(this,Gn,parseFloat(s.timing.navigationStart.toFixed(2))),f()(this,Wn,parseFloat(s.timing.responseEnd.toFixed(2))),s.getEntriesByType){var r=s.getEntriesByType("navigation");r&&r[0]&&f()(this,Wn,parseFloat((r[0].responseEnd+l()(this,Gn)).toFixed(2)))}}return r()(e,[{key:"getClientResourceTiming",value:function(){if(l()(this,zn)&&l()(this,Hn).performance.getEntriesByType){var e=l()(this,Hn).performance.getEntriesByType("resource").filter((function(e){return e.name.match(Un)}));return e.length>0?e[0]:void 0}}},{key:"getFetchResourceTiming",value:function(e){if(l()(this,zn)&&e&&M.isString(e)&&!(e.length<20)&&l()(this,Hn).performance.getEntriesByType){var t=l()(this,Hn).performance.getEntriesByType("resource").filter((function(t){return"script"===t.initiatorType&&t.name===e}));return t.length>0?t[t.length-1]:void 0}}},{key:"responseEnd",get:function(){return l()(this,Wn)}},{key:"timeOrigin",get:function(){return l()(this,Gn)}}]),e}(),Bn=function(){function e(){o()(this,e)}return r()(e,null,[{key:"createPongEvent",value:function(e,t,i){var n=(i=i||new Vn).getClientResourceTiming(),o=e._config.service.site,s={topic:jn.PONG,meta:{timestamp:(new Date).getTime(),responseEnd:i.responseEnd,history:t,client:{version:e.version},adServer:{meta:{},params:{}},site:{spaceId:o.spaceId,name:o.name}}};n&&(s.meta.client.loadTime=n.responseEnd,s.meta.client.loadComplete=n.responseEnd+i.timeOrigin,s.meta.client.url=n.name);var r=e._config.service.adServer;return Object.keys(r).filter((function(e,t){return 0===t})).forEach((function(e){var t=r[e];s.meta.adServer.name=e,s.meta.adServer.params=t.params,e===Me["1AS"]&&(s.meta.adServer.meta.region=t.region)})),s}},{key:"createPositionAddEvent",value:function(e,t){var i,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,s=e._positions[t];if("string"==typeof s.config.client.targetElement){i=s.config.client.targetElement;var r=o.getElementById(i);n=r?r.getBoundingClientRect().top:null}var a={topic:jn.POSITION_ADD,meta:{timestamp:(new Date).getTime(),config:s.config,name:t,elementId:i,elementTop:n,sizes:s.config.service.sizes,containerType:s.containerType,params:s.config.service.params}};return a}},{key:"createFetchBeginEvent",value:function(e,t,i,n){return{topic:jn.FETCH_BEGIN,meta:{timestamp:n,name:e,url:t,prefetched:!!i}}}},{key:"createFetchTimeoutEvent",value:function(e,t){return{topic:jn.FETCH_TIMEOUT,meta:{timestamp:(new Date).getTime(),name:e,url:t}}}},{key:"createFetchCompleteEvent",value:function(e){var t=e.jac,i=e.positionName,n=e.url,o=e.jillTimings,s=e.positionResponse,r=e.requestTimings,a=t._positions[i],c={meta:s.meta},u=s.content.crId;return{topic:jn.FETCH_COMPLETE,meta:{timestamp:(new Date).getTime(),name:i,url:n,upstreamResponseDuration:o.upstreamDuration,serviceResponseDuration:o.totalRequestDuration,totalServiceResponseDuration:r?r.duration:null,processingDuration:o.processingDuration,alias:a?a.config.service.alias:void 0,creativeId:u,adData:c,status:s.status}}}},{key:"createPositionRotateEvent",value:function(e){return{topic:jn.POSITION_ROTATE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionRemoveEvent",value:function(e){return{topic:jn.POSITION_REMOVE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionInViewEvent",value:function(e){return{topic:jn.POSITION_IN_VIEW,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionOutOfViewEvent",value:function(e){return{topic:jn.POSITION_OUT_VIEW,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionRenderStartEvent",value:function(e,t){var i=e._positions[t];return{topic:jn.POSITION_RENDER_START,meta:{timestamp:(new Date).getTime(),name:t,timeout:i.config.client.render.timeout}}}},{key:"createPositionRenderCompleteEvent",value:function(e,t,i,n){var o=e._positions[t],s={topic:jn.POSITION_RENDER_COMPLETE,meta:{timestamp:(new Date).getTime(),name:t,containerType:o.containerType}};return void 0!==P()(i)&&void 0!==P()(n)&&(s.meta.size=i+"x"+n),s}},{key:"createAdSizeChangedEvent",value:function(e,t,i){var n={topic:jn.AD_SIZE_CHANGED,meta:{timestamp:(new Date).getTime(),name:e}};return void 0!==P()(t)&&void 0!==P()(i)&&(n.meta.size=t+"x"+i),n}},{key:"createAdLoadCompleteEvent",value:function(e){return{topic:jn.AD_LOAD_COMPLETE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPageLoadEvent",value:function(e){return{topic:jn.PAGE_LOAD,meta:{timestamp:e}}}},{key:"createPositionCollapsedEvent",value:function(e){return{topic:jn.POSITION_COLLAPSED,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionConfigChangedEvent",value:function(e,t){return{topic:jn.POSITION_CONFIG_CHANGED,meta:{timestamp:(new Date).getTime(),name:e,config:t}}}},{key:"createPositionAdMarkupEvent",value:function(e,t){return{topic:jn.POSITION_AD_MARKUP,meta:{timestamp:(new Date).getTime(),name:e,markup:t}}}}]),e}();function Jn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var Zn=new WeakMap,Yn=new WeakMap,Xn=new WeakMap,qn=new WeakMap,Kn=function(){function e(){o()(this,e),Zn.set(this,{writable:!0,value:void 0}),Yn.set(this,{writable:!0,value:void 0}),Xn.set(this,{writable:!0,value:[]}),qn.set(this,{writable:!0,value:{}})}return r()(e,[{key:"history",get:function(){return l()(this,Xn)}},{key:"activate",value:function(e,t){var i=this;f()(this,Yn,t);var n=Ke.getParameter(e.location.href,"jac.inspect");if("1"===n)this._launchInspector();else if("2"===n){this._launchInspector("?jac.newWindow=true")}this.on(jn.PING,this._onPing,this),this.on(jn.POSITION_AD_MARKUP_REQUESTED,this._onMarkupRequested,this),this._initInternalListeners(t),e.addEventListener("message",(function(e){var t=e.data.topic;t!==jn.PING&&t!==jn.POSITION_AD_MARKUP_REQUESTED||i.trigger(new y(t,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Jn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({source:e.source},e.data.meta)))}))}},{key:"produceEvent",value:function(e){l()(this,Zn)?l()(this,Zn).postMessage(e,"*"):l()(this,Xn).push(e)}},{key:"_launchInspector",value:function(e){e=e||"";var t=document.createElement("script");t.src="https://jacky-prod-us-east-1.s3.amazonaws.com/jacky/bootstrap/jacky-bootstrap.min.js"+e,document.head.appendChild(t)}},{key:"_initInternalListeners",value:function(e){e.on(at.POSITION_CREATED,this._onPositionCreated,this),e._jill.on(vt.FETCH_START,this._onFetchStart,this),e._jill.on(vt.RESPONSE_PROCESSED,this._onJillResponseProcessed,this),e._jill.on(vt.FETCH_TIMEOUT,this._onJillFetchTimeout,this),e.on(at.POSITION_ROTATE,this._onPositionRotate,this),e.on(at.POSITION_VIEW_START,this._onPositionViewStart,this),e.on(at.POSITION_VIEW_END,this._onPositionViewEnd,this),e.on(at.POSITION_RENDER_START,this._onPositionRenderStart,this),e.on(at.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),e.on(at.POSITION_COLLAPSED,this._onPositionCollapsed,this),e.on(at.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),e.on(at.AD_SIZE_CHANGED,this._onAdSizeChanged,this),e._pageObserver.on(O.LOADED,this._onPageLoad,this),e.on(at.POSITION_CONFIG_CHANGED,this._onPositionConfigChanged,this)}},{key:"_onPing",value:function(e){var t=l()(this,Yn)._config;t&&t.service?l()(this,Zn)?console.warn("Already responded to the ping request."):(f()(this,Zn,e.meta.source),this._sendPong()):console.warn("No config set yet. Can not reply to inspect ping requests.")}},{key:"_onMarkupRequested",value:function(e){e.meta&&e.meta.name?l()(this,Zn)?l()(this,qn)[e.meta.name]&&this.produceEvent(Bn.createPositionAdMarkupEvent(e.meta.name,l()(this,qn)[e.meta.name])):console.warn("No ping initialization request got."):console.warn("No position name provided in the ad markup request.")}},{key:"_sendPong",value:function(){var e=Bn.createPongEvent(l()(this,Yn),l()(this,Xn));this.produceEvent(e),f()(this,Xn,[])}},{key:"_onPositionCreated",value:function(e){this.produceEvent(Bn.createPositionAddEvent(l()(this,Yn),e.meta.positionName))}},{key:"_onFetchStart",value:function(e){var t=this,i=e.meta.url,n=e.meta.prefetched,o=(new Date).getTime();Object.keys(e.meta.request.positions).forEach((function(e){t.produceEvent(Bn.createFetchBeginEvent(e,i,n,o))}))}},{key:"_onJillFetchTimeout",value:function(e){var t=this,i=e.meta.url;e.meta.positionNames.forEach((function(e){t.produceEvent(Bn.createFetchTimeoutEvent(e,i))}))}},{key:"_onJillResponseProcessed",value:function(e){var t=this,i=e.meta.url,n=e.meta.response,o=n.positions,s=n.adServer.requestDuration,r=n.service.timings;r.upstreamDuration=s;var a=l()(this,Yn),c=(new Vn).getFetchResourceTiming(i);Object.keys(o).forEach((function(e){l()(t,qn)[e]=o[e][0].content.markup,t.produceEvent(Bn.createFetchCompleteEvent({jac:a,positionName:e,url:i,jillTimings:r,positionResponse:o[e][0],requestTimings:c}))}))}},{key:"_onPositionRotate",value:function(e){this.produceEvent(Bn.createPositionRotateEvent(e.meta.positionName))}},{key:"_onPositionViewStart",value:function(e){this.produceEvent(Bn.createPositionInViewEvent(e.meta.positionName))}},{key:"_onPositionViewEnd",value:function(e){this.produceEvent(Bn.createPositionOutOfViewEvent(e.meta.positionName))}},{key:"_onPositionRenderStart",value:function(e){this.produceEvent(Bn.createPositionRenderStartEvent(l()(this,Yn),e.meta.positionName))}},{key:"_onPositionRenderComplete",value:function(e){this.produceEvent(Bn.createPositionRenderCompleteEvent(l()(this,Yn),e.meta.positionName,e.meta.width,e.meta.height))}},{key:"_onAdLoadComplete",value:function(e){this.produceEvent(Bn.createAdLoadCompleteEvent(e.meta.positionName))}},{key:"_onAdSizeChanged",value:function(e){this.produceEvent(Bn.createAdSizeChangedEvent(e.meta.positionName,e.meta.width,e.meta.height))}},{key:"_onPageLoad",value:function(e){this.produceEvent(Bn.createPageLoadEvent(e.meta.timestamp))}},{key:"_onPositionCollapsed",value:function(e){this.produceEvent(Bn.createPositionCollapsedEvent(e.meta.positionName))}},{key:"_onPositionConfigChanged",value:function(e){this.produceEvent(Bn.createPositionConfigChangedEvent(e.meta.positionName,e.meta.config))}},{key:"adHistory",get:function(){return l()(this,qn)}}]),e}();Object.assign(Kn.prototype,j);var $n=Kn;function Qn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var eo=function(e){p()(i,e);var t=Qn(i);function i(e,n){var s;return o()(this,i),(s=t.call(this,e)).meta=n,s}return i}(y);c()(eo,"COUNTER","".concat("Collector",".COUNTER")),c()(eo,"DURATION","".concat("Collector",".DURATION"));var to={JacLoadDelay:"JacLoadDelay",FetchDelay:"FetchDelay",FetchTimeoutCount:"FetchTimeoutCount",FetchNetworkDuration:"FetchNetworkDuration",PositionFetchDuration:"PositionFetchDuration",PositionRenderDelay:"PositionRenderDelay",PositionRenderDuration:"PositionRenderDuration",PositionViewableDelay:"PositionViewableDelay",AdLoadDuration:"AdLoadDuration",PositionFetchErrorCount:"PositionFetchErrorCount",PositionAdClosedCount:"PositionAdClosedCount",PositionAdOpenedCount:"PositionAdOpenedCount"},io=[to.FetchTimeoutCount];function no(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?"".concat(e,"_").concat(JSON.stringify(t)):e}function oo(e){return e.split("_")[0]}var so=new WeakMap,ro=new WeakMap,ao=new WeakMap,co=new WeakMap,uo=new WeakMap,lo=new WeakMap,ho=new WeakMap,fo=new WeakMap,po=new WeakMap,vo=new WeakMap,mo=new WeakMap,go=new WeakMap,Eo=function(){function e(t,i){o()(this,e),so.set(this,{writable:!0,value:void 0}),ro.set(this,{writable:!0,value:void 0}),ao.set(this,{writable:!0,value:{}}),co.set(this,{writable:!0,value:{}}),uo.set(this,{writable:!0,value:{}}),lo.set(this,{writable:!0,value:{}}),ho.set(this,{writable:!0,value:{}}),fo.set(this,{writable:!0,value:void 0}),po.set(this,{writable:!0,value:void 0}),vo.set(this,{writable:!0,value:void 0}),mo.set(this,{writable:!0,value:void 0}),go.set(this,{writable:!0,value:void 0}),f()(this,so,t),f()(this,ro,i||new Vn),f()(this,fo,l()(this,ro).networkType),f()(this,po,l()(this,ro).responseEnd),f()(this,mo,to),f()(this,go,!0)}return r()(e,[{key:"start",value:function(){this._toggleEventListeners(!0);var e={networkType:l()(this,fo)};this.markDurationStart(to.JacLoadDelay,e,l()(this,po)),f()(this,vo,(new Date).getTime()),this.markDurationEnd(to.JacLoadDelay,e,l()(this,vo))}},{key:"stop",value:function(){this._toggleEventListeners(!1)}},{key:"setActiveMetrics",value:function(e){var t=this;f()(this,mo,{}),e.forEach((function(e){return l()(t,mo)[e]=to[e]}));var i=l()(this,so);l()(this,mo)[to.FetchDelay]||l()(this,mo)[to.PositionFetchDuration]||i._jill.off(vt.FETCH_START,this._onFetchStart,this),l()(this,mo)[to.FetchNetworkDuration]||i._jill.off(vt.FETCH_COMPLETE,this._onJillFetchComplete,this),l()(this,mo)[to.PositionFetchDuration]||l()(this,mo)[to.PositionRenderDelay]||i.off(at.FETCH_COMPLETE,this._onFetchComplete,this),l()(this,mo)[to.FetchTimeoutCount]||i.off(at.FETCH_TIMEOUT,this._onFetchTimeout,this),l()(this,mo)[to.PositionRenderDelay]||l()(this,mo)[to.PositionRenderDuration]||i.off(at.POSITION_RENDER_START,this._onPositionRenderStart,this),l()(this,mo)[to.PositionRenderDuration]||l()(this,mo)[to.PositionViewableDelay]||l()(this,mo)[to.AdLoadDuration]||i.off(at.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),l()(this,mo)[to.PositionViewableDelay]||i.off(at.POSITION_VIEWABLE,this._onPositionViewable,this),l()(this,mo)[to.AdLoadDuration]||i.off(at.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),l()(this,mo)[to.PositionFetchErrorCount]||i.off(at.FETCH_ERROR,this._onFetchError,this),l()(this,mo)[to.PositionAdClosedCount]||i.off(at.AD_CLOSED,this._onAdClosed,this),l()(this,mo)[to.PositionAdOpenedCount]||i.off(at.AD_OPENED,this._onAdOpened,this),this._cleanNonActiveCollectedMetrics()}},{key:"_cleanNonActiveCollectedMetrics",value:function(){var e=this;Object.keys(l()(this,co)).forEach((function(t){var i=oo(t);l()(e,mo)[i]||delete l()(e,co)[t]})),Object.keys(l()(this,uo)).forEach((function(t){var i=oo(t);l()(e,mo)[i]||delete l()(e,uo)[t]}))}},{key:"durations",get:function(){var e=l()(this,go)?l()(this,lo):l()(this,co);return Object.keys(e).reduce((function(t,i){return t.concat(e[i])}),[])}},{key:"counters",get:function(){var e=l()(this,go)?l()(this,ho):l()(this,uo);return Object.keys(e).map((function(t){return e[t]}))}},{key:"flush",value:function(){l()(this,go)?(f()(this,lo,{}),f()(this,ho,{})):(f()(this,co,{}),f()(this,uo,{}))}},{key:"markDurationStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(l()(this,mo)[e]){i=i||(new Date).getTime();var n=no(e,t);l()(this,ao)[n]&&console.warn("".concat(n," duration metric already started.")),l()(this,ao)[n]={name:e,startTime:i,dimensions:t}}}},{key:"markDurationEnd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(l()(this,mo)[e]){i=i||(new Date).getTime();var n=no(e,t);if(l()(this,ao)[n]){var o=l()(this,ao)[n];o.endTime=i,o.duration=parseFloat((o.endTime-o.startTime).toFixed(2));var s=-1!==io.indexOf(e);l()(this,go)&&s?(l()(this,lo)[n]=l()(this,lo)[n]||[],l()(this,lo)[n].push(o)):(l()(this,co)[n]=l()(this,co)[n]||[],l()(this,co)[n].push(o)),delete l()(this,ao)[n],l()(this,go)&&!s||this._notifyMetricEvent(new eo(eo.DURATION,o))}else console.error("".concat(n," duration metric not started."))}}},{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(l()(this,mo)[e]){var i=no(e,t),n=-1!==io.indexOf(e),o=l()(this,go)&&n?l()(this,ho):l()(this,uo),s=o[i]=o[i]||{name:e,count:0,dimensions:t};s.count++,l()(this,go)&&!n||this._notifyMetricEvent(new eo(eo.COUNTER,s))}}},{key:"disableBufferMode",value:function(){f()(this,go,!1)}},{key:"_onFetchStart",value:function(e){var t=this,i=Object.keys(e.meta.request.positions),n=l()(this,fo);l()(this,co)[to.FetchDelay]||(this.markDurationStart(to.FetchDelay,{networkType:n},l()(this,vo)),this.markDurationEnd(to.FetchDelay,{networkType:n})),i.forEach((function(e){t.markDurationStart(to.PositionFetchDuration,{positionName:e,networkType:n})}))}},{key:"_onJillFetchComplete",value:function(e){var t=e.meta.url,i=l()(this,ro).getFetchResourceTiming(t);if(i&&i.duration){var n=l()(this,fo);this.markDurationStart(to.FetchNetworkDuration,{networkType:n},i.startTime),this.markDurationEnd(to.FetchNetworkDuration,{networkType:n},i.responseEnd)}}},{key:"_onFetchComplete",value:function(e){var t=this,i=e.meta.positionNames,n=l()(this,fo);i.forEach((function(e){t.markDurationEnd(to.PositionFetchDuration,{positionName:e,networkType:n}),t.markDurationStart(to.PositionRenderDelay,{positionName:e,networkType:n})}))}},{key:"_onFetchTimeout",value:function(){this.incrementCounter(to.FetchTimeoutCount)}},{key:"_onPositionRenderStart",value:function(e){var t=e.meta.positionName,i=l()(this,fo),n=no(to.PositionRenderDelay,{positionName:t,networkType:i});l()(this,ao)[n]&&this.markDurationEnd(to.PositionRenderDelay,{positionName:t,networkType:i}),this.markDurationStart(to.PositionRenderDuration,{positionName:t,networkType:i})}},{key:"_onPositionRenderComplete",value:function(e){var t=e.meta.positionName,i=l()(this,fo);this.markDurationEnd(to.PositionRenderDuration,{positionName:t,networkType:i}),this.markDurationStart(to.AdLoadDuration,{positionName:t,networkType:i}),this.markDurationStart(to.PositionViewableDelay,{positionName:t})}},{key:"_onPositionViewable",value:function(e){var t=e.meta.positionName;this.markDurationEnd(to.PositionViewableDelay,{positionName:t})}},{key:"_onAdLoadComplete",value:function(e){var t=e.meta.positionName,i=l()(this,fo);this.markDurationEnd(to.AdLoadDuration,{positionName:t,networkType:i})}},{key:"_onFetchError",value:function(e){var t=this;e.meta.positionNames.forEach((function(e){t.incrementCounter(to.PositionFetchErrorCount,{positionName:e})}))}},{key:"_onAdClosed",value:function(e){var t=e.meta.positionName;this.incrementCounter(to.PositionAdClosedCount,{positionName:t})}},{key:"_onAdOpened",value:function(e){var t=e.meta.positionName;this.incrementCounter(to.PositionAdOpenedCount,{positionName:t})}},{key:"_notifyMetricEvent",value:function(e){var t=this;setTimeout((function(){t.trigger(e)}),0)}},{key:"_toggleEventListeners",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"on":"off",i=l()(this,so);i._jill[t](vt.FETCH_START,this._onFetchStart,this),i._jill[t](vt.FETCH_COMPLETE,this._onJillFetchComplete,this),i[t](at.FETCH_COMPLETE,this._onFetchComplete,this),i[t](at.FETCH_TIMEOUT,this._onFetchTimeout,this),i[t](at.POSITION_RENDER_START,this._onPositionRenderStart,this),i[t](at.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),i[t](at.POSITION_VIEWABLE,this._onPositionViewable,this),i[t](at.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),i[t](at.FETCH_ERROR,this._onFetchError,this),i[t](at.AD_CLOSED,this._onAdClosed,this),i[t](at.AD_OPENED,this._onAdOpened,this)}}]),e}();function yo(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?yo(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):yo(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}Object.assign(Eo.prototype,j);var Oo="undefined"!=typeof $JAC_METRICS_QUEUE_DELAY$?$JAC_METRICS_QUEUE_DELAY$:5e3,wo=new WeakMap,bo=new WeakMap,To=new WeakMap,Po=new WeakMap,Ro=new WeakMap,Do=new WeakMap,Co=new WeakMap,So=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;o()(this,e),wo.set(this,{writable:!0,value:void 0}),bo.set(this,{writable:!0,value:void 0}),To.set(this,{writable:!0,value:void 0}),Po.set(this,{writable:!0,value:{}}),Ro.set(this,{writable:!0,value:!1}),Do.set(this,{writable:!0,value:void 0}),Co.set(this,{writable:!0,value:void 0}),f()(this,wo,t);var s=n.JAC_CONFIG||{},r=s.service&&s.service.host,a=s.service&&s.service.site&&s.service.site.name;this.setGlobalTags({siteName:a}),this.setMetricsHost(r||"https://jill.fc.yahoo.com/"),f()(this,To,i.version),f()(this,Co,n)}return r()(e,[{key:"activate",value:function(){var e=this;l()(this,Do)||(l()(this,wo).on(eo.COUNTER,this._enqueueReport,this),l()(this,wo).on(eo.DURATION,this._enqueueReport,this),f()(this,Do,(function(){return e.report()})),l()(this,Co).addEventListener("unload",l()(this,Do)))}},{key:"deactivate",value:function(){l()(this,Do)&&(l()(this,wo).off(eo.COUNTER,this._enqueueReport,this),l()(this,wo).off(eo.DURATION,this._enqueueReport,this),l()(this,Co).removeEventListener("unload",l()(this,Do)),f()(this,Do,null))}},{key:"setGlobalTags",value:function(e){var t=e.siteName;f()(this,Po,_o(_o({},l()(this,Po)),{},{siteName:t}))}},{key:"setMetricsHost",value:function(e){f()(this,bo,"".concat(e).concat("v1/client/m"))}},{key:"report",value:function(){var e=l()(this,wo).durations.map((function(e){return{type:"duration",value:e.duration,name:e.name,tags:e.dimensions||void 0}})),t=l()(this,wo).counters.map((function(e){return{type:"count",value:e.count,name:e.name,tags:e.dimensions||void 0}})),i=e.concat(t);if(!(i.length<=0)){var n=JSON.stringify({jacVersion:l()(this,To),tags:l()(this,Po)||void 0,metrics:i});"function"==typeof l()(this,Co).navigator.sendBeacon?l()(this,Co).navigator.sendBeacon(l()(this,bo),n):(new(l()(this,Co).Image)).src="".concat(l()(this,bo),"?data=").concat(encodeURIComponent(n)),l()(this,wo).flush()}}},{key:"_enqueueReport",value:function(){var e=this;l()(this,Ro)||(f()(this,Ro,!0),setTimeout((function(){e.report(),f()(e,Ro,!1)}),Oo))}},{key:"jacVersion",get:function(){return l()(this,To)}},{key:"collector",get:function(){return l()(this,wo)}},{key:"globalTags",get:function(){return l()(this,Po)}},{key:"beaconUrl",get:function(){return l()(this,bo)}}]),e}();Object.assign(So.prototype,j);var Ao=new WeakMap,ko=function(){function e(){o()(this,e),c()(this,"collector",void 0),c()(this,"reporter",void 0),Ao.set(this,{writable:!0,value:void 0})}return r()(e,[{key:"init",value:function(e){this.collector=new Eo(e),this.reporter=new So(this.collector,e),this.reporter.activate(),this.collector.start()}},{key:"processJillMetricFlag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];M.isSet(l()(this,Ao))||(f()(this,Ao,!1!==e||t.length>0),this.collector&&this.collector.disableBufferMode(),!1===e&&t.length>0&&this.collector.setActiveMetrics(t),this.reporter&&l()(this,Ao)&&this.reporter.activate(),this.collector&&!l()(this,Ao)&&this.collector.stop())}},{key:"configUpdated",value:function(e){var t=e.service.site&&e.service.site.name;this.reporter.setGlobalTags({siteName:t}),e.service.host&&this.reporter.setMetricsHost(e.service.host)}}]),e}();function Io(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function No(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Io(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Io(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Mo=window.JAC_BASE_URL||"https://jac.yahoosandbox.com",xo=P()("0.8.1")!==k?"0.8.1":"0.0.0";function Lo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mo;return"".concat(e,"/").concat(xo)}var Fo=function(e,t,i){var n=t.positions,o=t.client.l10n||{};return e.reduce((function(e,s){var r=i.positions[s],a=n[s]?n[s][0]:null;if(!r||!a)return console.warn("Position ".concat(s," is not valid to be processed from the response.")),e;a.config=Qe.clone(r),a.config.client.closeButton.labels={close:o.closeAdLabel,show:o.showAdLabel};var c=r.input.client.closeButton||{};Qe.copy(r.client.closeButton.labels,a.config.client.closeButton.labels,!0),Qe.copy(c.labels||{},a.config.client.closeButton.labels);var u=r.service.sizes;if(M.isString(u)){var l=t.client.sizeMapping;if(!M.isObject(l)||!l[u])return void console.warn("Position ".concat(s," size mapping lookup failure."));a.config.service.sizes=l[u]}return a.clientBaseUrl=Lo(t.client.url),a.meta=a.meta||{},a.meta.isMobileMoment=ve.isMobileMomentAd(a),e[s]=a,e}),{})},jo=function(e,t){return e.reduce((function(e,i){var n=t.positions[i];return n?(e[i]={status:je,content:{},clientBaseUrl:Lo(),config:n,meta:{}},e):(console.warn("Timeout for a non-existing position ".concat(i," received.")),e)}),{})},Uo=function(e){var t=e.client.content;return t&&t.markup?(e.service.sizes=e.service.sizes||["".concat(t.size.width,"x").concat(t.size.height)],{status:Le,content:{markup:t.markup,size:No(No({},t.size),{},{unit:xe})},clientBaseUrl:Lo(),config:e,meta:{}}):null};function Go(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=t.document,n=i.createElement("iframe");n.src=e,ce.setStyles(n,{display:"none",border:"none",width:0,height:0}),i.body.appendChild(n)}var Wo=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;o()(this,e),c()(this,"userRegulations",void 0),c()(this,"windowContext",void 0),this.userRegulations=t,this.windowContext=i}return r()(e,[{key:"injectTrackers",value:function(e){var t=this;!e||e.opus?this._onUserRegulationsResolved((function(){return t._injectOpusTag()})):e&&e.smartPixel&&this._injectSmartPixelTag(),e&&e.msftSync&&((new Image).src="https://cms.analytics.yahoo.com/cms?partner_id=MSFT")}},{key:"_onUserRegulationsResolved",value:function(e){this.userRegulations.resolved?e():(this.userRegulations.on(on.RESOLVED,e),this.userRegulations.on(on.READ_TIMEOUT,e),this.userRegulations.on(on.API_NOT_FOUND,e))}},{key:"_injectOpusTag",value:function(){var e=Ke.removeParameters(this.windowContext.document.referrer);Go("https://opus.analytics.yahoo.com/tag/opus-frame.html"+"?referrer=".concat(encodeURIComponent(e)),this.windowContext)}},{key:"_injectSmartPixelTag",value:function(){var e=Ke.removeParameters(this.windowContext.document.referrer);Go("".concat("https://tag.idsync.analytics.yahoo.com/sp-frame.html","?referrer=").concat(encodeURIComponent(e)),this.windowContext)}}]),e}();function zo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var o=E()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m()(this,i)}}var Ho=function(e){p()(i,e);var t=zo(i);function i(){return o()(this,i),t.apply(this,arguments)}return i}(Ot);c()(Ho,"ACTION_NAME","render");var Vo=P()("0.8.1")!==k?"0.8.1":"0.0.0",Bo={},Jo=new Ct(Vo),Zo=new B,Yo=new Bi,Xo=new Qi(Zo),qo=pn.getInstance(),Ko=new Ln,$o=new $n,Qo=new ko,es=new ot,ts=new Wo(qo);function is(e,t,i){if(!Array.isArray(t)||0===t.length)return console.warn("Invalid array of position names used with JAC.".concat(e,"()")),{result:!1,validPositionNames:[]};var n=t.filter((function(e){return hs._config.positions[e]&&(!i||i(e))}));if(0===n.length)return console.warn("JAC.".concat(e,"() aborted because there are no valid positions.")),{result:!1,validPositionNames:n};if(n.length!==t.length){var o=$e.diff(t,n);console.warn("JAC.".concat(e,"() failed for the following positions"),o)}return{result:!0,validPositionNames:n}}function ns(e){!function(e){qo.resolved?e():(qo.on(on.RESOLVED,e),qo.on(on.READ_TIMEOUT,e),qo.on(on.API_NOT_FOUND,e))}((function(){!function(e){Ko.resolved?e():(Ko.on(kn.RESOLVED,e),Ko.on(kn.TIMEOUT,e))}(e)}))}function os(e,t){hs.trigger(new at(e,Object.assign({},t)))}function ss(e){os(at.POSITION_CONFIG_CHANGED,{positionName:e.target.name,config:e.meta})}function rs(e,t){var i=Object.assign({},t,e.meta),n=e.meta.positionName,o=hs._positions[n].render;e.type===xt.RENDER_COMPLETE?(o.completePosition(n),os(at.POSITION_RENDER_COMPLETE,i)):e.type===xt.RENDER_FAILED&&(o.abortPosition(n),os(at.POSITION_RENDER_FAILED,i)),o.positionNames.length<=0&&(o.end(),os(at.RENDER_COMPLETE,{positionNames:o.completedPositionNames}))}function as(e,t,i){ns((function(){e.start(),os(at.FETCH_START,{positionNames:e.positionNames}),Jo.fetchAds(e,t,i)}))}function cs(e,t){var i=t.filter((function(t){var i=hs._positions[t];if(i){var n=i.config.client[e].auto,o=!!Bo[t],s=i[e]&&i[e].isPending(t);return n&&!s&&o===(e===Ho.ACTION_NAME)}return!1}));i.length>0&&hs[e](i)}function us(e){cs(bt.ACTION_NAME,e)}function ls(e){cs(Ho.ACTION_NAME,e)}var hs={_jill:Jo,_scheduler:Xo,_pageObserver:Zo,_pageProtection:Yo,_userRegulations:qo,_userIdentity:Ko,_inspectHandler:$o,_adRotationFactory:es,_trackersManager:ts,_instrumentationController:Qo,_adData:Bo,_positions:{},_positionComponents:{},_config:null,_onReadyExecuted:!1,_globalConfigProcessed:!1,processQueue:function(){Jo.process()},get version(){return Vo},setConfig:function(e){var t=this,i=e;this._config=new dt(e);var n=i.service&&i.service.user?i.service.user.regs:void 0;qo.resolve(window,n),qo.resolved&&ds(),Ko.resolved&&ps();var o=this._config.client.positions;o&&(Object.keys(this._positions).filter((function(e){return!o[e]})).forEach((function(e){return t.destroyPosition(e)})),Object.keys(o).forEach((function(e){var i=t._config.positions[e];t._createPosition(e,i)})));Qo.configUpdated(this._config),Xo.applyGlobalRotationConfig(this._config.client.rotation),Yo.init(Zo,this,window),function(e){if(e.client&&M.isFunction(e.client.onReady)&&!hs._onReadyExecuted){hs._globalConfigProcessed&&console.warn("JAC: Support for onReady hook with JAC.setConfig() has been deprecated and will be removed in the future versions. Please move the code from onReady hook to be executed before JAC.setConfig(). Also, setting the onReady hook inside global JAC_CONFIG variable before JAC is loaded still continues to be supported.");var t=e.client.onReady;try{t()}catch(e){console.error("Error while calling JAC_CONFIG.onReady():",e)}hs._onReadyExecuted=!0}}(i);var s=Object.keys(o);us(s),this._pageObserver.domLoaded&&ls(s)},getConfig:function(){return this._config?this._config.clone():void 0},createPosition:function(e,t){if(M.isString(e))if(this._config){this._config.updatePosition(e,t);var i=this._config.positions[e];this._createPosition(e,i);var n=[e];us(n),this._pageObserver.domLoaded&&ls(n)}else console.warn("JAC Config has not been set.");else console.warn("Non-string positionName found that is ignored: ".concat(e,"."))},_createPosition:function(e,t){var i=this._positions[e];if(i?i.update(t):(this._positions[e]=i=new Nt(e,t),i.on(At.CONFIG_UPDATE,ss),os(at.POSITION_CREATED,{positionName:e})),i.config.client.rotation.enabled&&!Xo.isPositionRegistered(e)){Xo.register(i);var n=this._positionComponents[e];n&&Xo.subscribe(n)}var o=t.client.content;if(o&&o.markup){var s=Uo(t);i.applyAdData(s),Bo[e]=s}return i},_createPositionComponent:function(e){var t,i=this,n=e.name,o=new Wi(e,this._pageObserver),s={positionName:n},r=(t={},c()(t,xt.RENDER_START,(function(){os(at.POSITION_RENDER_START,s)})),c()(t,xt.RENDER_COMPLETE,(function(e){rs(e,s)})),c()(t,xt.RENDER_FAILED,(function(e){rs(e,s)})),c()(t,xt.VIEW_START,(function(){os(at.POSITION_VIEW_START,s)})),c()(t,xt.VIEW_END,(function(){os(at.POSITION_VIEW_END,s)})),c()(t,xt.VIEWABLE,(function(){os(at.POSITION_VIEWABLE,s)})),c()(t,xt.AD_LOAD,(function(){os(at.AD_LOAD_COMPLETE,s)})),c()(t,xt.NO_AD,(function(){os(at.POSITION_COLLAPSED,s)})),c()(t,xt.AD_SIZE_CHANGED,(function(e){var t=Object.assign({},s,e.meta);os(at.AD_SIZE_CHANGED,t)})),c()(t,xt.AD_MESSAGE,(function(e){var t=Object.assign({},s,e.meta);os(at.AD_MESSAGE,t)})),c()(t,xt.DESTROY,(function(){Xo.isPositionRegistered(n)&&Xo.unsubscribe(o),a("off"),delete i._positionComponents[n]})),c()(t,xt.AD_CLOSED,(function(){os(at.AD_CLOSED,s)})),c()(t,xt.AD_OPENED,(function(){os(at.AD_OPENED,s)})),t),a=function(e){return Object.keys(r).forEach((function(t){return o[e](t,r[t])}))};return a("on"),Xo.isPositionRegistered(n)&&Xo.subscribe(o),o},destroyPosition:function(e){var t=this._positionComponents[e];t&&t.destroy();var i=this._positions[e];i&&(i.off(At.CONFIG_UPDATE,ss),Xo.isPositionRegistered(e)&&Xo.deregister(i),this.abort([e]),this._config.removePosition(e),delete this._positions[e],delete Bo[e])},fetch:function(e){var t=this;if(this._config)if(this._config.isServiceConfigValid()){M.isSet(e)||(e=Object.keys(this._positions));var i=is("fetch",e,(function(e){var i=t._positions[e],n=i.fetch,o=(new Date).getTime(),s=i.config.client.fetch.minInterval;return!n||!(n.isPending(e)||n.endTime+s>o)||(console.warn("JAC.fetch() can only be called "+"once per ".concat(s,"ms for ").concat(e," position.")),!1)})),n=i.result,o=i.validPositionNames;if(n){var s=new bt({positionNames:o});o.forEach((function(e){var i=t._positions[e];i.fetch=s,Xo.isPositionRegistered(e)&&Xo.resetRegistration(i)})),as(s,this._config)}}else console.warn("JAC Config has missing/invalid information.");else console.warn("JAC Config has not been set.")},render:function(e){var t=this;if(this._config){M.isSet(e)||(e=Object.keys(Bo));var i=is("render",e,(function(e){var i=t._positions[e];return i&&function(e,t){return Bo[e]?!!t.getTargetElement()||(console.warn("Target HTML element not found for position ".concat(e,".")),!1):(console.warn("No ad data for position ".concat(e,".")),!1)}(e,i.config)})),n=i.result,o=i.validPositionNames;if(n){var s=new Ho({positionNames:o});s.start(),o.forEach((function(e){t._positions[e].render=s})),os(at.RENDER_START,{positionNames:o}),o.forEach((function(e){var i=t._positions[e];t._positionComponents[e]||(t._positionComponents[e]=t._createPositionComponent(i)),t._positionComponents[e].render(),delete Bo[e]}))}}else console.warn("JAC Config has not been set.")},abort:function(e){var t=this;M.isSet(e)||(e=Object.keys(this._positions));var i=is("abort",e),n=i.result,o=i.validPositionNames;n&&o.forEach((function(e){var i=t._positions[e],n=i.fetch;n&&n.isPending(e)&&(n.abortPosition(e),i.fetch=null);var o=i.render;if(o&&o.isPending(e)){o.abortPosition(e),i.render=null;var s=t._positionComponents[e];s&&s.abortRender()}}))},isPositionPending:function(e){var t=this._positions[e];return!(!t||!(t.fetch&&t.fetch.isPending(e)||t.render&&t.render.isPending(e)))},getPending:function(){var e=this;return Object.keys(this._positions).filter((function(t){return e.isPositionPending(t)}))},isPositionFetched:function(e){return!!Bo[e]},getFetched:function(){return Object.keys(Bo)},updateMeta:function(e,t,i,n){var o=this;if(!t||M.isString(t)&&!i)console.warn("Invalid meta was provided.");else{var s=is("updateMeta",e,(function(e){return o._positionComponents[e]})),r=s.result,a=s.validPositionNames;r&&a.forEach((function(e){o._config.updateMeta(e,t,i,n)&&o._positionComponents[e].updateMeta()}))}}};function fs(e){Object.keys(e).forEach((function(t){var i=e[t],n=hs._positions[t];if(n.applyAdData(i),!n.rotated&&n.config.client.rotation.enabled&&Object.prototype.hasOwnProperty.call(hs._config.service.adServer,Me["1AS"])){var o=es.createRotationConfig(n.config,i);n.updateRotationConfig(o)}Bo[t]=i}))}function ds(){hs._config.setRegulatoryData(qo),Ko.resolve(hs._config)}function ps(){hs._config.setUserIdentity(Ko)}Object.assign(hs,j);var vs=hs;window!==window.top&&"undefined"==typeof JAC_CONFIG?function(e){if(function(e){var t=!1;try{e.parent.location.href&&(t=!0)}catch(e){t=!1}if(!t){var i=e.location.host;return[/^.*yahoosandbox\.com$/,/^.*localhost(:\d+)?$/].filter((function(e){return i.match(e)})).length>0}try{return!e.frameElement.src}catch(e){return!0}}(e)){var t=function(e){var t,i,n,o=e.name;if(!o)throw Error("No data provided for the position sandbox.");e.name="";try{e.frameElement.removeAttribute("name")}catch(e){}try{var s=JSON.parse(o);t=s.token,i=s.adData,n=s.safeFrame}catch(e){throw Error("Invalid data provided for the position sandbox.")}if(!t)throw Error("Missing sandbox token.");if(!i||!i.content)throw Error("Missing sandbox ad data.");if(!i.content.markup)throw Error("Missing sandbox ad markup.");if(!i.content.size||!i.content.size.width||!i.content.size.height)throw Error("Missing sandbox ad size.");if(!i.config||!i.config.service||!i.config.client)throw Error("Missing sandbox position config.");var r=i.config.service.sizes,a=r?r.map((function(e){var t=e.split("x"),i=Z()(t,2),n=i[0],o=i[1];return{width:parseInt(n),height:parseInt(o)}})):[],c=i.status!==Fe&&!ve.isMobileMomentAd(i)&&(!i.meta||!i.meta.aolSize)&&a.length>1;return{token:t,adMarkup:i.content.markup,size:i.content.size,detectSize:c,allowedSizes:a,positionConfig:i.config,safeFrameData:n}}(e),i=t.token,n=t.adMarkup,o=t.size,s=t.detectSize,r=t.allowedSizes,a=t.positionConfig,u=t.safeFrameData;Ye=s,function(e,t,i){var n=function(e,t){var i=e.document.referrer;if(!t||!i)return!1;var n=i.match(/^(https?:\/\/)?([^/?]*).*$/);if(!n||n.length<3)return!1;var o=n[2];return["aol.com","yahoo.com"].filter((function(e){return o.endsWith(e)})).length>0}(t,i)?t.parent:t.top,o=c()({},Y.topic.UNLOAD,{before:[Y.topic.WRITE_COMPLETE],after:[]});Ae=new ae(n,e,o)}(i,e,a.client.nestedIframe),function(e,t){e.JAC={version:P()("0.8.1")!==k?"0.8.1":"0.0.0",sandbox:new we(Ae,t)}}(e,a),e.JAC.sandbox.on(ge.INIT_CALLED,(function(){Ye=!1}));var l=a.client.safeFrame;l&&l.enabled&&function(e,t,i){Ae.listen(),e.$sf={ext:new Ie(Ae,t,i)},e.Y={SandBox:{vendor:new Ne(Ae)}}}(e,a,u),w.addPageLoadListener((function(){return Xe({positionConfig:a,initialWidth:o.width,initialHeight:o.height,allowedSizes:r})})),function(e,t){e.document.write("<div>".concat(t,"</div>"))}(e,n),Ae.send(new Y({topic:Y.topic.WRITE_COMPLETE}))}else console.error("Invalid context detected")}(window):(Object.assign(vs,{PageObserver:B,PageEvent:O}),window.JAC=vs,function(e){Jo.on(vt.RESPONSE_PROCESSED,(function(e){var t=e.meta.response;Qo.processJillMetricFlag(t.client.metrics,t.client.samplingRateExemptMetrics);var i=e.meta.fetchAction;i.end();var n=Fo(i.completedPositionNames,t,hs._config),o=Object.keys(n);fs(n),os(at.FETCH_COMPLETE,{positionNames:o,response:{positions:n,adServer:t.adServer,service:t.service}}),Zo.domLoaded&&ls(o)})),Jo.on(vt.FETCH_TIMEOUT,(function(e){var t=jo(e.meta.positionNames,hs._config),i=Object.keys(t);fs(t),os(at.FETCH_TIMEOUT,e.meta),Zo.domLoaded&&ls(i)})),Jo.on(vt.FETCH_ERROR,(function(e){os(at.FETCH_ERROR,e.meta)})),Xo.init(),Xo.on(Zi.ROTATION,(function(e){var t=e.meta.positionNames,i=new bt({positionNames:t});t.forEach((function(e){var t=hs._positions[e],n=hs._positionComponents[e].lastAdSize;t.rotated||(t.rotated=!0,t.alias=es.getRotationAliasBasedOnSize(t.adData,n)),i.optionsPerPosition[e]={fetchSize:n,allowedSizes:t.adData.config.service.sizes},t.fetch=i,os(at.POSITION_ROTATE,{positionName:e})})),as(i,hs._config)})),qo.on(on.API_NOT_FOUND,ds),qo.on(on.RESOLVED,ds),qo.on(on.READ_TIMEOUT,ds),qo.on(on.UPDATED,ds),Ko.on(kn.RESOLVED,ps),Ko.on(kn.TIMEOUT,ps),Ko.on(kn.UPDATED,ps),$o.activate(e,hs),Qo.init(hs),function(e){e.JAC_CONFIG&&hs.setConfig(e.JAC_CONFIG),hs._globalConfigProcessed=!0}(e),hs.processQueue(),Zo.on(O.DOM_LOADED,(function(){ls(Object.keys(hs._adData))})),Zo.on(O.LOADED,(function(){ts.injectTrackers(hs._config?hs._config.client.trackers:null)}))}(window))}]);
//# sourceMappingURL=jac.js.map