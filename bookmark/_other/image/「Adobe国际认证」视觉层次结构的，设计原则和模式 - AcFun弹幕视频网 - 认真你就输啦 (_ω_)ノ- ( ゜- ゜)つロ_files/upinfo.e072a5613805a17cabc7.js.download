(window.webpackJsonp=window.webpackJsonp||[]).push([["article/widget/upinfo/upinfo"],{"./article/widget/upinfo/upinfo.es6":function(e,o,t){"use strict";t.r(o);var i=t("../node_modules/jquery/dist/jquery.js"),n=t.n(i),r=t("./common/widget/header/user.es6");A.ready((function(){new A.Widget({el:document.getElementById("up-info"),events:{"click .up-operate .focus":"makeFollow"},created:function(){var e=this.el.querySelector(".up-operate");this.$followBtn=e.querySelector(".focus"),this.articleInfo=window.articleInfo},methods:{makeFollow:function(){var e={atom_id:String(articleInfo.articleId),up_id:String(articleInfo.user.id),ac_id:String(articleInfo.articleId)};if(!r.userInfo.isLogin())return window.location.href="/login/?returnUrl="+encodeURIComponent(location.href);if(r.userInfo.getUid()!=this.articleInfo.user.id)if("关注"==n()(this.$followBtn).text()||"+关注"==n()(this.$followBtn).text()||n()(this.$followBtn).text().includes("回粉")){var o={userName:n()(".up-detail").find(".name").text(),userId:n()(this.$followBtn).data("uid"),isFollowed:window.articleInfo.user.isFollowed};n.a.get("/rest/pc-direct/relation/getGroups").done((function(e){0==e.result&&A.emit("popFollow::show",e.groupList,o)})).fail((function(){A.emit("global::warning","系统忙，请稍后再试")}))}else A.emit("popConfirm::show","是否确定取消关注?"),A.on("popConfirm::chooseSure",(function(){A.off("popConfirm::chooseSure"),n.a.post("/rest/pc-direct/relation/follow",{toUserId:articleInfo.user.id,action:2,groupId:0}).done((function(o){if(0==o.result){n()(".up-operate").find(".focus").text(articleInfo.user.isFollowed?"回粉":"关注"),n()(".up-operate").find(".focus").status=0,n()(".up-operate").find(".focus").css({color:"#fff",background:"#fd4c5b"}),articleInfo.user.isFollowed?A.emit("global::success","TA还在默默关注你哦"):A.emit("global::success","已取消对["+n()(".up-detail").find(".name").text()+"]关注");var t=n()("#up-info .up-census"),i=t.find(".follow .count").text();-1==i.indexOf("万")&&(i=parseInt(i.replace(",","")),i=--i<0?0:i,t.find(".follow .count").text(n.a.parsePts(i)));try{A.emit("CANCEL_FOLLOW_UP_OWNER",e,"CLICK")}catch(e){}}else A.emit("global::warning",o.error_msg)})).fail((function(e){A.emit("global::warning",e.responseJSON.error_msg)}))}));else A.emit("global::warning","不能关注自己呦")}}})}))}},[["./article/widget/upinfo/upinfo.es6","runtime","jquery","@ac/Ajs","@ac/bigpipejs","common/static/js/common","common/widget/header/user"]]]);