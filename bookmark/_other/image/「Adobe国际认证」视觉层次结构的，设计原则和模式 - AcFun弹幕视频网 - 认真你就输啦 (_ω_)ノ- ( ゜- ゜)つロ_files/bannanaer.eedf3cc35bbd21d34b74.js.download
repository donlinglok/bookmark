(window.webpackJsonp=window.webpackJsonp||[]).push([["common/widget/bannanaer/bannanaer"],{"./common/widget/bannanaer/bannanaer.es6":function(a,n,e){"use strict";e.r(n);var t=e("../node_modules/jquery/dist/jquery.js"),i=e.n(t),o=e("./common/widget/header/user.es6");A.ready((function(){i()(".div-banana .bananaer").hover((function(){var a=i()(this).data().num;i()(this).addClass("active").prevAll(".bananaer").addClass("active"),i()(".div-banana").find("span.text b").text(a)}),(function(){i()(this).removeClass("active").siblings(".bananaer").removeClass("active"),i()(".div-banana").find("span.text b").text("0")})),i()(".div-banana").on("click",".bananaer",(function(){var a=i()(this),n=parseInt(a.data().num);if(console.log("banana click"),o.userInfo.isLogin()){if(o.userInfo.getUid()==articleInfo.user.id)return void A.emit("global::warning","不能给自己投蕉!");i()(".J_banana").addClass("active").data("status",1),i()(".J_banana .banana").text("投蕉中"),i.a.ajax({type:"post",url:"/rest/pc-direct/banana/throwBanana",beforeSend:function(a){a.setRequestHeader("udid",o.userInfo.getDid())},data:{resourceId:articleInfo.articleId,resourceType:3,count:n},dataType:"json",xhrFields:{withCredentials:!0}}).done((function(a){if(0===a.result){i()(".div-banana").hide(),i()(".J_banana .banana").text("已投蕉"),i()(".J_banana").addClass("active").data().status=1,i()(".J_banana").find(".ico").css({background:"#c0c0c0"});var e=i()(".bananacount.J_banana").find(".Jba_num").first(),t=a.extData&&a.extData.bananaRealCount||n,o=e&&e.text();o&&-1==o.indexOf("万")&&(o=parseInt(o.replace(",","")),e.text(i.a.parsePts(o+t))),A.emit("GIVE_BANANA",{count:t},"CLICK");var r=a.extData&&a.extData.criticalHitInfo&&a.extData.criticalHitInfo.toast||"成功投食了"+t+"根香蕉。";A.emit("global::success",r)}else i()(".J_banana .banana").text("投蕉"),i()(".J_banana").removeClass("active").data().status=0,i.a.collect(),170004===a.result?(i()(".ba_hide").show(),A.emit("SCAN_DOWNLOAD_BULLET_WINDOW",{content_type:"article"},"SHOW")):A.emit("global::warning",a.error_msg)})).fail((function(a){if(-401==a.result)return window.location.href="/login/?returnUrl="+encodeURIComponent(location.href);i()(".J_banana .banana").text("投蕉"),i()(".J_banana").removeClass("active").data().status=0,A.emit("global::warning","投食操作失败。请于稍后重新操作。")}))}else window.location.href="/login/?returnUrl="+encodeURIComponent(location.href)}))}))}},[["./common/widget/bannanaer/bannanaer.es6","runtime","jquery","@ac/Ajs","@ac/bigpipejs","common/static/js/common","common/widget/header/user"]]]);