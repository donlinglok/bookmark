(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7110],{4469:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/widget",function(){return t(5011)}])},5011:function(n,e,t){"use strict";t.r(e),t.d(e,{__N_SSP:function(){return J},default:function(){return K}});var o=t(5447),r=t(3434),i=t(1984),s=t.n(i),a=t(8690),u=t(3692),c=t(5789),l=t(7427),d=t(521),m=t(5527),f=t(9321),v=t(9728),p=t(1157),h=t(4911),b=t(4743),g=t(5250),y=t(2139),C=t(2299),Z=t(6373),w=t(9223),N=t(886),k=t(7201),x=function(n){(0,Z.Z)(t,n);var e=(0,N.Z)(t);function t(n,o,r){var i;return(0,y.Z)(this,t),(i=e.call(this,n)).status=o,i.data=r,i}return t}((0,w.Z)(Error));function _(n,e){return I.apply(this,arguments)}function I(){return(I=(0,u.Z)((function(n,e){var t,o;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(n,e)];case 1:return[4,(t=r.sent()).json()];case 2:if(o=r.sent(),!t.ok)throw new x((null===o||void 0===o?void 0:o.error)||t.statusText,t.status,o);return[2,o]}}))}))).apply(this,arguments)}function S(n){return Object.entries(n).reduce((function(n,e){var t=(0,p.Z)(e,2),r=t[0],i=t[1];return(0,k.xb)(i)?n:(0,v.Z)((0,o.Z)({},n),(0,C.Z)({},r,i))}),{})}var R=t(2017);function E(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,a.useState)(0),i=r[0],s=r[1],u=new URLSearchParams(S((0,o.Z)({},n,t))),c=(0,a.useMemo)((function(){return{headers:e?{Authorization:"Bearer ".concat(e)}:{}}}),[e]),l=function(e,r){if(0===t.first||0===t.last)return null;if(0===e)return["/api/discussions?".concat(u),c];if(!r.discussion.pageInfo.hasNextPage)return null;var i=new URLSearchParams(S((0,v.Z)((0,o.Z)({},n),{after:r.discussion.pageInfo.endCursor,before:t.before})));return["/api/discussions?".concat(i),c]},d=function(n){return![403,404,429].includes(n)},m=(0,g.ZP)(l,_,{onErrorRetry:function(n,e,t,o,r){d(null===n||void 0===n?void 0:n.status)&&b.J$.default.onErrorRetry(n,e,t,o,r)},revalidateOnMount:d(i),revalidateOnFocus:d(i),revalidateOnReconnect:d(i)}),f=m.data,y=m.size,C=m.setSize,Z=m.error,w=m.mutate,N=m.isValidating;(null===Z||void 0===Z?void 0:Z.status)&&Z.status!==i?s(Z.status):!(null===Z||void 0===Z?void 0:Z.status)&&i&&s(0);var k=(0,a.useCallback)((function(n){var e;if(!f)return w();var t=f.slice(0,f.length-1),r=(0,p.Z)(f.slice(-1),1)[0];return w((0,h.Z)(t).concat([(0,v.Z)((0,o.Z)({},r),{discussion:(0,v.Z)((0,o.Z)({},r.discussion),{comments:(0,h.Z)((null===(e=r.discussion)||void 0===e?void 0:e.comments)||[]).concat([n])})})]),!1),w()}),[f,w]),x=(0,a.useCallback)((function(n){var e=f.map((function(e){return(0,v.Z)((0,o.Z)({},e),{discussion:(0,v.Z)((0,o.Z)({},e.discussion),{comments:e.discussion.comments.map((function(e){return e.id===n.replyToId?(0,v.Z)((0,o.Z)({},e),{replies:(0,h.Z)(e.replies).concat([n])}):e}))})})}));return w(e,!1),w()}),[f,w]),I=(0,a.useCallback)((function(n,e){return w(n,!e)&&(null===e||void 0===e?void 0:e.then((function(){return w()})))}),[w]),R=(0,a.useCallback)((function(n,e){return w(f.map((function(e){return(0,v.Z)((0,o.Z)({},e),{discussion:(0,v.Z)((0,o.Z)({},e.discussion),{comments:e.discussion.comments.map((function(e){return e.id===n.id?n:e}))})})})),!e)&&(null===e||void 0===e?void 0:e.then((function(){return w()})))}),[f,w]),E=(0,a.useCallback)((function(n,e){return w(f.map((function(e){return(0,v.Z)((0,o.Z)({},e),{discussion:(0,v.Z)((0,o.Z)({},e.discussion),{comments:e.discussion.comments.map((function(e){return e.id===n.replyToId?(0,v.Z)((0,o.Z)({},e),{replies:e.replies.map((function(e){return e.id===n.id?n:e}))}):e}))})})})),!e)&&(null===e||void 0===e?void 0:e.then((function(){return w()})))}),[f,w]);return{data:f,error:Z,size:y,setSize:C,isValidating:N,isLoading:!Z&&!f,isError:!!Z,mutators:{addNewComment:k,addNewReply:x,updateDiscussion:I,updateComment:R,updateReply:E,mutate:w}}}var L=t(7631),B=t(2036),T=t(6752),M=t(7195),P="\n  mutation($body: String!, $discussionId: ID!) {\n    addDiscussionComment(input: {body: $body, discussionId: $discussionId}) {\n      comment {\n        id\n        upvoteCount\n        viewerHasUpvoted\n        viewerCanUpvote\n        author {\n          avatarUrl\n          login\n          url\n        }\n        viewerDidAuthor\n        createdAt\n        url\n        authorAssociation\n        lastEditedAt\n        deletedAt\n        isMinimized\n        bodyHTML\n        reactionGroups {\n          content\n          users {\n            totalCount\n          }\n          viewerHasReacted\n        }\n        replies(first: 100) {\n          totalCount\n          nodes {\n            id\n            author {\n              avatarUrl\n              login\n              url\n            }\n            createdAt\n            url\n            authorAssociation\n            lastEditedAt\n            deletedAt\n            isMinimized\n            bodyHTML\n            reactionGroups {\n              content\n              users {\n                totalCount\n              }\n              viewerHasReacted\n            }\n          }\n        }\n      }\n    }\n  }";function A(){return(A=(0,u.Z)((function(n,e){return(0,c.__generator)(this,(function(t){return[2,fetch(M.Lp,{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({query:P,variables:n})}).then((function(n){return n.json()}))]}))}))).apply(this,arguments)}var D="\n  mutation($body: String!, $discussionId: ID!, $replyToId: ID!) {\n    addDiscussionReply: addDiscussionComment(input: {body: $body, discussionId: $discussionId, replyToId: $replyToId}) {\n      reply: comment {\n        id\n        author {\n          avatarUrl\n          login\n          url\n        }\n        viewerDidAuthor\n        createdAt\n        url\n        authorAssociation\n        lastEditedAt\n        deletedAt\n        isMinimized\n        bodyHTML\n        reactionGroups {\n          content\n          users {\n            totalCount\n          }\n          viewerHasReacted\n        }\n        replyTo {\n          id\n        }\n      }\n    }\n  }";function X(){return(X=(0,u.Z)((function(n,e){return(0,c.__generator)(this,(function(t){return[2,fetch(M.Lp,{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({query:D,variables:n})}).then((function(n){return n.json()}))]}))}))).apply(this,arguments)}function O(){return(O=(0,u.Z)((function(n,e,t){return(0,c.__generator)(this,(function(r){return[2,fetch(M.Db,{method:"POST",headers:e?{Authorization:"token ".concat(e)}:{},body:JSON.stringify((0,o.Z)({mode:"gfm",text:n},t?{context:t}:{}))}).then((function(n){return n.text()}))]}))}))).apply(this,arguments)}function z(n){var e=n.viewer,t=n.discussionId,o=n.context,i=n.replyToId,s=n.className,l=void 0===s?"":s,f=n.onSubmit,v=n.onDiscussionCreateRequest,p=(0,m.$I)().t,h=(0,a.useState)(!1),b=h[0],g=h[1],y=(0,a.useState)(""),C=y[0],Z=y[1],w=(0,a.useState)(""),N=w[0],x=w[1],_=(0,a.useState)(""),I=_[0],S=_[1],R=(0,a.useState)(!1),E=R[0],L=R[1],M=(0,a.useState)(!1),P=M[0],D=M[1],z=(0,a.useState)(!1),H=z[0],U=z[1],j=(0,a.useState)(!1),$=j[0],q=j[1],F=(0,a.useState)(""),G=F[0],J=F[1],K=(0,a.useContext)(d.Vo),V=K.token,W=K.origin,Y=K.getLoginUrl,Q=(0,a.useRef)(null),nn=Y(W),en=!!i;(0,a.useEffect)((function(){b&&C!==N&&(C&&(L(!0),function(n,e,t){return O.apply(this,arguments)}(C,V,o).then((function(n){var e=(0,T.jd)(n);S(e),L(!1)}))),x(C))}),[b,C,N,V,o]);var tn=(0,a.useCallback)((function(){Z(""),S(""),g(!1),D(!1),U(!1)}),[]),on=(0,a.useCallback)((0,u.Z)((function(){var n,e;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return P||!t&&!v?[2]:(D(!0),t?(n=t,[3,3]):[3,1]);case 1:return[4,v()];case 2:n=o.sent(),o.label=3;case 3:return e={body:C,discussionId:n,replyToId:i},i?function(n,e){return X.apply(this,arguments)}(e,V).then((function(n){var e=n.data.addDiscussionReply.reply,t=(0,T.KF)(e);f(t),tn()})):function(n,e){return A.apply(this,arguments)}(e,V).then((function(n){var e=n.data.addDiscussionComment.comment,t=(0,T.qw)(e);f(t),tn()})),[2]}}))})),[P,t,C,i,v,V,f,tn]),rn=(0,a.useCallback)((function(n){Z(n.target.value),G&&G!==Q.current.style.height||((0,k.p1)(Q.current),J(Q.current.style.height))}),[G]);return(0,a.useEffect)((function(){Q.current&&H&&Q.current.focus()}),[H]),!en||H?(0,r.BX)("form",{className:"color-bg-primary color-border-primary gsc-comment-box ".concat(en?"gsc-comment-box-is-reply":""," ").concat(l),onSubmit:function(n){n.preventDefault(),on()},children:[(0,r.BX)("div",{className:"color-bg-tertiary color-border-primary gsc-comment-box-tabs",children:[(0,r.BX)("div",{className:"mx-2 mb-[-1px] mt-2",children:[(0,r.tZ)("button",{className:"border border-b-0 px-4 py-2 focus:outline-none ".concat(b?"color-text-secondary border-transparent":"color-text-primary color-bg-canvas color-border-primary rounded-t"),onClick:function(){return g(!1)},type:"button",children:p("write")}),(0,r.tZ)("button",{className:"ml-1 border border-b-0 px-4 py-2 focus:outline-none ".concat(b?"color-text-primary color-bg-canvas color-border-primary rounded-t":"color-text-secondary border-transparent"),onClick:function(){return g(!0)},type:"button",tabIndex:-1,children:p("preview")})]}),b?null:(0,r.tZ)("div",{className:"gsc-comment-box-md-toolbar",children:(0,r.tZ)("button",{className:"gsc-toolbar-item",type:"button",title:p($?"disableFixedWidth":"enableFixedWidth"),onClick:function(){q(!$),Q.current.focus()},tabIndex:-1,children:(0,r.tZ)(B.R1h,{})})})]}),(0,r.tZ)("div",{className:"gsc-comment-box-main",children:b?(0,r.tZ)("div",{className:"markdown color-border-primary gsc-comment-box-preview",dangerouslySetInnerHTML:E?void 0:{__html:I||p("nothingToPreview")},onClick:T.Cn,children:E?p("loadingPreview"):void 0}):(0,r.tZ)("textarea",{className:"form-control input-contrast gsc-comment-box-textarea ".concat($?"gsc-is-fixed-width":""),placeholder:p(V?"writeAComment":"signInToComment"),onChange:rn,value:C,disabled:!V||P,ref:Q,onKeyDown:function(n){return(n.ctrlKey||n.metaKey)&&"Enter"===n.key&&on()}})}),(0,r.BX)("div",{className:"gsc-comment-box-bottom",children:[(0,r.BX)("a",{className:"link-secondary gsc-comment-box-markdown-hint",rel:"nofollow noopener noreferrer",target:"_blank",href:"https://guides.github.com/features/mastering-markdown/",children:[(0,r.tZ)(B.BuP,{className:"mr-1"}),p("stylingWithMarkdownIsSupported")]}),(0,r.BX)("div",{className:"gsc-comment-box-buttons",children:[en?(0,r.tZ)("button",{className:"btn ml-1 rounded-md border",onClick:function(){return U(!1)},type:"button",children:p("cancel")}):null,V?(0,r.tZ)("button",{className:"btn btn-primary items-center ml-1 rounded-md border",type:"submit",disabled:V&&!C.trim()||P,children:p(en?"reply":"comment")}):(0,r.BX)("a",{className:"btn btn-primary inline-flex items-center ml-1 rounded-md border hover:no-underline",target:"_top",href:nn,children:[(0,r.tZ)(B.g_Y,{className:"mr-2",fill:"currentColor"})," ",p("signInWithGitHub")]})]})]})]}):(0,r.BX)("div",{className:"color-bg-tertiary gsc-reply-box",children:[e?(0,r.tZ)("a",{rel:"nofollow noopener noreferrer",target:"_blank",href:e.url,className:"flex shrink-0 items-center",children:(0,r.tZ)("img",{className:"inline-block rounded-full",src:e.avatarUrl,width:"30",height:"30",alt:"@".concat(e.login)})}):null,(0,r.tZ)("button",{className:"form-control color-text-secondary color-border-primary w-full cursor-text ml-2 rounded border px-2 py-1 text-left",onClick:function(){U(!0)},type:"button",children:p("writeAReply")})]})}var H=t(7325);function U(n){var e,i=n.onDiscussionCreateRequest,s=n.onError,p=(0,a.useContext)(d.Vo),h=p.token,b=p.origin,g=(0,m.$I)().t,y=(0,a.useContext)(d.E_),C=y.repo,Z=y.term,w=y.number,N=y.category,k=y.strict,x=y.reactionsEnabled,_=y.emitMetadata,I=y.inputPosition,S=y.defaultCommentOrder,B=(0,a.useState)(S),T=B[0],M=B[1],P=function(n,e){var t,r,i,s,u,c,l,d,m,f,p,h,b,g,y,C,Z,w,N=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"oldest",k=E(n,e,{last:15}),x=k.data,_=k.isLoading,I=k.mutators,S=k.error,L=x&&x[x.length-1],B=null===L||void 0===L||null===(t=L.discussion)||void 0===t||null===(r=t.comments)||void 0===r||null===(i=r[0])||void 0===i?void 0:i.id,T=E(n,e,{first:15}),M=T.data,P=T.isLoading,A=T.size,D=T.setSize,X=T.error,O=null===M||void 0===M?void 0:M.map((function(n){var e,t,r,i=!1,s=(0,v.Z)((0,o.Z)({},n),{discussion:(0,v.Z)((0,o.Z)({},null===n||void 0===n?void 0:n.discussion),{comments:null===n||void 0===n||null===(e=n.discussion)||void 0===e||null===(t=e.comments)||void 0===t?void 0:t.filter((function(n){return n.id===B&&(i=!0),!i}))})});return s.discussion.totalReplyCount=null===(r=s.discussion.comments)||void 0===r?void 0:r.reduce((function(n,e){return n+e.replyCount}),0),s})),z=(null===L||void 0===L||null===(s=L.discussion)||void 0===s?void 0:s.comments)||[],H=(null===O||void 0===O?void 0:O.flatMap((function(n){var e;return(null===n||void 0===n||null===(e=n.discussion)||void 0===e?void 0:e.comments)||[]})))||[],U=k.mutators,j=T.mutators;if("newest"===N){var $=H;H=z.slice().reverse(),z=$.slice().reverse(),j=k.mutators,U=T.mutators}var q=I.addNewComment,F=(0,a.useCallback)((function(n,e){return L?I.updateDiscussion([(0,R.aT)(L,n)],e):e.then((function(){return I.mutate()}))}),[L,I]),G=(0,a.useCallback)((function(){return D(A+1)}),[D,A]),J=(null===L||void 0===L||null===(u=L.discussion)||void 0===u?void 0:u.totalCommentCount)-(null===L||void 0===L||null===(c=L.discussion)||void 0===c||null===(l=c.comments)||void 0===l?void 0:l.length)-(null===O||void 0===O?void 0:O.reduce((function(n,e){var t;return n+(null===(t=e.discussion.comments)||void 0===t?void 0:t.length)}),0)),K=null===L||void 0===L||null===(d=L.discussion)||void 0===d?void 0:d.reactionCount,V=null===L||void 0===L||null===(m=L.discussion)||void 0===m?void 0:m.totalCommentCount,W=((null===L||void 0===L||null===(f=L.discussion)||void 0===f?void 0:f.totalReplyCount)||0)+((null===O||void 0===O?void 0:O.reduce((function(n,e){return n+e.discussion.totalReplyCount}),0))||0),Y=X||S,Q=(null===L||void 0===L||null===(p=L.discussion)||void 0===p||null===(h=p.pageInfo)||void 0===h?void 0:h.hasPreviousPage)&&P||_,nn=P||A>0&&!(null===O||void 0===O?void 0:O[A-1]),en=404===(null===Y||void 0===Y?void 0:Y.status),tn=429===(null===Y||void 0===Y?void 0:Y.status),on=null===L||void 0===L||null===(b=L.discussion)||void 0===b?void 0:b.locked,rn={id:null===L||void 0===L||null===(g=L.discussion)||void 0===g?void 0:g.id,url:null===L||void 0===L||null===(y=L.discussion)||void 0===y?void 0:y.url,locked:null===L||void 0===L||null===(C=L.discussion)||void 0===C?void 0:C.locked,reactions:null===L||void 0===L||null===(Z=L.discussion)||void 0===Z?void 0:Z.reactions,repository:null===L||void 0===L||null===(w=L.discussion)||void 0===w?void 0:w.repository,reactionCount:K,totalCommentCount:V,totalReplyCount:W},sn=null===L||void 0===L?void 0:L.viewer;return{addNewComment:q,updateReactions:F,increaseSize:G,frontData:O,frontComments:H,frontMutators:j,backData:L,backComments:z,backMutators:U,numHidden:J,reactionCount:K,totalCommentCount:V,totalReplyCount:W,error:Y,isLoading:Q,isLoadingMore:nn,isNotFound:en,isRateLimited:tn,isLocked:on,discussion:rn,viewer:sn}}({repo:C,term:Z,category:N,number:w,strict:k},h,T),A=P.addNewComment,D=P.updateReactions,X=P.increaseSize,O=P.backMutators,U=P.frontMutators,j=(0,l.Z)(P,["addNewComment","updateReactions","increaseSize","backMutators","frontMutators"]);(0,a.useEffect)((function(){var n;j.error&&s&&s(null===(n=j.error)||void 0===n?void 0:n.message)}),[j.error,s]),(0,a.useEffect)((function(){if(_&&j.discussion.id){var n={discussion:j.discussion,viewer:j.viewer};(0,f.A)(n,b)}}),[j.discussion,j.viewer,_,b]),(0,a.useEffect)((function(){t.e(74).then(t.bind(t,74))}),[]);var $=function(){var n=(0,u.Z)((function(){var n;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,i()];case 1:return n=e.sent(),U.mutate(),O.mutate(),[2,n]}}))}));return function(){return n.apply(this,arguments)}}(),q=(0,r.tZ)(z,{viewer:j.viewer,discussionId:j.discussion.id,context:C,className:"top"===I&&j.totalCommentCount>0?"mb-4":"",onSubmit:A,onDiscussionCreateRequest:$}),F=j.isNotFound&&!w,G=!!j.discussion.url,J=!j.error&&!j.isNotFound&&!j.isLoading&&j.totalReplyCount>0,K=j.isRateLimited&&!h||!j.isLoading&&!j.isLocked&&(!j.error||j.isNotFound&&!w);return j.isLoading?(0,r.BX)("div",{className:"gsc-loading",children:[(0,r.tZ)("div",{className:"gsc-loading-image"}),(0,r.tZ)("span",{className:"gsc-loading-text color-fg-muted",children:g("loadingComments")})]}):(0,r.BX)("div",{className:"color-text-primary gsc-main",children:[!x||j.isLoading||!F&&j.error?null:(0,r.BX)("div",{className:"gsc-reactions",children:[(0,r.tZ)("h4",{className:"gsc-reactions-count",children:F&&!j.reactionCount?g("reactions",{count:0}):(0,r.tZ)("a",{href:j.discussion.url,target:"_blank",rel:"noreferrer noopener nofollow",className:"color-text-primary",children:g("reactions",{count:j.reactionCount||0})})}),(0,r.tZ)("div",{className:"flex flex-auto items-center justify-center gap-2 text-sm mt-2",children:(0,r.tZ)(H.Z,{subjectId:j.discussion.id,reactionGroups:j.discussion.reactions,onReact:D,onDiscussionCreateRequest:$})})]}),(0,r.BX)("div",{className:"gsc-comments",children:[(0,r.BX)("div",{className:"gsc-header",children:[(0,r.BX)("div",{className:"gsc-left-header",children:[(0,r.tZ)("h4",{className:"gsc-comments-count",children:F&&!j.totalCommentCount?g("comments",{count:0}):j.error&&!j.backData?g("genericError",{message:(null===(e=j.error)||void 0===e?void 0:e.message)||""}):(0,r.tZ)("a",{href:j.discussion.url,target:"_blank",rel:"noreferrer noopener nofollow",className:"color-text-primary",children:g("comments",{count:j.totalCommentCount})})}),J?(0,r.BX)(r.HY,{children:[(0,r.tZ)("h4",{className:"gsc-comments-count-separator",children:"\xb7"}),(0,r.tZ)("h4",{className:"gsc-replies-count",children:g("replies",{count:j.totalReplyCount,plus:j.numHidden>0?"+":""})})]}):null,G?(0,r.tZ)("em",{className:"color-text-secondary text-sm",children:(0,r.tZ)(m.cC,{i18nKey:"common:poweredBy",components:{a:(0,r.tZ)("a",{href:"https://giscus.app",target:"_blank",rel:"noreferrer noopener nofollow",className:"link-secondary"})}})}):null]}),j.totalCommentCount>0?(0,r.BX)("div",{className:"gsc-right-header BtnGroup",role:"listbox",children:[(0,r.tZ)("button",{className:"btn BtnGroup-item","aria-selected":"oldest"===T,role:"option",onClick:function(){return M("oldest")},children:g("oldest")}),(0,r.tZ)("button",{className:"btn BtnGroup-item","aria-selected":"newest"===T,role:"option",onClick:function(){return M("newest")},children:g("newest")})]}):null]}),K&&"top"===I?q:null,(0,r.BX)("div",{className:"gsc-timeline",children:[j.isLoading?null:j.frontComments.map((function(n){return(0,r.tZ)(L.Z,{comment:n,replyBox:h&&!j.isLocked?(0,r.tZ)(z,{discussionId:j.discussion.id,context:C,onSubmit:U.addNewReply,replyToId:n.id,viewer:j.viewer}):void 0,onCommentUpdate:U.updateComment,onReplyUpdate:U.updateReply},n.id)})),j.numHidden>0?(0,r.tZ)("div",{className:"pagination-loader-container gsc-pagination",children:(0,r.BX)("button",{className:"gsc-pagination-button color-border-primary",onClick:X,disabled:j.isLoadingMore,children:[(0,r.tZ)("span",{className:"color-text-secondary",children:g("hiddenItems",{count:j.numHidden})}),(0,r.BX)("span",{className:"color-text-link font-semibold",children:[j.isLoadingMore?g("loading"):g("loadMore"),"\u2026"]})]})}):null,j.isLoading?null:j.backComments.map((function(n){return(0,r.tZ)(L.Z,{comment:n,replyBox:h&&!j.isLocked?(0,r.tZ)(z,{discussionId:j.discussion.id,context:C,onSubmit:O.addNewReply,replyToId:n.id,viewer:j.viewer}):void 0,onCommentUpdate:O.updateComment,onReplyUpdate:O.updateReply},n.id)}))]}),K&&"top"!==I?q:null]})]})}function j(){return(j=(0,u.Z)((function(n,e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,fetch("/api/discussions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({repo:n,input:e})}).then((function(n){return n.json()}))];case 1:return[2,t.sent().id]}}))}))).apply(this,arguments)}function $(){return($=(0,u.Z)((function(n){var e,t;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,fetch("/api/oauth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:n})}).then((function(n){return n.json()}))];case 1:if("error"in(e=o.sent()))throw new Error(e.error);if(!(t=e.token))throw new Error("Unable to retrieve token.");return[2,t]}}))}))).apply(this,arguments)}function q(n){var e=n.origin,t=n.session,o=(0,a.useState)(""),i=o[0],s=o[1],l=(0,a.useState)(),m=l[0],v=l[1],p=(0,a.useContext)(d.E_),h=p.repo,b=p.repoId,g=p.categoryId,y=p.description,C=p.backLink,Z=p.term,w=p.number,N=function(){var n=(0,u.Z)((function(){var n;return(0,c.__generator)(this,(function(t){return m?[2,m]:(n=function(n,e){return j.apply(this,arguments)}(h,{repositoryId:b,categoryId:g,title:Z,body:"# ".concat(Z,"\n\n").concat(y||"","\n\n").concat((0,k.dd)(C||e))}),v(n),[2,n])}))}));return function(){return n.apply(this,arguments)}}(),x=(0,a.useCallback)((function(n){(0,f.A)({error:n},e)}),[e]);return(0,a.useEffect)((function(){t&&!i&&function(n){return $.apply(this,arguments)}(t).then(s).catch((function(n){return x(null===n||void 0===n?void 0:n.message)}))}),[x,t,i]),(0,a.useEffect)((function(){var n=new ResizeObserver((function(n){var t=n[0];t&&(0,f.A)({resizeHeight:t.contentRect.height},e)}));return n.observe(document.querySelector("body")),function(){return n.disconnect()}}),[e]),(!t||i)&&h&&(Z||w)?(0,r.tZ)(d.Vo.Provider,{value:{token:i,origin:e,getLoginUrl:d.Zd},children:(0,r.tZ)(U,{onDiscussionCreateRequest:N,onError:x})}):null}var F=t(5332),G=t.n(F),J=!0;function K(n){var e=n.origin,t=n.session,i=n.repo,u=n.term,c=n.number,l=n.category,f=n.strict,v=n.repoId,p=n.categoryId,h=n.description,b=n.reactionsEnabled,g=n.emitMetadata,y=n.inputPosition,C=n.defaultCommentOrder,Z=n.theme,w=n.originHost,N=n.backLink,k=e||("undefined"===typeof location?"":location.href),x=(0,a.useContext)(d.Ni),_=x.theme,I=x.setTheme,S=(0,a.useState)({repo:i,repoId:v,category:l,categoryId:p,description:h,backLink:N,term:u,number:c,strict:f,reactionsEnabled:b,emitMetadata:g,inputPosition:y,defaultCommentOrder:C}),R=S[0],E=S[1];return(0,a.useEffect)((function(){var n=function(n){if(n.origin===w&&"object"===typeof n.data&&n.data.giscus){var e=n.data.giscus;if("setConfig"in e){var t=e.setConfig;"theme"in t&&(I(t.theme),delete t.theme),G().isReady&&t.lang in m.mT&&(G().replace(G().asPath,G().asPath,{locale:t.lang,scroll:!1}),delete t.lang),E((function(n){return(0,o.Z)({},n,t)}))}}};return window.addEventListener("message",n),function(){return window.removeEventListener("message",n)}}),[w,I]),(0,a.useEffect)((function(){return I(Z)}),[I,Z]),(0,r.BX)(r.HY,{children:[(0,r.BX)(s(),{children:[(0,r.tZ)("base",{target:"_top"}),(0,r.tZ)("title",{children:"giscus"})]}),(0,r.tZ)("main",{className:"w-full mx-auto","data-theme":_,children:(0,r.tZ)(d.E_.Provider,{value:R,children:(0,r.tZ)(q,{origin:k,session:t})})})]})}}},function(n){n.O(0,[9547,3555,1251,9774,2888,179],(function(){return e=4469,n(n.s=e);var e}));var e=n.O();_N_E=e}]);