$(document).ready(function(){function e(e){windowHeight=window.innerHeight,contentHeight=e;let t=document.querySelector(".modal-content"),s=(windowHeight-contentHeight)/2;s<0&&(s=0),contentHeight<windowHeight&&(document.querySelector(".modala").style.paddingTop=s+"px"),document.querySelector(".close").addEventListener("click",function(e){t.style.height="",t.style.width="",myModal.classList.remove("modala")}),document.querySelector("#myModal").addEventListener("click",function(e){"img01"!=e.target.id&&myModal.classList.remove("modala")})}function t(e,t,s){e.addEventListener?e.addEventListener(t,s,!1):e.attachEvent&&e.attachEvent("on"+t,s)}function s(e){e>767&&(f.close(),$(".header .search").slideUp())}var a=localStorage.getItem("searchHistory"),i=[];const o="http://www.edh.tw/";a&&(a.includes("[")?i=JSON.parse(a):(i=a.split(","),localStorage.setItem("searchHistory",JSON.stringify(i))),i.length>10&&(i=i.slice(-10),localStorage.setItem("searchHistory",JSON.stringify(i))),$.each(i,function(e,t){var s='<a href="'+o+"tag/"+encodeURIComponent(i[e])+'/1">'+i[e]+"</a>";$(".history-label").append($(s))})),$(".vote-tag").on("click",function(){$(".vote-tag, .vote-card").toggleClass("show")}),$(function(){FastClick.attach(document.body)});var n=$(".top-menu > li");n.click(function(e){e.stopPropagation();var t=$(this).find(".top-submenu");t.is(":hidden")?($(".top-menu > li").removeClass("is-show"),$(this).addClass("is-show")):$(this).removeClass("is-show")}),$(".member-info").on("mouseover",".member-menu, .member-menu-list",function(e){$(".member-menu-list").show()}).on("mouseleave",function(){$(".member-menu-list").hide()}),$("body").on("click",function(e){$(".top-menu li").removeClass("is-show"),!$(e.target).parents(".header ").length&&$(".search-label").is(":visible")&&($(".header .search-label").slideUp(200),$(".header .search").delay(150).slideUp(200))}),$(".search-history").on("click","span",function(){$(".history-label").empty(),localStorage.setItem("searchHistory","[]")});var l=$(".js-open-sub-menu");if(null!=l){l.length>0&&(l.click(function(){$open=$(this),$open.hasClass("open-sub")||($open.addClass("open-sub"),$open.siblings().removeClass("open-sub"))}),l.hover(function(){$open=$(this),$open.hasClass("open-sub")||($open.addClass("open-sub"),$open.siblings().removeClass("open-sub"))}).mouseleave(function(){$open=$(this),$open.hasClass("open-sub")&&($open.removeClass("open-sub"),$(".sub-menu-tab").removeClass("more-sub")),$(".js-more-sub-menu").text("看更多")}));var r=$(".js-more-sub-menu");r.length>0&&r.click(function(){var e=$(this),t=e.parents(".sub-menu-tab");t.hasClass("more-sub")?(t.removeClass("more-sub"),e.text("看更多")):(t.addClass("more-sub"),e.text("返回"))})}var c=$(".menu-all-categories > ul > li");c.each(function(){$(this).find(".sub-menu-tab").length?$(this).addClass("has-sub"):$(this).find(".sub-menu").length&&$(this).find(".sub-menu").remove()});var d=$(".js-open-sub-menu-mobile");null!=d&&(d.length>0&&d.click(function(e){e.stopPropagation(),$hasSub=$(this).parents(".has-sub").first(),$open=$hasSub.find(".sub-nav").first(),$hasSub.hasClass("open-sub")?($hasSub.removeClass("open-sub"),$hasSub.find(".has-sub").removeClass("open-sub"),$open.stop(!0,!1).slideUp(400)):($hasSub.addClass("open-sub"),$hasSub.siblings().removeClass("open-sub"),$hasSub.siblings().find(".has-sub").removeClass("open-sub"),$hasSub.siblings().find(".sub-nav").stop(!0,!1).slideUp(400),$open.stop(!0,!1).slideDown(400))}),$(".js-open-search").click(function(){$(".slideout-menu").hasClass("show-searchbar")?($(".slideout-menu").removeClass("show-searchbar"),$(".header .search-label").slideUp(200),$(".header .search").delay(150).slideUp(200)):($(".slideout-menu").addClass("show-searchbar"),$(".header .search").slideDown(200),$(".header .search-label").delay(150).slideDown(200))})),$("#goTop").click(function(){return $("html,body").animate({scrollTop:0},900),!1}),$(window).scroll(function(){$(this).scrollTop()>100?$("#goTop").fadeIn(200):$("#goTop").fadeOut(200)}),$("article img").each(function(){$("#article_page img").addClass("lazyloading")});var u=window.navigator.userAgent,m=u.indexOf("MSIE"),h=u.indexOf("Trident");if(u.indexOf("Edge")>0||m>0||h>0||u.indexOf("rv:")>0){var p="https:"==document.location.protocol;$(".container-bg img").each(function(){var e=$(this).attr("data-original");null!=e&&p&&0==e.indexOf("http://")&&-1!=e.indexOf(".staticflickr.com/")&&(e=e.substr(5)),$(this).attr("src",e).removeAttr("data-origina")}).addClass("lazy").addClass("img"),p&&$('img[src^="http://"]').each(function(){var e=$(this).attr("src");-1!=e.indexOf(".staticflickr.com/")&&$(this).attr("src",e)})}else{var g=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){var s=e.target;s.src=s.dataset.original,s.classList.remove("lazy"),t.unobserve(s)}})}),b=document.querySelectorAll("img.lazy");b.forEach(function(e){g.observe(e)})}imgclick=document.querySelectorAll("#article_page img.lazyloading");for(let t=0;t<document.querySelectorAll("#article_page img.lazyloading").length;t++)imgclick[t].alt.indexOf("免費訂閱電子報")>-1||imgclick[t].alt.indexOf("連結")>-1?imgclick[t].style.cursor="pointer":imgclick[t].style.cursor="zoom-in",imgclick[t].addEventListener("click",function(t){var s=t.target.alt;if("免費訂閱電子報"!==s&&-1==s.indexOf("連結")&&0==window.mobilecheck()){let s=document.getElementById("myModal"),a=t.target.getAttribute("src"),i=document.getElementById("img01");i.src=a.replace(/_m.(jpg)|_z.(jpg)|_c.(jpg)/g,"_b.jpg"),s.classList.add("modala"),i.addEventListener("load",function(){e(i.height)})}});$("#searchSelected, .searchicon").click(function(){$("#searchTab").is(":hidden")?($("#searchTab").show(),$("#searchSelected").addClass("searchOpen")):($("#searchTab").hide(),$("#searchSelected").removeClass("searchOpen"))}).mouseleave(function(){$("#searchSelected").hasClass("searchOpen")&&($("#searchSelected").removeClass("searchOpen"),$(".menu-pc .searchTab").slideUp())}),$(".menu-pc .searchTab").mouseenter(function(){$("#searchSelected").hasClass("searchOpen")||($("#searchSelected").addClass("searchOpen"),$(".menu-pc .searchTab").stop(!0,!1).slideDown())}).mouseleave(function(){$("#searchSelected").hasClass("searchOpen")&&($("#searchSelected").removeClass("searchOpen"),$(".menu-pc .searchTab").slideUp())}),$("#searchTab li").hover(function(){$(this).addClass("selected")},function(){$(this).removeClass("selected")});var v=document.querySelector(".searchMenu li");null!=v&&t(v,"click",function(){doSearch1()}),$("#msearchTab li").hover(function(){$(this).addClass("selected")},function(){$(this).removeClass("selected")});var f=new Slideout({panel:document.getElementById("container"),menu:document.getElementById("menu"),side:"right",touch:"false",padding:256,tolerance:70});f.disableTouch(),document.querySelector(".toggle-button").addEventListener("click",function(){f.toggle()}),f.on("open",function(){document.querySelector(".main-container").addEventListener("click",function(){f.close()})}),$(window).on("resize",function(){s($("body").width())}),$("#slider-item").owlCarousel({items:1,itemsDesktop:[1199,1],itemsDesktopSmall:[979,1],itemsTablet:[768,1],itemsMobile:[479,1],navigation:!0,mouseDrag:!1,touchDrag:!1,autoPlay:3e3}),$("#slider-items").owlCarousel({items:4,itemsDesktop:[1199,4],itemsDesktopSmall:[979,4],itemsTablet:[768,2],itemsMobile:[479,2],navigation:!0,mouseDrag:!1,touchDrag:!1}),$("#slider-item-indexvideo").owlCarousel({items:1,itemsDesktop:[1199,1],itemsDesktopSmall:[979,1],itemsTablet:[768,1],itemsMobile:[479,1],navigation:!1,mouseDrag:!1,touchDrag:!1,pagination:!0,autoPlay:6e3}),$("#slider-item-index-picarticle").owlCarousel({items:1,itemsDesktop:[1199,1],itemsDesktopSmall:[979,1],itemsTablet:[768,1],itemsMobile:[479,1],navigation:!0,mouseDrag:!1,touchDrag:!1,pagination:!0,autoPlay:5e3}),$("#slider-item-index-mobile-picarticle").owlCarousel({items:1,itemsDesktop:[1199,2],itemsDesktopSmall:[979,2],itemsTablet:[768,1],itemsMobile:[479,1],navigation:!0,mouseDrag:!1,touchDrag:!1,pagination:!0,autoPlay:5e3}),$("div.media-slider").owlCarousel({autoPlay:3e3,items:5,itemsMobile:[479,3],itemsDesktop:[1199,3],itemsDesktopSmall:[120,3],responsive:!0,navigation:!0,mouseDrag:!1,touchDrag:!1,pagination:!1}),$("#sidebar_ac").owlCarousel({autoPlay:3e3,items:1,itemsMobile:[479,1],itemsDesktop:[1199,1],itemsDesktopSmall:[120,1],navigation:!0,mouseDrag:!1,touchDrag:!1,pagination:!0,pagination:!0}),$("#sidebar_ac").on("initialized.owl.carousel",function(){$(this).removeClass("hide")}),$("#slider-special-item-index").owlCarousel({items:1,itemsDesktop:[1199,1],itemsDesktopSmall:[979,1],itemsTablet:[768,1],itemsMobile:[479,1],navigation:!0,mouseDrag:!1,touchDrag:!1,autoPlay:5e3}),$(".top-carousel").owlCarousel({autoPlay:5e3,items:1,itemsDesktop:[125,1],itemsDesktopSmall:[125,1],itemsMobile:[125,1],responsive:!1,loop:!0,navigation:!1,mouseDrag:!1,touchDrag:!1,stopOnHover:!0,autoHeight:!1,pagination:!1}),$(".datepicker").on("focus",function(e){$(this).blur()}).datepicker({format:"yyyy/mm/dd",language:"zh-TW",keyboardNavigation:!1,autoclose:!0}),$(".tab-right-change .tab").click(function(){var e=$(this).attr("data-tab");void 0!==e&&($(".tab-right-change .tab").removeClass("active"),$(".tab-right-content").removeClass("current"),$(this).addClass("active"),$("#"+e).addClass("current"))}),$("div.ecmtab").prepend($("<ul class='nav-categories'></ul>")),$.each($(".tbs-block > a"),function(){var e=$(this).parent().attr("id"),t=$("<li></li>").attr("data-tab",e);$(t).append($("<div class='menu-name'></div").append($(this))).appendTo($("div.ecmtab ul.nav-categories"))}),$("div.ecmtab ul.nav-categories div.menu-name"),$("div.ecmtab ul.nav-categories li:eq(0)").addClass("active"),$(".tbs-block:eq(0)").addClass("current"),$("div.sun-tbs").height()>0&&$("#tbs-1").prepend("<div class='tbs-hr'></div>"),$("div.ecmtab ul.nav-categories li").click(function(){var e=$(this).attr("data-tab");void 0!==e&&($("ul.nav-categories li").removeClass("active"),$(".tbs-block").removeClass("current"),$(this).addClass("active"),$("#"+e).addClass("current"))});let C=document.querySelector("div.media-slider .owl-item .item"),y=document.querySelector("div.m-slider");if(null!=C){let e=C.children[0].getAttribute("href");(null==e||e.search("AdId=-3")>0||C.offsetHeight<=0)&&y.remove()}let k=document.querySelector(".sun-ec-block .ecmtab .menu-name");if(null!=k){let e=k.children[0].getAttribute("href");if(e.search("AdId=-3")>0){let e=document.querySelector(".ec-page");e.parentNode.removeChild(e)}}});